<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>择时 - R-Finance中国</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:url" content="https://rfinance.org.cn/tags/%E6%8B%A9%E6%97%B6/"><meta property="og:site_name" content="R-Finance中国"><meta property="og:title" content="择时"><meta property="og:description" content="rfinance's Personal blog about everything"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="website"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel=alternate type=application/rss+xml href=/tags/%E6%8B%A9%E6%97%B6/index.xml title=R-Finance中国><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title=R-Finance中国 rel=home><div class="logo__item logo__text"><div class=logo__title>R-Finance中国</div><div class=logo__tagline>R语言与金融深度融合的堡垒站点</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/conference/><span class=menu__text>会议</span></a></li><li class=menu__item><a class=menu__link href=/salon/><span class=menu__text>沙龙</span></a></li><li class=menu__item><a class=menu__link href=/bootcamp/><span class=menu__text>训练坊</span></a></li><li class=menu__item><a class=menu__link href=/media/><span class=menu__text>媒体矩阵</span></a></li><li class=menu__item><a class=menu__link href=/about/><span class=menu__text>关于本站</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class="main list" role=main><header class=main__header><h1 class=main__title>择时</h1></header><article class="list__item post"><header class=list__header><h2 class="list__title post__title"><a href=/post/kdj/ rel=bookmark>KDJ指标择时交易策略分析</a></h2><div class="list__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 110 28 1 1 0 010-28m0 3a3 3 0 100 22 3 3 0 000-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class=meta__text datetime=2025-06-10T15:36:25Z>June 10, 2025</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/ rel=category>量化投资</a></span></div></div></header><div class="content list__excerpt post__content clearfix"><h1 id=引言>引言</h1><p>技术分析是金融市场中常用的分析方法，其中KDJ指标是一种重要的随机指标，能够反映价格波动的强弱、超买超卖现象以及市场趋势变化。本研究旨在通过R语言实现基于KDJ指标的股票择时交易策略，并通过历史数据回测寻找最佳参数组合。</p><h1 id=研究方法>研究方法</h1><h2 id=数据获取与处理>数据获取与处理</h2><p>我们将使用<code>quantmod</code>包获取股票数据，并使用<code>quantstrat</code>包进行策略回测。首先加载所需的包：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 加载必要的包</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(quantmod)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(quantstrat)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(eTTR)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(PerformanceAnalytics)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(ggplot2)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(dplyr)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(tibble)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(scales)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(gridExtra)
</span></span><span style=display:flex><span><span style=color:#75715e># 加载环境重置函数</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>source</span>(<span style=color:#e6db74>&#34;/Users/matrixspk/My-Sites/r-finance/assets/code/reset_strategy_env.R&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e># 加载计算胜率的函数</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>source</span>(<span style=color:#e6db74>&#34;/Users/matrixspk/My-Sites/r-finance/assets/code/calculate_portfolio_win_rates.R&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>source</span>(<span style=color:#e6db74>&#34;/Users/matrixspk/My-Sites/r-finance/assets/code/generateSimpleSignalChain.R&#34;</span>)
</span></span></code></pre></div><p>接下来，我们获取苹果公司股票的历史数据作为研究对象：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 设置获取数据的起始和结束日期</span>
</span></span><span style=display:flex><span>initDate <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>as.Date</span>(<span style=color:#e6db74>&#34;2017-12-31&#34;</span>)
</span></span><span style=display:flex><span>startdate.st <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>as.Date</span>(<span style=color:#e6db74>&#34;2018-01-01&#34;</span>)
</span></span><span style=display:flex><span>enddate.st <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>as.Date</span>(<span style=color:#e6db74>&#34;2023-06-01&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e># 获取苹果公司股票数据</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>getSymbols</span>(<span style=color:#e6db74>&#34;AAPL&#34;</span>, src <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;yahoo&#34;</span>, from <span style=color:#f92672>=</span> startdate.st, to <span style=color:#f92672>=</span> enddate.st)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;AAPL&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>colnames</span>(AAPL) <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;Open&#34;</span>, <span style=color:#e6db74>&#34;High&#34;</span>, <span style=color:#e6db74>&#34;Low&#34;</span>, <span style=color:#e6db74>&#34;Close&#34;</span>, <span style=color:#e6db74>&#34;Volume&#34;</span>, <span style=color:#e6db74>&#34;Adjusted&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e># 查看数据结构</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>head</span>(AAPL)
</span></span></code></pre></div><pre tabindex=0><code>##               Open    High     Low   Close    Volume Adjusted
## 2018-01-02 42.5400 43.0750 42.3150 43.0650 102223600 40.42682
## 2018-01-03 43.1325 43.6375 42.9900 43.0575 118071600 40.41978
## 2018-01-04 43.1350 43.3675 43.0200 43.2575  89738400 40.60753
## 2018-01-05 43.3600 43.8425 43.2625 43.7500  94640000 41.06987
## 2018-01-08 43.5875 43.9025 43.4825 43.5875  82271200 40.91733
## 2018-01-09 43.6375 43.7650 43.3525 43.5825  86336000 40.91262
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>summary</span>(AAPL)
</span></span></code></pre></div><pre tabindex=0><code>##      Index                 Open             High             Low        
##  Min.   :2018-01-02   Min.   : 35.99   Min.   : 36.43   Min.   : 35.50  
##  1st Qu.:2019-05-10   1st Qu.: 51.97   1st Qu.: 52.32   1st Qu.: 51.67  
##  Median :2020-09-15   Median :114.67   Median :116.07   Median :112.84  
##  Mean   :2020-09-14   Mean   :102.38   Mean   :103.62   Mean   :101.24  
##  3rd Qu.:2022-01-20   3rd Qu.:146.36   3rd Qu.:148.00   3rd Qu.:145.15  
##  Max.   :2023-05-31   Max.   :182.63   Max.   :182.94   Max.   :179.12  
##      Close            Volume             Adjusted     
##  Min.   : 35.55   Min.   : 35195900   Min.   : 33.87  
##  1st Qu.: 52.03   1st Qu.: 76144000   1st Qu.: 49.73  
##  Median :114.97   Median : 98135650   Median :111.96  
##  Mean   :102.48   Mean   :112825725   Mean   :100.02  
##  3rd Qu.:146.61   3rd Qu.:133535000   3rd Qu.:143.97  
##  Max.   :182.01   Max.   :426510000   Max.   :178.65
</code></pre><h2 id=kdj指标计算原理>KDJ指标计算原理</h2><p>KDJ指标由三条曲线组成：K线、D线和J线。其计算基于以下步骤：</p></div></article></main></div><aside class=sidebar><div class="widget-search widget"><form class=widget-search__form role=search method=get action=https://google.com/search><input class=widget-search__field type=search placeholder=Search… name=q aria-label=Search…>
<input class=widget-search__submit type=submit value=Search>
<input type=hidden name=sitesearch value=https://rfinance.org.cn/></form></div><div class="widget-recent widget"><h4 class=widget__title>Recent Posts</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=/docs/pairs-trading/>协整理论与配对交易策略分析</a></li><li class=widget__item><a class=widget__link href=/docs/markowitz/>马克维兹投资组合理论的有效性分析</a></li><li class=widget__item><a class=widget__link href=/post/kdj/>KDJ指标择时交易策略分析</a></li><li class=widget__item><a class=widget__link href=/post/macd/>MACD指标择时交易策略分析</a></li><li class=widget__item><a class=widget__link href=/post/chart-muti-stocks/>R语言与多股票波动性及相关性的可视化</a></li></ul></div></div><div class="widget-categories widget"><h4 class=widget__title>Categories</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=/categories/r%E8%AF%AD%E8%A8%80/>R语言</a></li><li class=widget__item><a class=widget__link href=/categories/%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/>量化投资</a></li><li class=widget__item><a class=widget__link href=/categories/%E9%87%91%E8%9E%8D%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/>金融数据分析</a></li></ul></div></div><div class="widget-taglist widget"><h4 class=widget__title>Tags</h4><div class=widget__content><a class="widget-taglist__link widget__link btn" href=/tags/kdj/ title=KDJ>KDJ</a>
<a class="widget-taglist__link widget__link btn" href=/tags/r/ title=R>R</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%8A%A8%E9%87%8F/ title=动量>动量</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%8D%8F%E6%95%B4/ title=协整>协整</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E5%9D%87%E5%80%BC%E5%9B%9E%E5%A4%8D/ title=均值回复>均值回复</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E6%8A%95%E8%B5%84%E7%BB%84%E5%90%88/ title=投资组合>投资组合</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E6%8B%A9%E6%97%B6/ title=择时>择时</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E6%9C%89%E6%95%88%E6%80%A7/ title=有效性>有效性</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E6%B3%A2%E5%8A%A8%E6%80%A7/ title=波动性>波动性</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E7%9B%B8%E5%85%B3%E6%80%A7/ title=相关性>相关性</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E8%82%A1%E7%A5%A8/ title=股票>股票</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E8%BD%AE%E5%8A%A8%E7%AD%96%E7%95%A5/ title=轮动策略>轮动策略</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E9%85%8D%E5%AF%B9%E4%BA%A4%E6%98%93/ title=配对交易>配对交易</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E9%87%91%E8%9E%8D/ title=金融>金融</a>
<a class="widget-taglist__link widget__link btn" href=/tags/%E9%A9%AC%E5%85%8B%E7%BB%B4%E8%8C%A8/ title=马克维茨>马克维茨</a></div></div></aside></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 R-Finance中国.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>