<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>MACD指标择时交易策略分析 - R-Finance中国</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:url" content="https://rfinance.org.cn/post/macd/"><meta property="og:site_name" content="R-Finance中国"><meta property="og:title" content="MACD指标择时交易策略分析"><meta property="og:description" content='引言 技术分析是金融市场中常用的分析方法，其中MACD指标是一种重要的趋势跟踪指标，能够反 映价格波动的趋势和动量。本研究旨在通过R语言实现基于MACD指标的股票择时交易策略，并 通过历史数据回测寻找最佳参数组合。
研究方法 数据获取与处理 我们将使用quantmod包获取股票数据，并使用quantstrat包进行策略回测。首先加载所需的包：
# 加载必要的包 library(quantmod) library(quantstrat) library(eTTR) library(PerformanceAnalytics) library(ggplot2) library(dplyr) library(tibble) library(scales) library(gridExtra) library(showtext) font_add("SimHei", regular = "SimHei.ttf") showtext_auto() 接下来，我们获取TSLA的历史数据作为研究对象：
# 设置获取数据的起始和结束日期 startdate.st <- as.Date("2018-01-01") enddate.st <- as.Date("2023-06-01") # 获取上证指数数据 getSymbols("TSLA", src = "yahoo", from = startdate.st, to = enddate.st) ## [1] "TSLA" colnames(TSLA) <- c("Open", "High", "Low", "Close", "Volume", "Adjusted") # 查看数据结构 head(TSLA) ## Open High Low Close Volume Adjusted ## 2018-01-02 20.80000 21.47400 20.73333 21.36867 65283000 21.36867 ## 2018-01-03 21.40000 21.68333 21.03667 21.15000 67822500 21.15000 ## 2018-01-04 20.85800 21.23667 20.37867 20.97467 149194500 20.97467 ## 2018-01-05 21.10800 21.14933 20.80000 21.10533 68868000 21.10533 ## 2018-01-08 21.06667 22.46800 21.03333 22.42733 147891000 22.42733 ## 2018-01-09 22.34400 22.58667 21.82667 22.24600 107199000 22.24600 summary(TSLA) ## Index Open High Low ## Min. :2018-01-02 Min. : 12.07 Min. : 12.45 Min. : 11.80 ## 1st Qu.:2019-05-10 1st Qu.: 21.42 1st Qu.: 21.82 1st Qu.: 21.04 ## Median :2020-09-15 Median :126.48 Median :130.84 Median :122.50 ## Mean :2020-09-14 Mean :135.13 Mean :138.26 Mean :131.71 ## 3rd Qu.:2022-01-20 3rd Qu.:230.08 3rd Qu.:235.64 3rd Qu.:224.40 ## Max. :2023-05-31 Max. :411.47 Max. :414.50 Max. :405.67 ## Close Volume Adjusted ## Min. : 11.93 Min. : 29401800 Min. : 11.93 ## 1st Qu.: 21.50 1st Qu.: 77479900 1st Qu.: 21.50 ## Median :125.58 Median :105881850 Median :125.58 ## Mean :135.07 Mean :134180816 Mean :135.07 ## 3rd Qu.:231.07 3rd Qu.:159549600 3rd Qu.:231.07 ## Max. :409.97 Max. :914082000 Max. :409.97 MACD指标计算原理 MACD指标由三条曲线组成：DIF线、DEA线和MACD柱状图。其计算基于以下步骤：'><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2025-06-10T15:36:25+00:00"><meta property="article:modified_time" content="2025-06-10T15:36:25+00:00"><meta property="article:tag" content="动量"><meta property="article:tag" content="轮动策略"><meta property="article:tag" content="有效性"><meta property="article:tag" content="R"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title=R-Finance中国 rel=home><div class="logo__item logo__text"><div class=logo__title>R-Finance中国</div><div class=logo__tagline>R语言与金融深度融合的堡垒站点</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/conference/><span class=menu__text>会议</span></a></li><li class=menu__item><a class=menu__link href=/salon/><span class=menu__text>沙龙</span></a></li><li class=menu__item><a class=menu__link href=/bootcamp/><span class=menu__text>训练坊</span></a></li><li class=menu__item><a class=menu__link href=/media/><span class=menu__text>媒体矩阵</span></a></li><li class=menu__item><a class=menu__link href=/about/><span class=menu__text>关于本站</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>MACD指标择时交易策略分析</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 110 28 1 1 0 010-28m0 3a3 3 0 100 22 3 3 0 000-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class=meta__text datetime=2025-06-10T15:36:25Z>June 10, 2025</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=/categories/%E9%87%8F%E5%8C%96%E6%8A%95%E8%B5%84/ rel=category>量化投资</a></span></div></div></header><div class="content post__content clearfix"><h1 id=引言>引言</h1><p>技术分析是金融市场中常用的分析方法，其中MACD指标是一种重要的趋势跟踪指标，能够反
映价格波动的趋势和动量。本研究旨在通过R语言实现基于MACD指标的股票择时交易策略，并
通过历史数据回测寻找最佳参数组合。</p><h1 id=研究方法>研究方法</h1><h2 id=数据获取与处理>数据获取与处理</h2><p>我们将使用<code>quantmod</code>包获取股票数据，并使用<code>quantstrat</code>包进行策略回测。首先加载所需的包：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 加载必要的包</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(quantmod)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(quantstrat)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(eTTR)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(PerformanceAnalytics)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(ggplot2)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(dplyr)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(tibble)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(scales)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(gridExtra)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(showtext)
</span></span><span style=display:flex><span><span style=color:#a6e22e>font_add</span>(<span style=color:#e6db74>&#34;SimHei&#34;</span>, regular <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SimHei.ttf&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>showtext_auto</span>()
</span></span></code></pre></div><p>接下来，我们获取TSLA的历史数据作为研究对象：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 设置获取数据的起始和结束日期</span>
</span></span><span style=display:flex><span>startdate.st <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>as.Date</span>(<span style=color:#e6db74>&#34;2018-01-01&#34;</span>)
</span></span><span style=display:flex><span>enddate.st <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>as.Date</span>(<span style=color:#e6db74>&#34;2023-06-01&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 获取上证指数数据</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>getSymbols</span>(<span style=color:#e6db74>&#34;TSLA&#34;</span>, 
</span></span><span style=display:flex><span>           src <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;yahoo&#34;</span>, 
</span></span><span style=display:flex><span>           from <span style=color:#f92672>=</span> startdate.st, 
</span></span><span style=display:flex><span>           to <span style=color:#f92672>=</span> enddate.st)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;TSLA&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>colnames</span>(TSLA) <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;Open&#34;</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#34;High&#34;</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#34;Low&#34;</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#34;Close&#34;</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#34;Volume&#34;</span>, 
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#34;Adjusted&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看数据结构</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>head</span>(TSLA)
</span></span></code></pre></div><pre tabindex=0><code>##                Open     High      Low    Close    Volume Adjusted
## 2018-01-02 20.80000 21.47400 20.73333 21.36867  65283000 21.36867
## 2018-01-03 21.40000 21.68333 21.03667 21.15000  67822500 21.15000
## 2018-01-04 20.85800 21.23667 20.37867 20.97467 149194500 20.97467
## 2018-01-05 21.10800 21.14933 20.80000 21.10533  68868000 21.10533
## 2018-01-08 21.06667 22.46800 21.03333 22.42733 147891000 22.42733
## 2018-01-09 22.34400 22.58667 21.82667 22.24600 107199000 22.24600
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>summary</span>(TSLA)
</span></span></code></pre></div><pre tabindex=0><code>##      Index                 Open             High             Low        
##  Min.   :2018-01-02   Min.   : 12.07   Min.   : 12.45   Min.   : 11.80  
##  1st Qu.:2019-05-10   1st Qu.: 21.42   1st Qu.: 21.82   1st Qu.: 21.04  
##  Median :2020-09-15   Median :126.48   Median :130.84   Median :122.50  
##  Mean   :2020-09-14   Mean   :135.13   Mean   :138.26   Mean   :131.71  
##  3rd Qu.:2022-01-20   3rd Qu.:230.08   3rd Qu.:235.64   3rd Qu.:224.40  
##  Max.   :2023-05-31   Max.   :411.47   Max.   :414.50   Max.   :405.67  
##      Close            Volume             Adjusted     
##  Min.   : 11.93   Min.   : 29401800   Min.   : 11.93  
##  1st Qu.: 21.50   1st Qu.: 77479900   1st Qu.: 21.50  
##  Median :125.58   Median :105881850   Median :125.58  
##  Mean   :135.07   Mean   :134180816   Mean   :135.07  
##  3rd Qu.:231.07   3rd Qu.:159549600   3rd Qu.:231.07  
##  Max.   :409.97   Max.   :914082000   Max.   :409.97
</code></pre><h2 id=macd指标计算原理>MACD指标计算原理</h2><p>MACD指标由三条曲线组成：DIF线、DEA线和MACD柱状图。其计算基于以下步骤：</p><ol><li>计算短期和长期EMA：
$$
EMA_{s} = \frac{2}{N_{s} + 1} \times (Cl - EMA_{s}^{pre}) + EMA_{s}^{pre}
$$</li></ol><p>$$
EMA_{l} = \frac{2}{N_{l} + 1} \times (Cl - EMA_{l}^{pre}) + EMA_{l}^{pre}
$$</p><p>其中，$N_{s}$ 通常为12，$N_{l}$ 通常为26。</p><ol start=2><li><p>计算DIF线：
$$
DIF = EMA_{s} - EMA_{l}
$$</p></li><li><p>计算DEA线：
$$
DEA = \frac{2}{N_{signal} + 1} \times (DIF - DEA^{pre}) + DEA^{pre}
$$
其中，$N_{signal}$ 通常为9。</p></li><li><p>计算MACD柱状图：
$$
MACD = DIF - DEA
$$</p></li></ol><h2 id=交易策略设计>交易策略设计</h2><p>我们将基于MACD指标设计以下交易策略：</p><ul><li>买入信号：当DIF线从下方上穿DEA线（金叉）</li><li>卖出信号：当DIF线从上方下穿DEA线（死叉）</li></ul><p>下面我们使用<code>quantstrat</code>包实现这个策略：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 清理历史环境。</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>reset_strategy_env</span>()
</span></span></code></pre></div><pre tabindex=0><code>## 策略环境已重置
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>rm</span>(list <span style=color:#f92672>=</span> <span style=color:#a6e22e>ls</span>(.blotter))
</span></span><span style=display:flex><span><span style=color:#a6e22e>rm</span>(list <span style=color:#f92672>=</span> <span style=color:#a6e22e>ls</span>(.strategy))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置初始参数</span>
</span></span><span style=display:flex><span>initDate <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>as.Date</span>(<span style=color:#e6db74>&#34;2017-12-31&#34;</span>)
</span></span><span style=display:flex><span>initEq.st <span style=color:#f92672>&lt;-</span> <span style=color:#ae81ff>1000000</span>  
</span></span><span style=display:flex><span>portfolio.st <span style=color:#f92672>&lt;-</span> <span style=color:#e6db74>&#34;MACD_Portfolio&#34;</span>
</span></span><span style=display:flex><span>strategy.st <span style=color:#f92672>&lt;-</span> <span style=color:#e6db74>&#34;MACD_Strategy&#34;</span>
</span></span><span style=display:flex><span>account.st <span style=color:#f92672>&lt;-</span> <span style=color:#e6db74>&#34;MACD_Account&#34;</span>
</span></span><span style=display:flex><span>symbols.st <span style=color:#f92672>&lt;-</span> <span style=color:#e6db74>&#34;TSLA&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 初始化quantstrat</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>currency</span>(<span style=color:#e6db74>&#34;USD&#34;</span>)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;USD&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>stock</span>(<span style=color:#e6db74>&#34;TSLA&#34;</span>, currency <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;USD&#34;</span>, multiplier <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;TSLA&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>initPortf</span>(portfolio.st, symbols <span style=color:#f92672>=</span> symbols.st)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;MACD_Portfolio&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>initAcct</span>(account.st, portfolios <span style=color:#f92672>=</span> portfolio.st, initEq <span style=color:#f92672>=</span> initEq.st)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;MACD_Account&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>initOrders</span>(portfolio.st, symbols.st, initDate <span style=color:#f92672>=</span> initDate)
</span></span><span style=display:flex><span><span style=color:#a6e22e>strategy</span>(strategy.st, store <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 添加MACD指标</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>add.indicator</span>(strategy.st, 
</span></span><span style=display:flex><span>              name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;MACD&#34;</span>, 
</span></span><span style=display:flex><span>              arguments <span style=color:#f92672>=</span> <span style=color:#a6e22e>list</span>(x <span style=color:#f92672>=</span> <span style=color:#a6e22e>quote</span>(<span style=color:#a6e22e>Cl</span>(mktdata)), 
</span></span><span style=display:flex><span>                               nFast <span style=color:#f92672>=</span> <span style=color:#ae81ff>8</span>, 
</span></span><span style=display:flex><span>                               nSlow <span style=color:#f92672>=</span> <span style=color:#ae81ff>21</span>, 
</span></span><span style=display:flex><span>                               nSig <span style=color:#f92672>=</span> <span style=color:#ae81ff>35</span>),
</span></span><span style=display:flex><span>              label <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;MACD_8_21_35&#34;</span>)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;MACD_Strategy&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 添加交易规则</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 买入规则：DIF线上穿DEA线（金叉）</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>add.signal</span>(strategy.st, 
</span></span><span style=display:flex><span>           name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;sigCrossover&#34;</span>, 
</span></span><span style=display:flex><span>           arguments <span style=color:#f92672>=</span> <span style=color:#a6e22e>list</span>(columns <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;macd.MACD_8_21_35&#34;</span>, 
</span></span><span style=display:flex><span>                                        <span style=color:#e6db74>&#34;signal.MACD_8_21_35&#34;</span>), 
</span></span><span style=display:flex><span>                            relationship <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;gte&#34;</span>),
</span></span><span style=display:flex><span>           label <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Buy_Signal&#34;</span>)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;MACD_Strategy&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 卖出规则：DIF线下穿DEA线（死叉）</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>add.signal</span>(strategy.st, 
</span></span><span style=display:flex><span>           name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;sigCrossover&#34;</span>, 
</span></span><span style=display:flex><span>           arguments <span style=color:#f92672>=</span> <span style=color:#a6e22e>list</span>(columns <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;macd.MACD_8_21_35&#34;</span>, 
</span></span><span style=display:flex><span>                                        <span style=color:#e6db74>&#34;signal.MACD_8_21_35&#34;</span>), 
</span></span><span style=display:flex><span>                            relationship <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;lte&#34;</span>),
</span></span><span style=display:flex><span>           label <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Sell_Signal&#34;</span>)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;MACD_Strategy&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 添加交易规则</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>add.rule</span>(strategy.st, 
</span></span><span style=display:flex><span>         name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ruleSignal&#34;</span>, 
</span></span><span style=display:flex><span>         arguments <span style=color:#f92672>=</span> <span style=color:#a6e22e>list</span>(sigcol <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Buy_Signal&#34;</span>, 
</span></span><span style=display:flex><span>                          sigval <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>, 
</span></span><span style=display:flex><span>                          orderqty <span style=color:#f92672>=</span> <span style=color:#ae81ff>1000</span>, 
</span></span><span style=display:flex><span>                          ordertype <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;market&#34;</span>, 
</span></span><span style=display:flex><span>                          orderside <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;long&#34;</span>, 
</span></span><span style=display:flex><span>                          replace <span style=color:#f92672>=</span> <span style=color:#66d9ef>FALSE</span>, 
</span></span><span style=display:flex><span>                          prefer <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Close&#34;</span>),
</span></span><span style=display:flex><span>         type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;enter&#34;</span>, 
</span></span><span style=display:flex><span>         label <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Enter_Long&#34;</span>)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;MACD_Strategy&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>add.rule</span>(strategy.st, 
</span></span><span style=display:flex><span>         name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ruleSignal&#34;</span>, 
</span></span><span style=display:flex><span>         arguments <span style=color:#f92672>=</span> <span style=color:#a6e22e>list</span>(sigcol <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Sell_Signal&#34;</span>, 
</span></span><span style=display:flex><span>                          sigval <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>, 
</span></span><span style=display:flex><span>                          orderqty <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;all&#34;</span>, 
</span></span><span style=display:flex><span>                          ordertype <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;market&#34;</span>, 
</span></span><span style=display:flex><span>                          orderside <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;long&#34;</span>, 
</span></span><span style=display:flex><span>                          replace <span style=color:#f92672>=</span> <span style=color:#66d9ef>FALSE</span>, 
</span></span><span style=display:flex><span>                          prefer <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Close&#34;</span>),
</span></span><span style=display:flex><span>         type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;exit&#34;</span>, 
</span></span><span style=display:flex><span>         label <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Exit_Long&#34;</span>)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;MACD_Strategy&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 添加止损规则（可选）</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>add.rule</span>(strategy.st, 
</span></span><span style=display:flex><span>         name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ruleSignal&#34;</span>, 
</span></span><span style=display:flex><span>         arguments <span style=color:#f92672>=</span> <span style=color:#a6e22e>list</span>(sigcol <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Buy_Signal&#34;</span>, 
</span></span><span style=display:flex><span>                          sigval <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>, 
</span></span><span style=display:flex><span>                          orderqty <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;all&#34;</span>, 
</span></span><span style=display:flex><span>                          ordertype <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;stoplimit&#34;</span>, 
</span></span><span style=display:flex><span>                          threshold <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.05</span>,
</span></span><span style=display:flex><span>                          orderside <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;long&#34;</span>, 
</span></span><span style=display:flex><span>                          replace <span style=color:#f92672>=</span> <span style=color:#66d9ef>FALSE</span>, 
</span></span><span style=display:flex><span>                          prefer <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Close&#34;</span>),
</span></span><span style=display:flex><span>         type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;chain&#34;</span>, 
</span></span><span style=display:flex><span>         parent <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Enter_Long&#34;</span>, 
</span></span><span style=display:flex><span>         label <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Stop_Loss&#34;</span>)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;MACD_Strategy&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 策略回测</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>tryCatch</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>applyStrategy</span>(strategy <span style=color:#f92672>=</span> strategy.st, 
</span></span><span style=display:flex><span>                portfolios <span style=color:#f92672>=</span> portfolio.st, 
</span></span><span style=display:flex><span>                mktdata <span style=color:#f92672>=</span> TSLA)
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e># 更新结果</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>updatePortf</span>(portfolio.st)
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>updateAcct</span>(account.st)
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>updateEndEq</span>(account.st)
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e># 分析回测结果</span>
</span></span><span style=display:flex><span>  port_ret <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>PortfReturns</span>(account.st)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>nrow</span>(port_ret) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e># 计算绩效指标</span>
</span></span><span style=display:flex><span>    sharpe_ratio <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>SharpeRatio.annualized</span>(port_ret, Rf <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.02</span>)
</span></span><span style=display:flex><span>    total_return <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>Return.cumulative</span>(port_ret)
</span></span><span style=display:flex><span>    max_drawdown <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>maxDrawdown</span>(port_ret)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>cat</span>(<span style=color:#e6db74>&#34;策略绩效指标:\n&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>cat</span>(<span style=color:#e6db74>&#34;夏普比率:&#34;</span>, <span style=color:#a6e22e>round</span>(sharpe_ratio, <span style=color:#ae81ff>4</span>), <span style=color:#e6db74>&#34;\n&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>cat</span>(<span style=color:#e6db74>&#34;总回报率:&#34;</span>, <span style=color:#a6e22e>round</span>(total_return, <span style=color:#ae81ff>4</span>), <span style=color:#e6db74>&#34;\n&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>cat</span>(<span style=color:#e6db74>&#34;最大回撤:&#34;</span>, <span style=color:#a6e22e>round</span>(max_drawdown, <span style=color:#ae81ff>4</span>), <span style=color:#e6db74>&#34;\n&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 绘制绩效图表</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>charts.PerformanceSummary</span>(port_ret)
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>cat</span>(<span style=color:#e6db74>&#34;警告: 策略未产生任何交易\n&#34;</span>)
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}, error <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>(e) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cat</span>(<span style=color:#e6db74>&#34;回测失败:&#34;</span>, e<span style=color:#f92672>$</span>message, <span style=color:#e6db74>&#34;\n&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cat</span>(<span style=color:#e6db74>&#34;请检查MACD指标参数和数据格式\n&#34;</span>)
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;2018-04-11 00:00:00 TSLA 1000 @ 20.0620002746582&#34;
## [1] &#34;2018-05-18 00:00:00 TSLA -1000 @ 18.4546661376953&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-07-03 00:00:00 TSLA -1000 @ 20.7240009307861&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-20 00:00:00 TSLA -1000 @ 20.5626678466797&#34;
## [1] &#34;2018-09-21 00:00:00 TSLA 1000 @ 19.9400005340576&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-24 00:00:00 TSLA 1000 @ 19.2333335876465&#34;
## [1] &#34;2018-11-26 00:00:00 TSLA -1000 @ 23.0666675567627&#34;
## [1] &#34;2018-12-06 00:00:00 TSLA 1000 @ 24.2040004730225&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-14 00:00:00 TSLA 1000 @ 22.2933330535889&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-06 00:00:00 TSLA 1000 @ 21.1480007171631&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-04-01 00:00:00 TSLA 1000 @ 19.2786674499512&#34;
## [1] &#34;2019-04-25 00:00:00 TSLA -1000 @ 16.5086669921875&#34;
## [1] &#34;2019-06-10 00:00:00 TSLA 1000 @ 14.1920003890991&#34;
## [1] &#34;2019-07-29 00:00:00 TSLA -1000 @ 15.7180004119873&#34;
## [1] &#34;2019-09-06 00:00:00 TSLA 1000 @ 15.1633329391479&#34;
## [1] &#34;2019-09-26 00:00:00 TSLA -1000 @ 16.1706676483154&#34;
## [1] &#34;2019-09-27 00:00:00 TSLA 1000 @ 16.1420001983643&#34;
## [1] &#34;2019-10-07 00:00:00 TSLA -1000 @ 15.8479995727539&#34;
## [1] &#34;2019-10-10 00:00:00 TSLA 1000 @ 16.3159999847412&#34;
## [1] &#34;2019-11-25 00:00:00 TSLA -1000 @ 22.4226665496826&#34;
## [1] &#34;2019-12-17 00:00:00 TSLA 1000 @ 25.2660007476807&#34;
## [1] &#34;2020-02-26 00:00:00 TSLA -1000 @ 51.9199981689453&#34;
## [1] &#34;2020-04-08 00:00:00 TSLA 1000 @ 36.5893325805664&#34;
## [1] &#34;2020-05-21 00:00:00 TSLA -1000 @ 55.1733322143555&#34;
## [1] &#34;2020-06-03 00:00:00 TSLA 1000 @ 58.8639984130859&#34;
## [1] &#34;2020-06-25 00:00:00 TSLA -1000 @ 65.7320022583008&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-27 00:00:00 TSLA -1000 @ 102.639999389648&#34;
## [1] &#34;2020-08-18 00:00:00 TSLA 1000 @ 125.805999755859&#34;
## [1] &#34;2020-09-08 00:00:00 TSLA -1000 @ 110.069999694824&#34;
## [1] &#34;2020-11-19 00:00:00 TSLA 1000 @ 166.42333984375&#34;
## [1] &#34;2020-12-24 00:00:00 TSLA -1000 @ 220.589996337891&#34;
## [1] &#34;2021-01-05 00:00:00 TSLA 1000 @ 245.036666870117&#34;
## [1] &#34;2021-01-25 00:00:00 TSLA -1000 @ 293.600006103516&#34;
## [1] &#34;2021-04-05 00:00:00 TSLA 1000 @ 230.350006103516&#34;
## [1] &#34;2021-05-04 00:00:00 TSLA -1000 @ 224.533340454102&#34;
## [1] &#34;2021-05-28 00:00:00 TSLA 1000 @ 208.406661987305&#34;
## [1] &#34;2021-07-19 00:00:00 TSLA -1000 @ 215.406661987305&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-18 00:00:00 TSLA -1000 @ 229.663330078125&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-27 00:00:00 TSLA 1000 @ 263.786682128906&#34;
## [1] &#34;2021-11-12 00:00:00 TSLA -1000 @ 344.473327636719&#34;
## [1] &#34;2021-12-29 00:00:00 TSLA 1000 @ 362.063323974609&#34;
## [1] &#34;2022-01-12 00:00:00 TSLA -1000 @ 368.739990234375&#34;
## [1] &#34;2022-01-13 00:00:00 TSLA 1000 @ 343.853332519531&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-03-03 00:00:00 TSLA 1000 @ 279.763336181641&#34;
## [1] &#34;2022-03-08 00:00:00 TSLA -1000 @ 274.799987792969&#34;
## [1] &#34;2022-03-10 00:00:00 TSLA 1000 @ 279.433319091797&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-13 00:00:00 TSLA -1000 @ 340.790008544922&#34;
## [1] &#34;2022-06-02 00:00:00 TSLA 1000 @ 258.333343505859&#34;
## [1] &#34;2022-06-15 00:00:00 TSLA -1000 @ 233&#34;
## [1] &#34;2022-06-16 00:00:00 TSLA 1000 @ 213.100006103516&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-23 00:00:00 TSLA -1000 @ 296.453338623047&#34;
## [1] &#34;2022-09-16 00:00:00 TSLA 1000 @ 303.350006103516&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-31 00:00:00 TSLA 1000 @ 227.539993286133&#34;
## [1] &#34;2022-11-08 00:00:00 TSLA -1000 @ 191.300003051758&#34;
## [1] &#34;2022-11-30 00:00:00 TSLA 1000 @ 194.699996948242&#34;
## [1] &#34;2022-12-14 00:00:00 TSLA -1000 @ 156.800003051758&#34;
## [1] &#34;2023-01-13 00:00:00 TSLA 1000 @ 122.400001525879&#34;
## [1] &#34;2023-03-03 00:00:00 TSLA -1000 @ 197.789993286133&#34;
## [1] &#34;2023-04-03 00:00:00 TSLA 1000 @ 194.770004272461&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-11 00:00:00 TSLA 1000 @ 172.080001831055&#34;
## 策略绩效指标:
## 夏普比率: -13.1638 
## 总回报率: 0.3459 
## 最大回撤: 0.1093
</code></pre><img src=/post/macd_files/figure-html/strategy_setup-1.png width=90% style=display:block;margin:auto><h1 id=参数优化>参数优化</h1><p>MACD指标的主要参数包括快速EMA周期(nFast)、慢速EMA周期(nSlow)和信号线周期(nSig)。
为了找到最佳参数组合，我们将进行参数网格搜索：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 设置参数网格</span>
</span></span><span style=display:flex><span>nFast_values <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c</span>(<span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>16</span>)  <span style=color:#75715e># 快速EMA周期</span>
</span></span><span style=display:flex><span>nSlow_values <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c</span>(<span style=color:#ae81ff>22</span>, <span style=color:#ae81ff>26</span>, <span style=color:#ae81ff>30</span>)  <span style=color:#75715e># 慢速EMA周期</span>
</span></span><span style=display:flex><span>nSig_values <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c</span>(<span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>11</span>)  <span style=color:#75715e># 信号线周期</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 创建参数组合</span>
</span></span><span style=display:flex><span>param_grid <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>expand.grid</span>(nFast <span style=color:#f92672>=</span> nFast_values, 
</span></span><span style=display:flex><span>                          nSlow <span style=color:#f92672>=</span> nSlow_values, 
</span></span><span style=display:flex><span>                          nSig <span style=color:#f92672>=</span> nSig_values)
</span></span><span style=display:flex><span><span style=color:#75715e># 过滤无效组合（确保nFast &lt; nSlow）</span>
</span></span><span style=display:flex><span>param_grid <span style=color:#f92672>&lt;-</span> param_grid[param_grid<span style=color:#f92672>$</span>nFast <span style=color:#f92672>&lt;</span> param_grid<span style=color:#f92672>$</span>nSlow, ]
</span></span><span style=display:flex><span>n_combinations <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>nrow</span>(param_grid)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 初始化结果存储</span>
</span></span><span style=display:flex><span>results <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>data.frame</span>(
</span></span><span style=display:flex><span>  nFast <span style=color:#f92672>=</span> <span style=color:#a6e22e>numeric</span>(n_combinations),
</span></span><span style=display:flex><span>  nSlow <span style=color:#f92672>=</span> <span style=color:#a6e22e>numeric</span>(n_combinations),
</span></span><span style=display:flex><span>  nSig <span style=color:#f92672>=</span> <span style=color:#a6e22e>numeric</span>(n_combinations),
</span></span><span style=display:flex><span>  SharpeRatio <span style=color:#f92672>=</span> <span style=color:#a6e22e>numeric</span>(n_combinations),
</span></span><span style=display:flex><span>  Return <span style=color:#f92672>=</span> <span style=color:#a6e22e>numeric</span>(n_combinations),
</span></span><span style=display:flex><span>  MaxDrawdown <span style=color:#f92672>=</span> <span style=color:#a6e22e>numeric</span>(n_combinations),
</span></span><span style=display:flex><span>  TradeCount <span style=color:#f92672>=</span> <span style=color:#a6e22e>numeric</span>(n_combinations)
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 循环测试不同参数组合</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (i <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>:</span>n_combinations) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cat</span>(<span style=color:#a6e22e>paste0</span>(<span style=color:#e6db74>&#34;测试参数组合 &#34;</span>, i, <span style=color:#e6db74>&#34;/&#34;</span>, n_combinations, <span style=color:#e6db74>&#34;: nFast=&#34;</span>, 
</span></span><span style=display:flex><span>             param_grid<span style=color:#f92672>$</span>nFast[i], <span style=color:#e6db74>&#34;, nSlow=&#34;</span>, param_grid<span style=color:#f92672>$</span>nSlow[i], 
</span></span><span style=display:flex><span>             <span style=color:#e6db74>&#34;, nSig=&#34;</span>, param_grid<span style=color:#f92672>$</span>nSig[i], <span style=color:#e6db74>&#34;\n&#34;</span>))
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e># 重置历史环境</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>reset_strategy_env</span>()
</span></span><span style=display:flex><span>  <span style=color:#75715e># 清除之前的策略</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rm</span>(list <span style=color:#f92672>=</span> <span style=color:#a6e22e>ls</span>(.blotter))
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rm</span>(list <span style=color:#f92672>=</span> <span style=color:#a6e22e>ls</span>(.strategy))
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e># 初始化新策略</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>initPortf</span>(portfolio.st, symbols <span style=color:#f92672>=</span> symbols.st)
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>initAcct</span>(account.st, portfolios <span style=color:#f92672>=</span> portfolio.st, initEq <span style=color:#f92672>=</span> initEq.st)
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>initOrders</span>(portfolio <span style=color:#f92672>=</span> portfolio.st)
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>strategy</span>(strategy.st, store <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>)
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e># 添加MACD指标，使用当前参数组合</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  indicator_label <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>paste0</span>(<span style=color:#e6db74>&#34;MACD_&#34;</span>, 
</span></span><span style=display:flex><span>                            param_grid<span style=color:#f92672>$</span>nFast[i], 
</span></span><span style=display:flex><span>                            <span style=color:#e6db74>&#34;_&#34;</span>, 
</span></span><span style=display:flex><span>                            param_grid<span style=color:#f92672>$</span>nSlow[i], 
</span></span><span style=display:flex><span>                            <span style=color:#e6db74>&#34;_&#34;</span>, 
</span></span><span style=display:flex><span>                            param_grid<span style=color:#f92672>$</span>nSig[i])
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>add.indicator</span>(strategy.st, 
</span></span><span style=display:flex><span>                name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;MACD&#34;</span>, 
</span></span><span style=display:flex><span>                arguments <span style=color:#f92672>=</span> <span style=color:#a6e22e>list</span>(x <span style=color:#f92672>=</span> <span style=color:#a6e22e>quote</span>(<span style=color:#a6e22e>Cl</span>(mktdata)), 
</span></span><span style=display:flex><span>                                 nFast <span style=color:#f92672>=</span> param_grid<span style=color:#f92672>$</span>nFast[i], 
</span></span><span style=display:flex><span>                                 nSlow <span style=color:#f92672>=</span> param_grid<span style=color:#f92672>$</span>nSlow[i], 
</span></span><span style=display:flex><span>                                 nSig <span style=color:#f92672>=</span> param_grid<span style=color:#f92672>$</span>nSig[i]),
</span></span><span style=display:flex><span>                label <span style=color:#f92672>=</span> indicator_label
</span></span><span style=display:flex><span>                )
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e># 生成指标列名</span>
</span></span><span style=display:flex><span>  macd_col <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>paste0</span>(<span style=color:#e6db74>&#34;macd.&#34;</span>, indicator_label)
</span></span><span style=display:flex><span>  signal_col <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>paste0</span>(<span style=color:#e6db74>&#34;signal.&#34;</span>, indicator_label)
</span></span><span style=display:flex><span>  <span style=color:#75715e># 添加与之前相同的交易信号和规则</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># 买入信号</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>add.signal</span>(strategy.st, 
</span></span><span style=display:flex><span>             name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;sigCrossover&#34;</span>, 
</span></span><span style=display:flex><span>             arguments <span style=color:#f92672>=</span> <span style=color:#a6e22e>list</span>(columns <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(macd_col,signal_col), 
</span></span><span style=display:flex><span>                          relationship <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;gte&#34;</span>),
</span></span><span style=display:flex><span>             label <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Buy_Signal&#34;</span>)
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e># 卖出信号</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>add.signal</span>(strategy.st, 
</span></span><span style=display:flex><span>             name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;sigCrossover&#34;</span>, 
</span></span><span style=display:flex><span>             arguments <span style=color:#f92672>=</span> <span style=color:#a6e22e>list</span>(columns <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(macd_col,signal_col), 
</span></span><span style=display:flex><span>                          relationship <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;lte&#34;</span>),
</span></span><span style=display:flex><span>             label <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Sell_Signal&#34;</span>)
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e># 添加交易规则</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>add.rule</span>(strategy.st, 
</span></span><span style=display:flex><span>           name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ruleSignal&#34;</span>, 
</span></span><span style=display:flex><span>           arguments <span style=color:#f92672>=</span> <span style=color:#a6e22e>list</span>(sigcol <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Buy_Signal&#34;</span>, 
</span></span><span style=display:flex><span>                            sigval <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>, 
</span></span><span style=display:flex><span>                            orderqty <span style=color:#f92672>=</span> <span style=color:#ae81ff>1000</span>, 
</span></span><span style=display:flex><span>                            ordertype <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;market&#34;</span>, 
</span></span><span style=display:flex><span>                            orderside <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;long&#34;</span>, 
</span></span><span style=display:flex><span>                            replace <span style=color:#f92672>=</span> <span style=color:#66d9ef>FALSE</span>, 
</span></span><span style=display:flex><span>                            prefer <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Close&#34;</span>),
</span></span><span style=display:flex><span>           type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;enter&#34;</span>, 
</span></span><span style=display:flex><span>           label <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Enter_Long&#34;</span>)
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>add.rule</span>(strategy.st, 
</span></span><span style=display:flex><span>           name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ruleSignal&#34;</span>, 
</span></span><span style=display:flex><span>           arguments <span style=color:#f92672>=</span> <span style=color:#a6e22e>list</span>(sigcol <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Sell_Signal&#34;</span>, 
</span></span><span style=display:flex><span>                            sigval <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>, 
</span></span><span style=display:flex><span>                            orderqty <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;all&#34;</span>, 
</span></span><span style=display:flex><span>                            ordertype <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;market&#34;</span>, 
</span></span><span style=display:flex><span>                            orderside <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;long&#34;</span>, 
</span></span><span style=display:flex><span>                            replace <span style=color:#f92672>=</span> <span style=color:#66d9ef>FALSE</span>, 
</span></span><span style=display:flex><span>                            prefer <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Close&#34;</span>),
</span></span><span style=display:flex><span>           type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;exit&#34;</span>, 
</span></span><span style=display:flex><span>           label <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Exit_Long&#34;</span>)
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e># 运行回测</span>
</span></span><span style=display:flex><span>  out <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>try</span>(<span style=color:#a6e22e>applyStrategy</span>(strategy <span style=color:#f92672>=</span> strategy.st, 
</span></span><span style=display:flex><span>                           portfolios <span style=color:#f92672>=</span> portfolio.st), 
</span></span><span style=display:flex><span>             silent <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>)
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>inherits</span>(out, <span style=color:#e6db74>&#34;try-error&#34;</span>)) {
</span></span><span style=display:flex><span>    <span style=color:#75715e># 分析结果</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>updatePortf</span>(portfolio.st)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>updateAcct</span>(account.st)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>updateEndEq</span>(account.st)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 获取策略收益</span>
</span></span><span style=display:flex><span>    port_ret <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>PortfReturns</span>(account.st)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 计算评估指标</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>nrow</span>(port_ret) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>      sharpe_ratio <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>SharpeRatio.annualized</span>(port_ret)
</span></span><span style=display:flex><span>      total_return <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>Return.cumulative</span>(port_ret)
</span></span><span style=display:flex><span>      max_drawdown <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>maxDrawdown</span>(port_ret)
</span></span><span style=display:flex><span>      trade_count <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>length</span>(<span style=color:#a6e22e>index</span>(<span style=color:#a6e22e>getTxns</span>(Portfolio <span style=color:#f92672>=</span> portfolio.st, 
</span></span><span style=display:flex><span>                                          Symbol <span style=color:#f92672>=</span> symbols.st)
</span></span><span style=display:flex><span>                                  )
</span></span><span style=display:flex><span>                            )
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      <span style=color:#75715e># 存储结果</span>
</span></span><span style=display:flex><span>      results[i, ] <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c</span>(param_grid<span style=color:#f92672>$</span>nFast[i], 
</span></span><span style=display:flex><span>                        param_grid<span style=color:#f92672>$</span>nSlow[i], 
</span></span><span style=display:flex><span>                        param_grid<span style=color:#f92672>$</span>nSig[i], 
</span></span><span style=display:flex><span>                        sharpe_ratio, 
</span></span><span style=display:flex><span>                        total_return, 
</span></span><span style=display:flex><span>                        max_drawdown, 
</span></span><span style=display:flex><span>                        trade_count)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><pre tabindex=0><code>## 测试参数组合 1/27: nFast=8, nSlow=22, nSig=7
## 策略环境已重置
## [1] &#34;2018-02-21 00:00:00 TSLA 1000 @ 22.2199993133545&#34;
## [1] &#34;2018-03-02 00:00:00 TSLA -1000 @ 22.3413333892822&#34;
## [1] &#34;2018-03-14 00:00:00 TSLA 1000 @ 21.775333404541&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-06 00:00:00 TSLA 1000 @ 19.953332901001&#34;
## [1] &#34;2018-04-25 00:00:00 TSLA -1000 @ 18.71266746521&#34;
## [1] &#34;2018-04-30 00:00:00 TSLA 1000 @ 19.5933322906494&#34;
## [1] &#34;2018-05-16 00:00:00 TSLA -1000 @ 19.0986671447754&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-06-25 00:00:00 TSLA -1000 @ 22.2006664276123&#34;
## [1] &#34;2018-07-20 00:00:00 TSLA 1000 @ 20.9053325653076&#34;
## [1] &#34;2018-07-23 00:00:00 TSLA -1000 @ 20.2133331298828&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-16 00:00:00 TSLA -1000 @ 22.3633327484131&#34;
## [1] &#34;2018-09-14 00:00:00 TSLA 1000 @ 19.6800003051758&#34;
## [1] &#34;2018-10-01 00:00:00 TSLA -1000 @ 20.7133331298828&#34;
## [1] &#34;2018-10-02 00:00:00 TSLA 1000 @ 20.068000793457&#34;
## [1] &#34;2018-10-05 00:00:00 TSLA -1000 @ 17.4633331298828&#34;
## [1] &#34;2018-10-17 00:00:00 TSLA 1000 @ 18.1186676025391&#34;
## [1] &#34;2018-11-13 00:00:00 TSLA -1000 @ 22.5820007324219&#34;
## [1] &#34;2018-12-06 00:00:00 TSLA 1000 @ 24.2040004730225&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-08 00:00:00 TSLA 1000 @ 22.3566665649414&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-01 00:00:00 TSLA 1000 @ 20.8139991760254&#34;
## [1] &#34;2019-02-21 00:00:00 TSLA -1000 @ 19.4153327941895&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-14 00:00:00 TSLA 1000 @ 19.3306674957275&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-28 00:00:00 TSLA 1000 @ 18.5746669769287&#34;
## [1] &#34;2019-04-12 00:00:00 TSLA -1000 @ 17.8466663360596&#34;
## [1] &#34;2019-04-18 00:00:00 TSLA 1000 @ 18.2173328399658&#34;
## [1] &#34;2019-04-23 00:00:00 TSLA -1000 @ 17.5933322906494&#34;
## [1] &#34;2019-05-06 00:00:00 TSLA 1000 @ 17.0226669311523&#34;
## [1] &#34;2019-05-14 00:00:00 TSLA -1000 @ 15.4873332977295&#34;
## [1] &#34;2019-06-05 00:00:00 TSLA 1000 @ 13.1059999465942&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-08-30 00:00:00 TSLA 1000 @ 15.0406665802002&#34;
## [1] &#34;2019-09-24 00:00:00 TSLA -1000 @ 14.8806667327881&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-10 00:00:00 TSLA 1000 @ 16.3159999847412&#34;
## [1] &#34;2019-10-24 00:00:00 TSLA -1000 @ 19.978666305542&#34;
## [1] &#34;2019-10-25 00:00:00 TSLA 1000 @ 21.8753337860107&#34;
## [1] &#34;2019-11-07 00:00:00 TSLA -1000 @ 22.3693332672119&#34;
## [1] &#34;2019-11-08 00:00:00 TSLA 1000 @ 22.4759998321533&#34;
## [1] &#34;2019-11-14 00:00:00 TSLA -1000 @ 23.2900009155273&#34;
## [1] &#34;2019-12-12 00:00:00 TSLA 1000 @ 23.978666305542&#34;
## [1] &#34;2020-01-02 00:00:00 TSLA -1000 @ 28.6840000152588&#34;
## [1] &#34;2020-01-06 00:00:00 TSLA 1000 @ 30.1026668548584&#34;
## [1] &#34;2020-01-21 00:00:00 TSLA -1000 @ 36.4799995422363&#34;
## [1] &#34;2020-01-22 00:00:00 TSLA 1000 @ 37.9706687927246&#34;
## [1] &#34;2020-01-28 00:00:00 TSLA -1000 @ 37.7933311462402&#34;
## [1] &#34;2020-01-31 00:00:00 TSLA 1000 @ 43.3713340759277&#34;
## [1] &#34;2020-02-12 00:00:00 TSLA -1000 @ 51.1526679992676&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-24 00:00:00 TSLA -1000 @ 55.5859985351562&#34;
## [1] &#34;2020-03-26 00:00:00 TSLA 1000 @ 35.2106666564941&#34;
## [1] &#34;2020-05-04 00:00:00 TSLA -1000 @ 50.7459983825684&#34;
## [1] &#34;2020-06-02 00:00:00 TSLA 1000 @ 58.7706680297852&#34;
## [1] &#34;2020-06-22 00:00:00 TSLA -1000 @ 66.2880020141602&#34;
## [1] &#34;2020-07-01 00:00:00 TSLA 1000 @ 74.6419982910156&#34;
## [1] &#34;2020-07-20 00:00:00 TSLA -1000 @ 109.533332824707&#34;
## [1] &#34;2020-07-21 00:00:00 TSLA 1000 @ 104.557334899902&#34;
## [1] &#34;2020-07-22 00:00:00 TSLA -1000 @ 106.155334472656&#34;
## [1] &#34;2020-08-14 00:00:00 TSLA 1000 @ 110.047332763672&#34;
## [1] &#34;2020-09-04 00:00:00 TSLA -1000 @ 139.440002441406&#34;
## [1] &#34;2020-09-17 00:00:00 TSLA 1000 @ 141.143325805664&#34;
## [1] &#34;2020-09-23 00:00:00 TSLA -1000 @ 126.786666870117&#34;
## [1] &#34;2020-10-02 00:00:00 TSLA 1000 @ 138.363327026367&#34;
## [1] &#34;2020-10-05 00:00:00 TSLA -1000 @ 141.893325805664&#34;
## [1] &#34;2020-10-13 00:00:00 TSLA 1000 @ 148.883331298828&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-06 00:00:00 TSLA 1000 @ 143.316665649414&#34;
## [1] &#34;2020-11-13 00:00:00 TSLA -1000 @ 136.16667175293&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-11 00:00:00 TSLA -1000 @ 203.330001831055&#34;
## [1] &#34;2021-01-05 00:00:00 TSLA 1000 @ 245.036666870117&#34;
## [1] &#34;2021-01-19 00:00:00 TSLA -1000 @ 281.516662597656&#34;
## [1] &#34;2021-03-11 00:00:00 TSLA 1000 @ 233.199996948242&#34;
## [1] &#34;2021-03-26 00:00:00 TSLA -1000 @ 206.236663818359&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-28 00:00:00 TSLA -1000 @ 231.466659545898&#34;
## [1] &#34;2021-05-25 00:00:00 TSLA 1000 @ 201.563339233398&#34;
## [1] &#34;2021-07-08 00:00:00 TSLA -1000 @ 217.603332519531&#34;
## [1] &#34;2021-07-30 00:00:00 TSLA 1000 @ 229.066665649414&#34;
## [1] &#34;2021-08-17 00:00:00 TSLA -1000 @ 221.903335571289&#34;
## [1] &#34;2021-08-26 00:00:00 TSLA 1000 @ 233.720001220703&#34;
## [1] &#34;2021-09-14 00:00:00 TSLA -1000 @ 248.163330078125&#34;
## [1] &#34;2021-09-27 00:00:00 TSLA 1000 @ 263.786682128906&#34;
## [1] &#34;2021-10-05 00:00:00 TSLA -1000 @ 260.196655273438&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-09 00:00:00 TSLA -1000 @ 341.166656494141&#34;
## [1] &#34;2021-12-23 00:00:00 TSLA 1000 @ 355.666656494141&#34;
## [1] &#34;2022-01-10 00:00:00 TSLA -1000 @ 352.706665039062&#34;
## [1] &#34;2022-02-07 00:00:00 TSLA 1000 @ 302.446655273438&#34;
## [1] &#34;2022-02-23 00:00:00 TSLA -1000 @ 254.679992675781&#34;
## [1] &#34;2022-03-01 00:00:00 TSLA 1000 @ 288.123321533203&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-07 00:00:00 TSLA -1000 @ 352.420013427734&#34;
## [1] &#34;2022-05-27 00:00:00 TSLA 1000 @ 253.210006713867&#34;
## [1] &#34;2022-06-14 00:00:00 TSLA -1000 @ 220.889999389648&#34;
## [1] &#34;2022-06-16 00:00:00 TSLA 1000 @ 213.100006103516&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-09 00:00:00 TSLA -1000 @ 283.333343505859&#34;
## [1] &#34;2022-09-12 00:00:00 TSLA 1000 @ 304.420013427734&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-20 00:00:00 TSLA 1000 @ 207.279998779297&#34;
## [1] &#34;2022-11-08 00:00:00 TSLA -1000 @ 191.300003051758&#34;
## [1] &#34;2022-11-28 00:00:00 TSLA 1000 @ 182.919998168945&#34;
## [1] &#34;2022-12-09 00:00:00 TSLA -1000 @ 179.050003051758&#34;
## [1] &#34;2022-12-12 00:00:00 TSLA 1000 @ 167.820007324219&#34;
## [1] &#34;2022-12-13 00:00:00 TSLA -1000 @ 160.949996948242&#34;
## [1] &#34;2023-01-10 00:00:00 TSLA 1000 @ 118.849998474121&#34;
## [1] &#34;2023-02-14 00:00:00 TSLA -1000 @ 209.25&#34;
## [1] &#34;2023-02-16 00:00:00 TSLA 1000 @ 202.039993286133&#34;
## [1] &#34;2023-02-17 00:00:00 TSLA -1000 @ 208.309997558594&#34;
## [1] &#34;2023-03-22 00:00:00 TSLA 1000 @ 191.149993896484&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-05 00:00:00 TSLA 1000 @ 170.059997558594&#34;
## 测试参数组合 2/27: nFast=12, nSlow=22, nSig=7
## 策略环境已重置
## [1] &#34;2018-02-22 00:00:00 TSLA 1000 @ 23.0779991149902&#34;
## [1] &#34;2018-03-05 00:00:00 TSLA -1000 @ 22.2233333587646&#34;
## [1] &#34;2018-03-14 00:00:00 TSLA 1000 @ 21.775333404541&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-06 00:00:00 TSLA 1000 @ 19.953332901001&#34;
## [1] &#34;2018-04-26 00:00:00 TSLA -1000 @ 19.0319995880127&#34;
## [1] &#34;2018-04-30 00:00:00 TSLA 1000 @ 19.5933322906494&#34;
## [1] &#34;2018-05-16 00:00:00 TSLA -1000 @ 19.0986671447754&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-06-25 00:00:00 TSLA -1000 @ 22.2006664276123&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-17 00:00:00 TSLA -1000 @ 20.3666667938232&#34;
## [1] &#34;2018-09-17 00:00:00 TSLA 1000 @ 19.6560001373291&#34;
## [1] &#34;2018-10-05 00:00:00 TSLA -1000 @ 17.4633331298828&#34;
## [1] &#34;2018-10-18 00:00:00 TSLA 1000 @ 17.5939998626709&#34;
## [1] &#34;2018-11-14 00:00:00 TSLA -1000 @ 22.9333324432373&#34;
## [1] &#34;2018-12-07 00:00:00 TSLA 1000 @ 23.8646678924561&#34;
## [1] &#34;2018-12-10 00:00:00 TSLA -1000 @ 24.3433322906494&#34;
## [1] &#34;2018-12-11 00:00:00 TSLA 1000 @ 24.4506664276123&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-09 00:00:00 TSLA 1000 @ 22.5686664581299&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-04 00:00:00 TSLA 1000 @ 20.8593330383301&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-14 00:00:00 TSLA 1000 @ 19.3306674957275&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-28 00:00:00 TSLA 1000 @ 18.5746669769287&#34;
## [1] &#34;2019-04-15 00:00:00 TSLA -1000 @ 17.7586669921875&#34;
## [1] &#34;2019-04-18 00:00:00 TSLA 1000 @ 18.2173328399658&#34;
## [1] &#34;2019-04-23 00:00:00 TSLA -1000 @ 17.5933322906494&#34;
## [1] &#34;2019-05-07 00:00:00 TSLA 1000 @ 16.470666885376&#34;
## [1] &#34;2019-05-14 00:00:00 TSLA -1000 @ 15.4873332977295&#34;
## [1] &#34;2019-06-06 00:00:00 TSLA 1000 @ 13.7299995422363&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-09-03 00:00:00 TSLA 1000 @ 15.0006666183472&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-18 00:00:00 TSLA -1000 @ 23.3326663970947&#34;
## [1] &#34;2019-12-13 00:00:00 TSLA 1000 @ 23.8926677703857&#34;
## [1] &#34;2020-01-28 00:00:00 TSLA -1000 @ 37.7933311462402&#34;
## [1] &#34;2020-01-31 00:00:00 TSLA 1000 @ 43.3713340759277&#34;
## [1] &#34;2020-02-13 00:00:00 TSLA -1000 @ 53.5999984741211&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-03-27 00:00:00 TSLA 1000 @ 34.2906684875488&#34;
## [1] &#34;2020-05-04 00:00:00 TSLA -1000 @ 50.7459983825684&#34;
## [1] &#34;2020-06-02 00:00:00 TSLA 1000 @ 58.7706680297852&#34;
## [1] &#34;2020-06-23 00:00:00 TSLA -1000 @ 66.7853317260742&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-22 00:00:00 TSLA -1000 @ 106.155334472656&#34;
## [1] &#34;2020-08-17 00:00:00 TSLA 1000 @ 122.375999450684&#34;
## [1] &#34;2020-09-04 00:00:00 TSLA -1000 @ 139.440002441406&#34;
## [1] &#34;2020-09-22 00:00:00 TSLA 1000 @ 141.410003662109&#34;
## [1] &#34;2020-09-23 00:00:00 TSLA -1000 @ 126.786666870117&#34;
## [1] &#34;2020-10-02 00:00:00 TSLA 1000 @ 138.363327026367&#34;
## [1] &#34;2020-10-05 00:00:00 TSLA -1000 @ 141.893325805664&#34;
## [1] &#34;2020-10-13 00:00:00 TSLA 1000 @ 148.883331298828&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-06 00:00:00 TSLA 1000 @ 143.316665649414&#34;
## [1] &#34;2020-11-11 00:00:00 TSLA -1000 @ 139.043334960938&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-14 00:00:00 TSLA -1000 @ 213.276672363281&#34;
## [1] &#34;2021-01-05 00:00:00 TSLA 1000 @ 245.036666870117&#34;
## [1] &#34;2021-01-20 00:00:00 TSLA -1000 @ 283.483337402344&#34;
## [1] &#34;2021-03-12 00:00:00 TSLA 1000 @ 231.24333190918&#34;
## [1] &#34;2021-03-29 00:00:00 TSLA -1000 @ 203.763336181641&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-28 00:00:00 TSLA -1000 @ 231.466659545898&#34;
## [1] &#34;2021-05-26 00:00:00 TSLA 1000 @ 206.376663208008&#34;
## [1] &#34;2021-07-08 00:00:00 TSLA -1000 @ 217.603332519531&#34;
## [1] &#34;2021-07-30 00:00:00 TSLA 1000 @ 229.066665649414&#34;
## [1] &#34;2021-08-17 00:00:00 TSLA -1000 @ 221.903335571289&#34;
## [1] &#34;2021-08-30 00:00:00 TSLA 1000 @ 243.636672973633&#34;
## [1] &#34;2021-09-15 00:00:00 TSLA -1000 @ 251.943328857422&#34;
## [1] &#34;2021-09-16 00:00:00 TSLA 1000 @ 252.330001831055&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-06 00:00:00 TSLA -1000 @ 260.916656494141&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-10 00:00:00 TSLA -1000 @ 355.983337402344&#34;
## [1] &#34;2021-12-27 00:00:00 TSLA 1000 @ 364.646667480469&#34;
## [1] &#34;2022-01-11 00:00:00 TSLA -1000 @ 354.799987792969&#34;
## [1] &#34;2022-01-13 00:00:00 TSLA 1000 @ 343.853332519531&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-08 00:00:00 TSLA 1000 @ 307.333343505859&#34;
## [1] &#34;2022-02-15 00:00:00 TSLA -1000 @ 307.476654052734&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-23 00:00:00 TSLA -1000 @ 254.679992675781&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-08 00:00:00 TSLA -1000 @ 341.829986572266&#34;
## [1] &#34;2022-05-31 00:00:00 TSLA 1000 @ 252.753326416016&#34;
## [1] &#34;2022-06-15 00:00:00 TSLA -1000 @ 233&#34;
## [1] &#34;2022-06-16 00:00:00 TSLA 1000 @ 213.100006103516&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-10 00:00:00 TSLA -1000 @ 294.356658935547&#34;
## [1] &#34;2022-09-12 00:00:00 TSLA 1000 @ 304.420013427734&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-25 00:00:00 TSLA 1000 @ 222.419998168945&#34;
## [1] &#34;2022-11-08 00:00:00 TSLA -1000 @ 191.300003051758&#34;
## [1] &#34;2022-11-28 00:00:00 TSLA 1000 @ 182.919998168945&#34;
## [1] &#34;2022-12-13 00:00:00 TSLA -1000 @ 160.949996948242&#34;
## [1] &#34;2023-01-10 00:00:00 TSLA 1000 @ 118.849998474121&#34;
## [1] &#34;2023-02-17 00:00:00 TSLA -1000 @ 208.309997558594&#34;
## [1] &#34;2023-03-22 00:00:00 TSLA 1000 @ 191.149993896484&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-08 00:00:00 TSLA 1000 @ 171.789993286133&#34;
## 测试参数组合 3/27: nFast=16, nSlow=22, nSig=7
## 策略环境已重置
## [1] &#34;2018-02-23 00:00:00 TSLA 1000 @ 23.4699993133545&#34;
## [1] &#34;2018-03-05 00:00:00 TSLA -1000 @ 22.2233333587646&#34;
## [1] &#34;2018-03-14 00:00:00 TSLA 1000 @ 21.775333404541&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-09 00:00:00 TSLA 1000 @ 19.3106670379639&#34;
## [1] &#34;2018-05-16 00:00:00 TSLA -1000 @ 19.0986671447754&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-06-26 00:00:00 TSLA -1000 @ 22.7999992370605&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-20 00:00:00 TSLA -1000 @ 20.5626678466797&#34;
## [1] &#34;2018-09-18 00:00:00 TSLA 1000 @ 18.9973335266113&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-18 00:00:00 TSLA 1000 @ 17.5939998626709&#34;
## [1] &#34;2018-11-15 00:00:00 TSLA -1000 @ 23.2293338775635&#34;
## [1] &#34;2018-12-11 00:00:00 TSLA 1000 @ 24.4506664276123&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-09 00:00:00 TSLA 1000 @ 22.5686664581299&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-05 00:00:00 TSLA 1000 @ 21.4233322143555&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-15 00:00:00 TSLA 1000 @ 18.3619995117188&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-29 00:00:00 TSLA 1000 @ 18.6573333740234&#34;
## [1] &#34;2019-04-15 00:00:00 TSLA -1000 @ 17.7586669921875&#34;
## [1] &#34;2019-04-17 00:00:00 TSLA 1000 @ 18.0820007324219&#34;
## [1] &#34;2019-04-23 00:00:00 TSLA -1000 @ 17.5933322906494&#34;
## [1] &#34;2019-05-07 00:00:00 TSLA 1000 @ 16.470666885376&#34;
## [1] &#34;2019-05-13 00:00:00 TSLA -1000 @ 15.1339998245239&#34;
## [1] &#34;2019-06-06 00:00:00 TSLA 1000 @ 13.7299995422363&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-09-03 00:00:00 TSLA 1000 @ 15.0006666183472&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-19 00:00:00 TSLA -1000 @ 23.9680004119873&#34;
## [1] &#34;2019-12-16 00:00:00 TSLA 1000 @ 25.4333324432373&#34;
## [1] &#34;2020-01-29 00:00:00 TSLA -1000 @ 38.732666015625&#34;
## [1] &#34;2020-01-31 00:00:00 TSLA 1000 @ 43.3713340759277&#34;
## [1] &#34;2020-02-13 00:00:00 TSLA -1000 @ 53.5999984741211&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-03-30 00:00:00 TSLA 1000 @ 33.4753341674805&#34;
## [1] &#34;2020-05-06 00:00:00 TSLA -1000 @ 52.1720008850098&#34;
## [1] &#34;2020-06-03 00:00:00 TSLA 1000 @ 58.8639984130859&#34;
## [1] &#34;2020-06-05 00:00:00 TSLA -1000 @ 59.0439987182617&#34;
## [1] &#34;2020-06-09 00:00:00 TSLA 1000 @ 62.7113342285156&#34;
## [1] &#34;2020-06-23 00:00:00 TSLA -1000 @ 66.7853317260742&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-23 00:00:00 TSLA -1000 @ 100.87133026123&#34;
## [1] &#34;2020-08-18 00:00:00 TSLA 1000 @ 125.805999755859&#34;
## [1] &#34;2020-09-04 00:00:00 TSLA -1000 @ 139.440002441406&#34;
## [1] &#34;2020-10-14 00:00:00 TSLA 1000 @ 153.766662597656&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-09 00:00:00 TSLA 1000 @ 140.419998168945&#34;
## [1] &#34;2020-11-11 00:00:00 TSLA -1000 @ 139.043334960938&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-16 00:00:00 TSLA -1000 @ 207.589996337891&#34;
## [1] &#34;2020-12-21 00:00:00 TSLA 1000 @ 216.619995117188&#34;
## [1] &#34;2020-12-22 00:00:00 TSLA -1000 @ 213.446670532227&#34;
## [1] &#34;2021-01-06 00:00:00 TSLA 1000 @ 251.99333190918&#34;
## [1] &#34;2021-01-20 00:00:00 TSLA -1000 @ 283.483337402344&#34;
## [1] &#34;2021-03-15 00:00:00 TSLA 1000 @ 235.979995727539&#34;
## [1] &#34;2021-03-29 00:00:00 TSLA -1000 @ 203.763336181641&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-29 00:00:00 TSLA -1000 @ 225.66667175293&#34;
## [1] &#34;2021-05-27 00:00:00 TSLA 1000 @ 210.283340454102&#34;
## [1] &#34;2021-07-09 00:00:00 TSLA -1000 @ 218.983337402344&#34;
## [1] &#34;2021-07-13 00:00:00 TSLA 1000 @ 222.846664428711&#34;
## [1] &#34;2021-07-14 00:00:00 TSLA -1000 @ 217.793334960938&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-17 00:00:00 TSLA -1000 @ 221.903335571289&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-06 00:00:00 TSLA -1000 @ 260.916656494141&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-10 00:00:00 TSLA -1000 @ 355.983337402344&#34;
## [1] &#34;2021-12-27 00:00:00 TSLA 1000 @ 364.646667480469&#34;
## [1] &#34;2022-01-12 00:00:00 TSLA -1000 @ 368.739990234375&#34;
## [1] &#34;2022-01-13 00:00:00 TSLA 1000 @ 343.853332519531&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-09 00:00:00 TSLA 1000 @ 310.666656494141&#34;
## [1] &#34;2022-02-14 00:00:00 TSLA -1000 @ 291.920013427734&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-23 00:00:00 TSLA -1000 @ 254.679992675781&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-11 00:00:00 TSLA -1000 @ 325.309997558594&#34;
## [1] &#34;2022-05-31 00:00:00 TSLA 1000 @ 252.753326416016&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-11 00:00:00 TSLA -1000 @ 286.630004882812&#34;
## [1] &#34;2022-09-13 00:00:00 TSLA 1000 @ 292.130004882812&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-26 00:00:00 TSLA 1000 @ 224.639999389648&#34;
## [1] &#34;2022-11-08 00:00:00 TSLA -1000 @ 191.300003051758&#34;
## [1] &#34;2022-11-28 00:00:00 TSLA 1000 @ 182.919998168945&#34;
## [1] &#34;2022-12-14 00:00:00 TSLA -1000 @ 156.800003051758&#34;
## [1] &#34;2023-01-11 00:00:00 TSLA 1000 @ 123.220001220703&#34;
## [1] &#34;2023-02-22 00:00:00 TSLA -1000 @ 200.860000610352&#34;
## [1] &#34;2023-03-24 00:00:00 TSLA 1000 @ 190.410003662109&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-08 00:00:00 TSLA 1000 @ 171.789993286133&#34;
## 测试参数组合 4/27: nFast=8, nSlow=26, nSig=7
## 策略环境已重置
## [1] &#34;2018-02-20 00:00:00 TSLA 1000 @ 22.318000793457&#34;
## [1] &#34;2018-03-05 00:00:00 TSLA -1000 @ 22.2233333587646&#34;
## [1] &#34;2018-03-14 00:00:00 TSLA 1000 @ 21.775333404541&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-06 00:00:00 TSLA 1000 @ 19.953332901001&#34;
## [1] &#34;2018-04-25 00:00:00 TSLA -1000 @ 18.71266746521&#34;
## [1] &#34;2018-04-30 00:00:00 TSLA 1000 @ 19.5933322906494&#34;
## [1] &#34;2018-05-16 00:00:00 TSLA -1000 @ 19.0986671447754&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-06-25 00:00:00 TSLA -1000 @ 22.2006664276123&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-16 00:00:00 TSLA -1000 @ 22.3633327484131&#34;
## [1] &#34;2018-09-14 00:00:00 TSLA 1000 @ 19.6800003051758&#34;
## [1] &#34;2018-10-01 00:00:00 TSLA -1000 @ 20.7133331298828&#34;
## [1] &#34;2018-10-02 00:00:00 TSLA 1000 @ 20.068000793457&#34;
## [1] &#34;2018-10-05 00:00:00 TSLA -1000 @ 17.4633331298828&#34;
## [1] &#34;2018-10-17 00:00:00 TSLA 1000 @ 18.1186676025391&#34;
## [1] &#34;2018-11-13 00:00:00 TSLA -1000 @ 22.5820007324219&#34;
## [1] &#34;2018-12-06 00:00:00 TSLA 1000 @ 24.2040004730225&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-08 00:00:00 TSLA 1000 @ 22.3566665649414&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-04 00:00:00 TSLA 1000 @ 20.8593330383301&#34;
## [1] &#34;2019-02-21 00:00:00 TSLA -1000 @ 19.4153327941895&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-14 00:00:00 TSLA 1000 @ 19.3306674957275&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-28 00:00:00 TSLA 1000 @ 18.5746669769287&#34;
## [1] &#34;2019-04-12 00:00:00 TSLA -1000 @ 17.8466663360596&#34;
## [1] &#34;2019-04-18 00:00:00 TSLA 1000 @ 18.2173328399658&#34;
## [1] &#34;2019-04-23 00:00:00 TSLA -1000 @ 17.5933322906494&#34;
## [1] &#34;2019-05-06 00:00:00 TSLA 1000 @ 17.0226669311523&#34;
## [1] &#34;2019-05-14 00:00:00 TSLA -1000 @ 15.4873332977295&#34;
## [1] &#34;2019-06-05 00:00:00 TSLA 1000 @ 13.1059999465942&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-08-30 00:00:00 TSLA 1000 @ 15.0406665802002&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-10 00:00:00 TSLA 1000 @ 16.3159999847412&#34;
## [1] &#34;2019-10-24 00:00:00 TSLA -1000 @ 19.978666305542&#34;
## [1] &#34;2019-10-25 00:00:00 TSLA 1000 @ 21.8753337860107&#34;
## [1] &#34;2019-11-15 00:00:00 TSLA -1000 @ 23.4780006408691&#34;
## [1] &#34;2019-12-12 00:00:00 TSLA 1000 @ 23.978666305542&#34;
## [1] &#34;2020-01-21 00:00:00 TSLA -1000 @ 36.4799995422363&#34;
## [1] &#34;2020-01-22 00:00:00 TSLA 1000 @ 37.9706687927246&#34;
## [1] &#34;2020-01-28 00:00:00 TSLA -1000 @ 37.7933311462402&#34;
## [1] &#34;2020-01-31 00:00:00 TSLA 1000 @ 43.3713340759277&#34;
## [1] &#34;2020-02-12 00:00:00 TSLA -1000 @ 51.1526679992676&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-03-26 00:00:00 TSLA 1000 @ 35.2106666564941&#34;
## [1] &#34;2020-05-04 00:00:00 TSLA -1000 @ 50.7459983825684&#34;
## [1] &#34;2020-06-02 00:00:00 TSLA 1000 @ 58.7706680297852&#34;
## [1] &#34;2020-06-22 00:00:00 TSLA -1000 @ 66.2880020141602&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-20 00:00:00 TSLA -1000 @ 109.533332824707&#34;
## [1] &#34;2020-07-21 00:00:00 TSLA 1000 @ 104.557334899902&#34;
## [1] &#34;2020-07-22 00:00:00 TSLA -1000 @ 106.155334472656&#34;
## [1] &#34;2020-08-14 00:00:00 TSLA 1000 @ 110.047332763672&#34;
## [1] &#34;2020-09-04 00:00:00 TSLA -1000 @ 139.440002441406&#34;
## [1] &#34;2020-09-21 00:00:00 TSLA 1000 @ 149.796661376953&#34;
## [1] &#34;2020-09-23 00:00:00 TSLA -1000 @ 126.786666870117&#34;
## [1] &#34;2020-10-02 00:00:00 TSLA 1000 @ 138.363327026367&#34;
## [1] &#34;2020-10-05 00:00:00 TSLA -1000 @ 141.893325805664&#34;
## [1] &#34;2020-10-13 00:00:00 TSLA 1000 @ 148.883331298828&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-06 00:00:00 TSLA 1000 @ 143.316665649414&#34;
## [1] &#34;2020-11-12 00:00:00 TSLA -1000 @ 137.253326416016&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-11 00:00:00 TSLA -1000 @ 203.330001831055&#34;
## [1] &#34;2021-01-05 00:00:00 TSLA 1000 @ 245.036666870117&#34;
## [1] &#34;2021-01-19 00:00:00 TSLA -1000 @ 281.516662597656&#34;
## [1] &#34;2021-03-12 00:00:00 TSLA 1000 @ 231.24333190918&#34;
## [1] &#34;2021-03-26 00:00:00 TSLA -1000 @ 206.236663818359&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-28 00:00:00 TSLA -1000 @ 231.466659545898&#34;
## [1] &#34;2021-05-25 00:00:00 TSLA 1000 @ 201.563339233398&#34;
## [1] &#34;2021-07-08 00:00:00 TSLA -1000 @ 217.603332519531&#34;
## [1] &#34;2021-07-30 00:00:00 TSLA 1000 @ 229.066665649414&#34;
## [1] &#34;2021-08-17 00:00:00 TSLA -1000 @ 221.903335571289&#34;
## [1] &#34;2021-08-26 00:00:00 TSLA 1000 @ 233.720001220703&#34;
## [1] &#34;2021-08-27 00:00:00 TSLA -1000 @ 237.306671142578&#34;
## [1] &#34;2021-08-30 00:00:00 TSLA 1000 @ 243.636672973633&#34;
## [1] &#34;2021-09-14 00:00:00 TSLA -1000 @ 248.163330078125&#34;
## [1] &#34;2021-09-17 00:00:00 TSLA 1000 @ 253.163330078125&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-27 00:00:00 TSLA 1000 @ 263.786682128906&#34;
## [1] &#34;2021-10-06 00:00:00 TSLA -1000 @ 260.916656494141&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-10 00:00:00 TSLA -1000 @ 355.983337402344&#34;
## [1] &#34;2021-12-27 00:00:00 TSLA 1000 @ 364.646667480469&#34;
## [1] &#34;2022-01-10 00:00:00 TSLA -1000 @ 352.706665039062&#34;
## [1] &#34;2022-02-07 00:00:00 TSLA 1000 @ 302.446655273438&#34;
## [1] &#34;2022-02-15 00:00:00 TSLA -1000 @ 307.476654052734&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-22 00:00:00 TSLA -1000 @ 273.843322753906&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-07 00:00:00 TSLA -1000 @ 352.420013427734&#34;
## [1] &#34;2022-05-31 00:00:00 TSLA 1000 @ 252.753326416016&#34;
## [1] &#34;2022-06-14 00:00:00 TSLA -1000 @ 220.889999389648&#34;
## [1] &#34;2022-06-16 00:00:00 TSLA 1000 @ 213.100006103516&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-09 00:00:00 TSLA -1000 @ 283.333343505859&#34;
## [1] &#34;2022-09-12 00:00:00 TSLA 1000 @ 304.420013427734&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-20 00:00:00 TSLA 1000 @ 207.279998779297&#34;
## [1] &#34;2022-10-21 00:00:00 TSLA -1000 @ 214.440002441406&#34;
## [1] &#34;2022-10-24 00:00:00 TSLA 1000 @ 211.25&#34;
## [1] &#34;2022-11-08 00:00:00 TSLA -1000 @ 191.300003051758&#34;
## [1] &#34;2022-11-28 00:00:00 TSLA 1000 @ 182.919998168945&#34;
## [1] &#34;2022-12-09 00:00:00 TSLA -1000 @ 179.050003051758&#34;
## [1] &#34;2022-12-12 00:00:00 TSLA 1000 @ 167.820007324219&#34;
## [1] &#34;2022-12-13 00:00:00 TSLA -1000 @ 160.949996948242&#34;
## [1] &#34;2023-01-10 00:00:00 TSLA 1000 @ 118.849998474121&#34;
## [1] &#34;2023-02-17 00:00:00 TSLA -1000 @ 208.309997558594&#34;
## [1] &#34;2023-03-22 00:00:00 TSLA 1000 @ 191.149993896484&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-05 00:00:00 TSLA 1000 @ 170.059997558594&#34;
## 测试参数组合 5/27: nFast=12, nSlow=26, nSig=7
## 策略环境已重置
## [1] &#34;2018-02-22 00:00:00 TSLA 1000 @ 23.0779991149902&#34;
## [1] &#34;2018-03-05 00:00:00 TSLA -1000 @ 22.2233333587646&#34;
## [1] &#34;2018-03-14 00:00:00 TSLA 1000 @ 21.775333404541&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-09 00:00:00 TSLA 1000 @ 19.3106670379639&#34;
## [1] &#34;2018-04-26 00:00:00 TSLA -1000 @ 19.0319995880127&#34;
## [1] &#34;2018-04-27 00:00:00 TSLA 1000 @ 19.6053333282471&#34;
## [1] &#34;2018-05-16 00:00:00 TSLA -1000 @ 19.0986671447754&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-06-26 00:00:00 TSLA -1000 @ 22.7999992370605&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-17 00:00:00 TSLA -1000 @ 20.3666667938232&#34;
## [1] &#34;2018-09-17 00:00:00 TSLA 1000 @ 19.6560001373291&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-18 00:00:00 TSLA 1000 @ 17.5939998626709&#34;
## [1] &#34;2018-11-14 00:00:00 TSLA -1000 @ 22.9333324432373&#34;
## [1] &#34;2018-12-07 00:00:00 TSLA 1000 @ 23.8646678924561&#34;
## [1] &#34;2018-12-10 00:00:00 TSLA -1000 @ 24.3433322906494&#34;
## [1] &#34;2018-12-11 00:00:00 TSLA 1000 @ 24.4506664276123&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-09 00:00:00 TSLA 1000 @ 22.5686664581299&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-04 00:00:00 TSLA 1000 @ 20.8593330383301&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-15 00:00:00 TSLA 1000 @ 18.3619995117188&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-29 00:00:00 TSLA 1000 @ 18.6573333740234&#34;
## [1] &#34;2019-04-15 00:00:00 TSLA -1000 @ 17.7586669921875&#34;
## [1] &#34;2019-04-17 00:00:00 TSLA 1000 @ 18.0820007324219&#34;
## [1] &#34;2019-04-23 00:00:00 TSLA -1000 @ 17.5933322906494&#34;
## [1] &#34;2019-05-07 00:00:00 TSLA 1000 @ 16.470666885376&#34;
## [1] &#34;2019-05-14 00:00:00 TSLA -1000 @ 15.4873332977295&#34;
## [1] &#34;2019-06-06 00:00:00 TSLA 1000 @ 13.7299995422363&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-09-03 00:00:00 TSLA 1000 @ 15.0006666183472&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-19 00:00:00 TSLA -1000 @ 23.9680004119873&#34;
## [1] &#34;2019-12-13 00:00:00 TSLA 1000 @ 23.8926677703857&#34;
## [1] &#34;2020-01-29 00:00:00 TSLA -1000 @ 38.732666015625&#34;
## [1] &#34;2020-01-31 00:00:00 TSLA 1000 @ 43.3713340759277&#34;
## [1] &#34;2020-02-13 00:00:00 TSLA -1000 @ 53.5999984741211&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-03-27 00:00:00 TSLA 1000 @ 34.2906684875488&#34;
## [1] &#34;2020-05-04 00:00:00 TSLA -1000 @ 50.7459983825684&#34;
## [1] &#34;2020-06-03 00:00:00 TSLA 1000 @ 58.8639984130859&#34;
## [1] &#34;2020-06-23 00:00:00 TSLA -1000 @ 66.7853317260742&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-23 00:00:00 TSLA -1000 @ 100.87133026123&#34;
## [1] &#34;2020-08-17 00:00:00 TSLA 1000 @ 122.375999450684&#34;
## [1] &#34;2020-09-04 00:00:00 TSLA -1000 @ 139.440002441406&#34;
## [1] &#34;2020-10-14 00:00:00 TSLA 1000 @ 153.766662597656&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-06 00:00:00 TSLA 1000 @ 143.316665649414&#34;
## [1] &#34;2020-11-11 00:00:00 TSLA -1000 @ 139.043334960938&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-14 00:00:00 TSLA -1000 @ 213.276672363281&#34;
## [1] &#34;2021-01-05 00:00:00 TSLA 1000 @ 245.036666870117&#34;
## [1] &#34;2021-01-20 00:00:00 TSLA -1000 @ 283.483337402344&#34;
## [1] &#34;2021-03-12 00:00:00 TSLA 1000 @ 231.24333190918&#34;
## [1] &#34;2021-03-29 00:00:00 TSLA -1000 @ 203.763336181641&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-29 00:00:00 TSLA -1000 @ 225.66667175293&#34;
## [1] &#34;2021-05-26 00:00:00 TSLA 1000 @ 206.376663208008&#34;
## [1] &#34;2021-07-09 00:00:00 TSLA -1000 @ 218.983337402344&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-17 00:00:00 TSLA -1000 @ 221.903335571289&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-06 00:00:00 TSLA -1000 @ 260.916656494141&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-10 00:00:00 TSLA -1000 @ 355.983337402344&#34;
## [1] &#34;2021-12-27 00:00:00 TSLA 1000 @ 364.646667480469&#34;
## [1] &#34;2022-01-11 00:00:00 TSLA -1000 @ 354.799987792969&#34;
## [1] &#34;2022-01-13 00:00:00 TSLA 1000 @ 343.853332519531&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-09 00:00:00 TSLA 1000 @ 310.666656494141&#34;
## [1] &#34;2022-02-14 00:00:00 TSLA -1000 @ 291.920013427734&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-23 00:00:00 TSLA -1000 @ 254.679992675781&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-11 00:00:00 TSLA -1000 @ 325.309997558594&#34;
## [1] &#34;2022-05-31 00:00:00 TSLA 1000 @ 252.753326416016&#34;
## [1] &#34;2022-06-15 00:00:00 TSLA -1000 @ 233&#34;
## [1] &#34;2022-06-16 00:00:00 TSLA 1000 @ 213.100006103516&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-10 00:00:00 TSLA -1000 @ 294.356658935547&#34;
## [1] &#34;2022-09-13 00:00:00 TSLA 1000 @ 292.130004882812&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-26 00:00:00 TSLA 1000 @ 224.639999389648&#34;
## [1] &#34;2022-11-08 00:00:00 TSLA -1000 @ 191.300003051758&#34;
## [1] &#34;2022-11-28 00:00:00 TSLA 1000 @ 182.919998168945&#34;
## [1] &#34;2022-12-13 00:00:00 TSLA -1000 @ 160.949996948242&#34;
## [1] &#34;2023-01-10 00:00:00 TSLA 1000 @ 118.849998474121&#34;
## [1] &#34;2023-02-22 00:00:00 TSLA -1000 @ 200.860000610352&#34;
## [1] &#34;2023-03-23 00:00:00 TSLA 1000 @ 192.220001220703&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-08 00:00:00 TSLA 1000 @ 171.789993286133&#34;
## 测试参数组合 6/27: nFast=16, nSlow=26, nSig=7
## 策略环境已重置
## [1] &#34;2018-02-23 00:00:00 TSLA 1000 @ 23.4699993133545&#34;
## [1] &#34;2018-03-06 00:00:00 TSLA -1000 @ 21.8799991607666&#34;
## [1] &#34;2018-03-14 00:00:00 TSLA 1000 @ 21.775333404541&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-09 00:00:00 TSLA 1000 @ 19.3106670379639&#34;
## [1] &#34;2018-05-17 00:00:00 TSLA -1000 @ 18.9693336486816&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-06-26 00:00:00 TSLA -1000 @ 22.7999992370605&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-20 00:00:00 TSLA -1000 @ 20.5626678466797&#34;
## [1] &#34;2018-09-18 00:00:00 TSLA 1000 @ 18.9973335266113&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-24 00:00:00 TSLA 1000 @ 19.2333335876465&#34;
## [1] &#34;2018-11-21 00:00:00 TSLA -1000 @ 22.5459995269775&#34;
## [1] &#34;2018-12-11 00:00:00 TSLA 1000 @ 24.4506664276123&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-10 00:00:00 TSLA 1000 @ 22.9979991912842&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-05 00:00:00 TSLA 1000 @ 21.4233322143555&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-15 00:00:00 TSLA 1000 @ 18.3619995117188&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-29 00:00:00 TSLA 1000 @ 18.6573333740234&#34;
## [1] &#34;2019-04-16 00:00:00 TSLA -1000 @ 18.2240009307861&#34;
## [1] &#34;2019-04-17 00:00:00 TSLA 1000 @ 18.0820007324219&#34;
## [1] &#34;2019-04-23 00:00:00 TSLA -1000 @ 17.5933322906494&#34;
## [1] &#34;2019-05-07 00:00:00 TSLA 1000 @ 16.470666885376&#34;
## [1] &#34;2019-05-13 00:00:00 TSLA -1000 @ 15.1339998245239&#34;
## [1] &#34;2019-06-07 00:00:00 TSLA 1000 @ 13.6333332061768&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-09-03 00:00:00 TSLA 1000 @ 15.0006666183472&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-19 00:00:00 TSLA -1000 @ 23.9680004119873&#34;
## [1] &#34;2019-12-17 00:00:00 TSLA 1000 @ 25.2660007476807&#34;
## [1] &#34;2020-01-30 00:00:00 TSLA -1000 @ 42.7206687927246&#34;
## [1] &#34;2020-01-31 00:00:00 TSLA 1000 @ 43.3713340759277&#34;
## [1] &#34;2020-02-14 00:00:00 TSLA -1000 @ 53.335334777832&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-03-31 00:00:00 TSLA 1000 @ 34.9333343505859&#34;
## [1] &#34;2020-05-08 00:00:00 TSLA -1000 @ 54.6279983520508&#34;
## [1] &#34;2020-05-11 00:00:00 TSLA 1000 @ 54.0859985351562&#34;
## [1] &#34;2020-05-14 00:00:00 TSLA -1000 @ 53.5553321838379&#34;
## [1] &#34;2020-06-03 00:00:00 TSLA 1000 @ 58.8639984130859&#34;
## [1] &#34;2020-06-05 00:00:00 TSLA -1000 @ 59.0439987182617&#34;
## [1] &#34;2020-06-09 00:00:00 TSLA 1000 @ 62.7113342285156&#34;
## [1] &#34;2020-06-23 00:00:00 TSLA -1000 @ 66.7853317260742&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-24 00:00:00 TSLA -1000 @ 94.466667175293&#34;
## [1] &#34;2020-08-18 00:00:00 TSLA 1000 @ 125.805999755859&#34;
## [1] &#34;2020-09-04 00:00:00 TSLA -1000 @ 139.440002441406&#34;
## [1] &#34;2020-10-15 00:00:00 TSLA 1000 @ 149.626663208008&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-09 00:00:00 TSLA 1000 @ 140.419998168945&#34;
## [1] &#34;2020-11-11 00:00:00 TSLA -1000 @ 139.043334960938&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-16 00:00:00 TSLA -1000 @ 207.589996337891&#34;
## [1] &#34;2020-12-21 00:00:00 TSLA 1000 @ 216.619995117188&#34;
## [1] &#34;2020-12-22 00:00:00 TSLA -1000 @ 213.446670532227&#34;
## [1] &#34;2021-01-06 00:00:00 TSLA 1000 @ 251.99333190918&#34;
## [1] &#34;2021-01-21 00:00:00 TSLA -1000 @ 281.663330078125&#34;
## [1] &#34;2021-03-15 00:00:00 TSLA 1000 @ 235.979995727539&#34;
## [1] &#34;2021-03-29 00:00:00 TSLA -1000 @ 203.763336181641&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-29 00:00:00 TSLA -1000 @ 225.66667175293&#34;
## [1] &#34;2021-05-27 00:00:00 TSLA 1000 @ 210.283340454102&#34;
## [1] &#34;2021-07-12 00:00:00 TSLA -1000 @ 228.566665649414&#34;
## [1] &#34;2021-07-13 00:00:00 TSLA 1000 @ 222.846664428711&#34;
## [1] &#34;2021-07-15 00:00:00 TSLA -1000 @ 216.866668701172&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-17 00:00:00 TSLA -1000 @ 221.903335571289&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-07 00:00:00 TSLA -1000 @ 264.536682128906&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-10 00:00:00 TSLA -1000 @ 355.983337402344&#34;
## [1] &#34;2021-12-28 00:00:00 TSLA 1000 @ 362.823333740234&#34;
## [1] &#34;2022-01-12 00:00:00 TSLA -1000 @ 368.739990234375&#34;
## [1] &#34;2022-01-13 00:00:00 TSLA 1000 @ 343.853332519531&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-10 00:00:00 TSLA 1000 @ 301.516662597656&#34;
## [1] &#34;2022-02-14 00:00:00 TSLA -1000 @ 291.920013427734&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-22 00:00:00 TSLA -1000 @ 273.843322753906&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-11 00:00:00 TSLA -1000 @ 325.309997558594&#34;
## [1] &#34;2022-05-31 00:00:00 TSLA 1000 @ 252.753326416016&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-12 00:00:00 TSLA -1000 @ 300.029998779297&#34;
## [1] &#34;2022-08-16 00:00:00 TSLA 1000 @ 306.563323974609&#34;
## [1] &#34;2022-08-18 00:00:00 TSLA -1000 @ 302.869995117188&#34;
## [1] &#34;2022-09-13 00:00:00 TSLA 1000 @ 292.130004882812&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-26 00:00:00 TSLA 1000 @ 224.639999389648&#34;
## [1] &#34;2022-11-08 00:00:00 TSLA -1000 @ 191.300003051758&#34;
## [1] &#34;2022-11-29 00:00:00 TSLA 1000 @ 180.830001831055&#34;
## [1] &#34;2022-12-14 00:00:00 TSLA -1000 @ 156.800003051758&#34;
## [1] &#34;2023-01-11 00:00:00 TSLA 1000 @ 123.220001220703&#34;
## [1] &#34;2023-02-22 00:00:00 TSLA -1000 @ 200.860000610352&#34;
## [1] &#34;2023-03-27 00:00:00 TSLA 1000 @ 191.809997558594&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-09 00:00:00 TSLA 1000 @ 169.149993896484&#34;
## 测试参数组合 7/27: nFast=8, nSlow=30, nSig=7
## 策略环境已重置
## [1] &#34;2018-03-13 00:00:00 TSLA 1000 @ 22.7893333435059&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-06 00:00:00 TSLA 1000 @ 19.953332901001&#34;
## [1] &#34;2018-04-25 00:00:00 TSLA -1000 @ 18.71266746521&#34;
## [1] &#34;2018-04-30 00:00:00 TSLA 1000 @ 19.5933322906494&#34;
## [1] &#34;2018-05-16 00:00:00 TSLA -1000 @ 19.0986671447754&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-06-25 00:00:00 TSLA -1000 @ 22.2006664276123&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-16 00:00:00 TSLA -1000 @ 22.3633327484131&#34;
## [1] &#34;2018-09-17 00:00:00 TSLA 1000 @ 19.6560001373291&#34;
## [1] &#34;2018-10-01 00:00:00 TSLA -1000 @ 20.7133331298828&#34;
## [1] &#34;2018-10-02 00:00:00 TSLA 1000 @ 20.068000793457&#34;
## [1] &#34;2018-10-05 00:00:00 TSLA -1000 @ 17.4633331298828&#34;
## [1] &#34;2018-10-17 00:00:00 TSLA 1000 @ 18.1186676025391&#34;
## [1] &#34;2018-11-13 00:00:00 TSLA -1000 @ 22.5820007324219&#34;
## [1] &#34;2018-12-06 00:00:00 TSLA 1000 @ 24.2040004730225&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-08 00:00:00 TSLA 1000 @ 22.3566665649414&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-04 00:00:00 TSLA 1000 @ 20.8593330383301&#34;
## [1] &#34;2019-02-21 00:00:00 TSLA -1000 @ 19.4153327941895&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-14 00:00:00 TSLA 1000 @ 19.3306674957275&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-28 00:00:00 TSLA 1000 @ 18.5746669769287&#34;
## [1] &#34;2019-04-12 00:00:00 TSLA -1000 @ 17.8466663360596&#34;
## [1] &#34;2019-04-18 00:00:00 TSLA 1000 @ 18.2173328399658&#34;
## [1] &#34;2019-04-23 00:00:00 TSLA -1000 @ 17.5933322906494&#34;
## [1] &#34;2019-05-07 00:00:00 TSLA 1000 @ 16.470666885376&#34;
## [1] &#34;2019-05-14 00:00:00 TSLA -1000 @ 15.4873332977295&#34;
## [1] &#34;2019-06-06 00:00:00 TSLA 1000 @ 13.7299995422363&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-09-03 00:00:00 TSLA 1000 @ 15.0006666183472&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-10 00:00:00 TSLA 1000 @ 16.3159999847412&#34;
## [1] &#34;2019-11-18 00:00:00 TSLA -1000 @ 23.3326663970947&#34;
## [1] &#34;2019-12-13 00:00:00 TSLA 1000 @ 23.8926677703857&#34;
## [1] &#34;2020-01-21 00:00:00 TSLA -1000 @ 36.4799995422363&#34;
## [1] &#34;2020-01-22 00:00:00 TSLA 1000 @ 37.9706687927246&#34;
## [1] &#34;2020-01-28 00:00:00 TSLA -1000 @ 37.7933311462402&#34;
## [1] &#34;2020-01-31 00:00:00 TSLA 1000 @ 43.3713340759277&#34;
## [1] &#34;2020-02-12 00:00:00 TSLA -1000 @ 51.1526679992676&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-03-26 00:00:00 TSLA 1000 @ 35.2106666564941&#34;
## [1] &#34;2020-05-04 00:00:00 TSLA -1000 @ 50.7459983825684&#34;
## [1] &#34;2020-06-02 00:00:00 TSLA 1000 @ 58.7706680297852&#34;
## [1] &#34;2020-06-22 00:00:00 TSLA -1000 @ 66.2880020141602&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-22 00:00:00 TSLA -1000 @ 106.155334472656&#34;
## [1] &#34;2020-08-17 00:00:00 TSLA 1000 @ 122.375999450684&#34;
## [1] &#34;2020-09-04 00:00:00 TSLA -1000 @ 139.440002441406&#34;
## [1] &#34;2020-09-21 00:00:00 TSLA 1000 @ 149.796661376953&#34;
## [1] &#34;2020-09-23 00:00:00 TSLA -1000 @ 126.786666870117&#34;
## [1] &#34;2020-10-02 00:00:00 TSLA 1000 @ 138.363327026367&#34;
## [1] &#34;2020-10-05 00:00:00 TSLA -1000 @ 141.893325805664&#34;
## [1] &#34;2020-10-13 00:00:00 TSLA 1000 @ 148.883331298828&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-06 00:00:00 TSLA 1000 @ 143.316665649414&#34;
## [1] &#34;2020-11-11 00:00:00 TSLA -1000 @ 139.043334960938&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-14 00:00:00 TSLA -1000 @ 213.276672363281&#34;
## [1] &#34;2020-12-21 00:00:00 TSLA 1000 @ 216.619995117188&#34;
## [1] &#34;2020-12-22 00:00:00 TSLA -1000 @ 213.446670532227&#34;
## [1] &#34;2021-01-05 00:00:00 TSLA 1000 @ 245.036666870117&#34;
## [1] &#34;2021-01-19 00:00:00 TSLA -1000 @ 281.516662597656&#34;
## [1] &#34;2021-03-12 00:00:00 TSLA 1000 @ 231.24333190918&#34;
## [1] &#34;2021-03-25 00:00:00 TSLA -1000 @ 213.463333129883&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-28 00:00:00 TSLA -1000 @ 231.466659545898&#34;
## [1] &#34;2021-05-25 00:00:00 TSLA 1000 @ 201.563339233398&#34;
## [1] &#34;2021-07-08 00:00:00 TSLA -1000 @ 217.603332519531&#34;
## [1] &#34;2021-07-30 00:00:00 TSLA 1000 @ 229.066665649414&#34;
## [1] &#34;2021-08-17 00:00:00 TSLA -1000 @ 221.903335571289&#34;
## [1] &#34;2021-08-26 00:00:00 TSLA 1000 @ 233.720001220703&#34;
## [1] &#34;2021-08-27 00:00:00 TSLA -1000 @ 237.306671142578&#34;
## [1] &#34;2021-08-30 00:00:00 TSLA 1000 @ 243.636672973633&#34;
## [1] &#34;2021-09-15 00:00:00 TSLA -1000 @ 251.943328857422&#34;
## [1] &#34;2021-09-16 00:00:00 TSLA 1000 @ 252.330001831055&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-27 00:00:00 TSLA 1000 @ 263.786682128906&#34;
## [1] &#34;2021-10-06 00:00:00 TSLA -1000 @ 260.916656494141&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-10 00:00:00 TSLA -1000 @ 355.983337402344&#34;
## [1] &#34;2021-12-27 00:00:00 TSLA 1000 @ 364.646667480469&#34;
## [1] &#34;2022-01-10 00:00:00 TSLA -1000 @ 352.706665039062&#34;
## [1] &#34;2022-02-07 00:00:00 TSLA 1000 @ 302.446655273438&#34;
## [1] &#34;2022-02-15 00:00:00 TSLA -1000 @ 307.476654052734&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-22 00:00:00 TSLA -1000 @ 273.843322753906&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-08 00:00:00 TSLA -1000 @ 341.829986572266&#34;
## [1] &#34;2022-05-31 00:00:00 TSLA 1000 @ 252.753326416016&#34;
## [1] &#34;2022-06-14 00:00:00 TSLA -1000 @ 220.889999389648&#34;
## [1] &#34;2022-06-16 00:00:00 TSLA 1000 @ 213.100006103516&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-10 00:00:00 TSLA -1000 @ 294.356658935547&#34;
## [1] &#34;2022-09-12 00:00:00 TSLA 1000 @ 304.420013427734&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-25 00:00:00 TSLA 1000 @ 222.419998168945&#34;
## [1] &#34;2022-11-08 00:00:00 TSLA -1000 @ 191.300003051758&#34;
## [1] &#34;2022-11-28 00:00:00 TSLA 1000 @ 182.919998168945&#34;
## [1] &#34;2022-12-09 00:00:00 TSLA -1000 @ 179.050003051758&#34;
## [1] &#34;2022-12-12 00:00:00 TSLA 1000 @ 167.820007324219&#34;
## [1] &#34;2022-12-13 00:00:00 TSLA -1000 @ 160.949996948242&#34;
## [1] &#34;2023-01-10 00:00:00 TSLA 1000 @ 118.849998474121&#34;
## [1] &#34;2023-02-17 00:00:00 TSLA -1000 @ 208.309997558594&#34;
## [1] &#34;2023-03-22 00:00:00 TSLA 1000 @ 191.149993896484&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-08 00:00:00 TSLA 1000 @ 171.789993286133&#34;
## 测试参数组合 8/27: nFast=12, nSlow=30, nSig=7
## 策略环境已重置
## [1] &#34;2018-03-14 00:00:00 TSLA 1000 @ 21.775333404541&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-09 00:00:00 TSLA 1000 @ 19.3106670379639&#34;
## [1] &#34;2018-04-26 00:00:00 TSLA -1000 @ 19.0319995880127&#34;
## [1] &#34;2018-04-27 00:00:00 TSLA 1000 @ 19.6053333282471&#34;
## [1] &#34;2018-05-16 00:00:00 TSLA -1000 @ 19.0986671447754&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-06-26 00:00:00 TSLA -1000 @ 22.7999992370605&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-17 00:00:00 TSLA -1000 @ 20.3666667938232&#34;
## [1] &#34;2018-09-17 00:00:00 TSLA 1000 @ 19.6560001373291&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-18 00:00:00 TSLA 1000 @ 17.5939998626709&#34;
## [1] &#34;2018-11-15 00:00:00 TSLA -1000 @ 23.2293338775635&#34;
## [1] &#34;2018-12-07 00:00:00 TSLA 1000 @ 23.8646678924561&#34;
## [1] &#34;2018-12-10 00:00:00 TSLA -1000 @ 24.3433322906494&#34;
## [1] &#34;2018-12-11 00:00:00 TSLA 1000 @ 24.4506664276123&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-09 00:00:00 TSLA 1000 @ 22.5686664581299&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-05 00:00:00 TSLA 1000 @ 21.4233322143555&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-15 00:00:00 TSLA 1000 @ 18.3619995117188&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-29 00:00:00 TSLA 1000 @ 18.6573333740234&#34;
## [1] &#34;2019-04-15 00:00:00 TSLA -1000 @ 17.7586669921875&#34;
## [1] &#34;2019-04-17 00:00:00 TSLA 1000 @ 18.0820007324219&#34;
## [1] &#34;2019-04-23 00:00:00 TSLA -1000 @ 17.5933322906494&#34;
## [1] &#34;2019-05-07 00:00:00 TSLA 1000 @ 16.470666885376&#34;
## [1] &#34;2019-05-13 00:00:00 TSLA -1000 @ 15.1339998245239&#34;
## [1] &#34;2019-06-06 00:00:00 TSLA 1000 @ 13.7299995422363&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-09-03 00:00:00 TSLA 1000 @ 15.0006666183472&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-19 00:00:00 TSLA -1000 @ 23.9680004119873&#34;
## [1] &#34;2019-12-16 00:00:00 TSLA 1000 @ 25.4333324432373&#34;
## [1] &#34;2020-01-29 00:00:00 TSLA -1000 @ 38.732666015625&#34;
## [1] &#34;2020-01-31 00:00:00 TSLA 1000 @ 43.3713340759277&#34;
## [1] &#34;2020-02-13 00:00:00 TSLA -1000 @ 53.5999984741211&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-03-30 00:00:00 TSLA 1000 @ 33.4753341674805&#34;
## [1] &#34;2020-05-05 00:00:00 TSLA -1000 @ 51.2140007019043&#34;
## [1] &#34;2020-05-11 00:00:00 TSLA 1000 @ 54.0859985351562&#34;
## [1] &#34;2020-05-13 00:00:00 TSLA -1000 @ 52.7306671142578&#34;
## [1] &#34;2020-06-03 00:00:00 TSLA 1000 @ 58.8639984130859&#34;
## [1] &#34;2020-06-23 00:00:00 TSLA -1000 @ 66.7853317260742&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-23 00:00:00 TSLA -1000 @ 100.87133026123&#34;
## [1] &#34;2020-08-18 00:00:00 TSLA 1000 @ 125.805999755859&#34;
## [1] &#34;2020-09-04 00:00:00 TSLA -1000 @ 139.440002441406&#34;
## [1] &#34;2020-10-14 00:00:00 TSLA 1000 @ 153.766662597656&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-06 00:00:00 TSLA 1000 @ 143.316665649414&#34;
## [1] &#34;2020-11-11 00:00:00 TSLA -1000 @ 139.043334960938&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-16 00:00:00 TSLA -1000 @ 207.589996337891&#34;
## [1] &#34;2020-12-21 00:00:00 TSLA 1000 @ 216.619995117188&#34;
## [1] &#34;2020-12-22 00:00:00 TSLA -1000 @ 213.446670532227&#34;
## [1] &#34;2021-01-05 00:00:00 TSLA 1000 @ 245.036666870117&#34;
## [1] &#34;2021-01-20 00:00:00 TSLA -1000 @ 283.483337402344&#34;
## [1] &#34;2021-03-15 00:00:00 TSLA 1000 @ 235.979995727539&#34;
## [1] &#34;2021-03-26 00:00:00 TSLA -1000 @ 206.236663818359&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-29 00:00:00 TSLA -1000 @ 225.66667175293&#34;
## [1] &#34;2021-05-26 00:00:00 TSLA 1000 @ 206.376663208008&#34;
## [1] &#34;2021-07-09 00:00:00 TSLA -1000 @ 218.983337402344&#34;
## [1] &#34;2021-07-13 00:00:00 TSLA 1000 @ 222.846664428711&#34;
## [1] &#34;2021-07-15 00:00:00 TSLA -1000 @ 216.866668701172&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-17 00:00:00 TSLA -1000 @ 221.903335571289&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-06 00:00:00 TSLA -1000 @ 260.916656494141&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-10 00:00:00 TSLA -1000 @ 355.983337402344&#34;
## [1] &#34;2021-12-27 00:00:00 TSLA 1000 @ 364.646667480469&#34;
## [1] &#34;2022-01-11 00:00:00 TSLA -1000 @ 354.799987792969&#34;
## [1] &#34;2022-01-13 00:00:00 TSLA 1000 @ 343.853332519531&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-09 00:00:00 TSLA 1000 @ 310.666656494141&#34;
## [1] &#34;2022-02-14 00:00:00 TSLA -1000 @ 291.920013427734&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-22 00:00:00 TSLA -1000 @ 273.843322753906&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-11 00:00:00 TSLA -1000 @ 325.309997558594&#34;
## [1] &#34;2022-05-31 00:00:00 TSLA 1000 @ 252.753326416016&#34;
## [1] &#34;2022-06-15 00:00:00 TSLA -1000 @ 233&#34;
## [1] &#34;2022-06-16 00:00:00 TSLA 1000 @ 213.100006103516&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-11 00:00:00 TSLA -1000 @ 286.630004882812&#34;
## [1] &#34;2022-08-16 00:00:00 TSLA 1000 @ 306.563323974609&#34;
## [1] &#34;2022-08-18 00:00:00 TSLA -1000 @ 302.869995117188&#34;
## [1] &#34;2022-09-13 00:00:00 TSLA 1000 @ 292.130004882812&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-26 00:00:00 TSLA 1000 @ 224.639999389648&#34;
## [1] &#34;2022-11-08 00:00:00 TSLA -1000 @ 191.300003051758&#34;
## [1] &#34;2022-11-28 00:00:00 TSLA 1000 @ 182.919998168945&#34;
## [1] &#34;2022-12-13 00:00:00 TSLA -1000 @ 160.949996948242&#34;
## [1] &#34;2023-01-11 00:00:00 TSLA 1000 @ 123.220001220703&#34;
## [1] &#34;2023-02-22 00:00:00 TSLA -1000 @ 200.860000610352&#34;
## [1] &#34;2023-03-23 00:00:00 TSLA 1000 @ 192.220001220703&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-08 00:00:00 TSLA 1000 @ 171.789993286133&#34;
## 测试参数组合 9/27: nFast=16, nSlow=30, nSig=7
## 策略环境已重置
## [1] &#34;2018-03-13 00:00:00 TSLA 1000 @ 22.7893333435059&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-09 00:00:00 TSLA 1000 @ 19.3106670379639&#34;
## [1] &#34;2018-05-17 00:00:00 TSLA -1000 @ 18.9693336486816&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-06-27 00:00:00 TSLA -1000 @ 22.966667175293&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-20 00:00:00 TSLA -1000 @ 20.5626678466797&#34;
## [1] &#34;2018-09-18 00:00:00 TSLA 1000 @ 18.9973335266113&#34;
## [1] &#34;2018-09-19 00:00:00 TSLA -1000 @ 19.9346675872803&#34;
## [1] &#34;2018-09-20 00:00:00 TSLA 1000 @ 19.8886661529541&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-24 00:00:00 TSLA 1000 @ 19.2333335876465&#34;
## [1] &#34;2018-11-23 00:00:00 TSLA -1000 @ 21.7220001220703&#34;
## [1] &#34;2018-12-11 00:00:00 TSLA 1000 @ 24.4506664276123&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-10 00:00:00 TSLA 1000 @ 22.9979991912842&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-05 00:00:00 TSLA 1000 @ 21.4233322143555&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-15 00:00:00 TSLA 1000 @ 18.3619995117188&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-29 00:00:00 TSLA 1000 @ 18.6573333740234&#34;
## [1] &#34;2019-04-16 00:00:00 TSLA -1000 @ 18.2240009307861&#34;
## [1] &#34;2019-04-17 00:00:00 TSLA 1000 @ 18.0820007324219&#34;
## [1] &#34;2019-04-24 00:00:00 TSLA -1000 @ 17.2439994812012&#34;
## [1] &#34;2019-05-08 00:00:00 TSLA 1000 @ 16.3226661682129&#34;
## [1] &#34;2019-05-10 00:00:00 TSLA -1000 @ 15.9680004119873&#34;
## [1] &#34;2019-06-07 00:00:00 TSLA 1000 @ 13.6333332061768&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-09-04 00:00:00 TSLA 1000 @ 14.7119998931885&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-01 00:00:00 TSLA 1000 @ 16.3126678466797&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-21 00:00:00 TSLA -1000 @ 23.6553325653076&#34;
## [1] &#34;2019-12-17 00:00:00 TSLA 1000 @ 25.2660007476807&#34;
## [1] &#34;2020-02-18 00:00:00 TSLA -1000 @ 57.2266654968262&#34;
## [1] &#34;2020-02-19 00:00:00 TSLA 1000 @ 61.1613311767578&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-04-01 00:00:00 TSLA 1000 @ 32.1040000915527&#34;
## [1] &#34;2020-04-03 00:00:00 TSLA -1000 @ 32.0006675720215&#34;
## [1] &#34;2020-04-07 00:00:00 TSLA 1000 @ 36.3633346557617&#34;
## [1] &#34;2020-05-14 00:00:00 TSLA -1000 @ 53.5553321838379&#34;
## [1] &#34;2020-06-03 00:00:00 TSLA 1000 @ 58.8639984130859&#34;
## [1] &#34;2020-06-05 00:00:00 TSLA -1000 @ 59.0439987182617&#34;
## [1] &#34;2020-06-09 00:00:00 TSLA 1000 @ 62.7113342285156&#34;
## [1] &#34;2020-06-23 00:00:00 TSLA -1000 @ 66.7853317260742&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-24 00:00:00 TSLA -1000 @ 94.466667175293&#34;
## [1] &#34;2020-08-18 00:00:00 TSLA 1000 @ 125.805999755859&#34;
## [1] &#34;2020-09-04 00:00:00 TSLA -1000 @ 139.440002441406&#34;
## [1] &#34;2020-10-15 00:00:00 TSLA 1000 @ 149.626663208008&#34;
## [1] &#34;2020-10-19 00:00:00 TSLA -1000 @ 143.610000610352&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-17 00:00:00 TSLA -1000 @ 218.633331298828&#34;
## [1] &#34;2020-12-21 00:00:00 TSLA 1000 @ 216.619995117188&#34;
## [1] &#34;2020-12-22 00:00:00 TSLA -1000 @ 213.446670532227&#34;
## [1] &#34;2021-01-06 00:00:00 TSLA 1000 @ 251.99333190918&#34;
## [1] &#34;2021-01-21 00:00:00 TSLA -1000 @ 281.663330078125&#34;
## [1] &#34;2021-03-16 00:00:00 TSLA 1000 @ 225.626663208008&#34;
## [1] &#34;2021-03-25 00:00:00 TSLA -1000 @ 213.463333129883&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-29 00:00:00 TSLA -1000 @ 225.66667175293&#34;
## [1] &#34;2021-05-27 00:00:00 TSLA 1000 @ 210.283340454102&#34;
## [1] &#34;2021-07-15 00:00:00 TSLA -1000 @ 216.866668701172&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-18 00:00:00 TSLA -1000 @ 229.663330078125&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-07 00:00:00 TSLA -1000 @ 264.536682128906&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-10 00:00:00 TSLA -1000 @ 355.983337402344&#34;
## [1] &#34;2021-12-28 00:00:00 TSLA 1000 @ 362.823333740234&#34;
## [1] &#34;2022-01-12 00:00:00 TSLA -1000 @ 368.739990234375&#34;
## [1] &#34;2022-01-13 00:00:00 TSLA 1000 @ 343.853332519531&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-10 00:00:00 TSLA 1000 @ 301.516662597656&#34;
## [1] &#34;2022-02-14 00:00:00 TSLA -1000 @ 291.920013427734&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-22 00:00:00 TSLA -1000 @ 273.843322753906&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-12 00:00:00 TSLA -1000 @ 328.983337402344&#34;
## [1] &#34;2022-06-01 00:00:00 TSLA 1000 @ 246.789993286133&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-12 00:00:00 TSLA -1000 @ 300.029998779297&#34;
## [1] &#34;2022-08-15 00:00:00 TSLA 1000 @ 309.320007324219&#34;
## [1] &#34;2022-08-19 00:00:00 TSLA -1000 @ 296.666656494141&#34;
## [1] &#34;2022-09-13 00:00:00 TSLA 1000 @ 292.130004882812&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-27 00:00:00 TSLA 1000 @ 225.089996337891&#34;
## [1] &#34;2022-11-08 00:00:00 TSLA -1000 @ 191.300003051758&#34;
## [1] &#34;2022-11-29 00:00:00 TSLA 1000 @ 180.830001831055&#34;
## [1] &#34;2022-12-14 00:00:00 TSLA -1000 @ 156.800003051758&#34;
## [1] &#34;2023-01-12 00:00:00 TSLA 1000 @ 123.559997558594&#34;
## [1] &#34;2023-02-23 00:00:00 TSLA -1000 @ 202.070007324219&#34;
## [1] &#34;2023-03-30 00:00:00 TSLA 1000 @ 195.279998779297&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-09 00:00:00 TSLA 1000 @ 169.149993896484&#34;
## 测试参数组合 10/27: nFast=8, nSlow=22, nSig=9
## 策略环境已重置
## [1] &#34;2018-02-22 00:00:00 TSLA 1000 @ 23.0779991149902&#34;
## [1] &#34;2018-03-05 00:00:00 TSLA -1000 @ 22.2233333587646&#34;
## [1] &#34;2018-03-14 00:00:00 TSLA 1000 @ 21.775333404541&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-06 00:00:00 TSLA 1000 @ 19.953332901001&#34;
## [1] &#34;2018-04-26 00:00:00 TSLA -1000 @ 19.0319995880127&#34;
## [1] &#34;2018-04-30 00:00:00 TSLA 1000 @ 19.5933322906494&#34;
## [1] &#34;2018-05-16 00:00:00 TSLA -1000 @ 19.0986671447754&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-06-25 00:00:00 TSLA -1000 @ 22.2006664276123&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-17 00:00:00 TSLA -1000 @ 20.3666667938232&#34;
## [1] &#34;2018-09-17 00:00:00 TSLA 1000 @ 19.6560001373291&#34;
## [1] &#34;2018-10-01 00:00:00 TSLA -1000 @ 20.7133331298828&#34;
## [1] &#34;2018-10-02 00:00:00 TSLA 1000 @ 20.068000793457&#34;
## [1] &#34;2018-10-05 00:00:00 TSLA -1000 @ 17.4633331298828&#34;
## [1] &#34;2018-10-18 00:00:00 TSLA 1000 @ 17.5939998626709&#34;
## [1] &#34;2018-11-13 00:00:00 TSLA -1000 @ 22.5820007324219&#34;
## [1] &#34;2018-12-07 00:00:00 TSLA 1000 @ 23.8646678924561&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-08 00:00:00 TSLA 1000 @ 22.3566665649414&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-04 00:00:00 TSLA 1000 @ 20.8593330383301&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-14 00:00:00 TSLA 1000 @ 19.3306674957275&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-28 00:00:00 TSLA 1000 @ 18.5746669769287&#34;
## [1] &#34;2019-04-12 00:00:00 TSLA -1000 @ 17.8466663360596&#34;
## [1] &#34;2019-04-18 00:00:00 TSLA 1000 @ 18.2173328399658&#34;
## [1] &#34;2019-04-23 00:00:00 TSLA -1000 @ 17.5933322906494&#34;
## [1] &#34;2019-05-07 00:00:00 TSLA 1000 @ 16.470666885376&#34;
## [1] &#34;2019-05-14 00:00:00 TSLA -1000 @ 15.4873332977295&#34;
## [1] &#34;2019-06-06 00:00:00 TSLA 1000 @ 13.7299995422363&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-09-03 00:00:00 TSLA 1000 @ 15.0006666183472&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-15 00:00:00 TSLA -1000 @ 23.4780006408691&#34;
## [1] &#34;2019-12-13 00:00:00 TSLA 1000 @ 23.8926677703857&#34;
## [1] &#34;2020-01-21 00:00:00 TSLA -1000 @ 36.4799995422363&#34;
## [1] &#34;2020-01-22 00:00:00 TSLA 1000 @ 37.9706687927246&#34;
## [1] &#34;2020-01-28 00:00:00 TSLA -1000 @ 37.7933311462402&#34;
## [1] &#34;2020-01-31 00:00:00 TSLA 1000 @ 43.3713340759277&#34;
## [1] &#34;2020-02-12 00:00:00 TSLA -1000 @ 51.1526679992676&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-24 00:00:00 TSLA -1000 @ 55.5859985351562&#34;
## [1] &#34;2020-03-26 00:00:00 TSLA 1000 @ 35.2106666564941&#34;
## [1] &#34;2020-05-04 00:00:00 TSLA -1000 @ 50.7459983825684&#34;
## [1] &#34;2020-06-02 00:00:00 TSLA 1000 @ 58.7706680297852&#34;
## [1] &#34;2020-06-22 00:00:00 TSLA -1000 @ 66.2880020141602&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-22 00:00:00 TSLA -1000 @ 106.155334472656&#34;
## [1] &#34;2020-08-17 00:00:00 TSLA 1000 @ 122.375999450684&#34;
## [1] &#34;2020-09-04 00:00:00 TSLA -1000 @ 139.440002441406&#34;
## [1] &#34;2020-09-22 00:00:00 TSLA 1000 @ 141.410003662109&#34;
## [1] &#34;2020-09-23 00:00:00 TSLA -1000 @ 126.786666870117&#34;
## [1] &#34;2020-10-02 00:00:00 TSLA 1000 @ 138.363327026367&#34;
## [1] &#34;2020-10-05 00:00:00 TSLA -1000 @ 141.893325805664&#34;
## [1] &#34;2020-10-13 00:00:00 TSLA 1000 @ 148.883331298828&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-06 00:00:00 TSLA 1000 @ 143.316665649414&#34;
## [1] &#34;2020-11-13 00:00:00 TSLA -1000 @ 136.16667175293&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-14 00:00:00 TSLA -1000 @ 213.276672363281&#34;
## [1] &#34;2021-01-05 00:00:00 TSLA 1000 @ 245.036666870117&#34;
## [1] &#34;2021-01-20 00:00:00 TSLA -1000 @ 283.483337402344&#34;
## [1] &#34;2021-03-12 00:00:00 TSLA 1000 @ 231.24333190918&#34;
## [1] &#34;2021-03-29 00:00:00 TSLA -1000 @ 203.763336181641&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-28 00:00:00 TSLA -1000 @ 231.466659545898&#34;
## [1] &#34;2021-05-25 00:00:00 TSLA 1000 @ 201.563339233398&#34;
## [1] &#34;2021-07-08 00:00:00 TSLA -1000 @ 217.603332519531&#34;
## [1] &#34;2021-07-30 00:00:00 TSLA 1000 @ 229.066665649414&#34;
## [1] &#34;2021-08-17 00:00:00 TSLA -1000 @ 221.903335571289&#34;
## [1] &#34;2021-08-30 00:00:00 TSLA 1000 @ 243.636672973633&#34;
## [1] &#34;2021-09-15 00:00:00 TSLA -1000 @ 251.943328857422&#34;
## [1] &#34;2021-09-17 00:00:00 TSLA 1000 @ 253.163330078125&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-06 00:00:00 TSLA -1000 @ 260.916656494141&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-10 00:00:00 TSLA -1000 @ 355.983337402344&#34;
## [1] &#34;2021-12-27 00:00:00 TSLA 1000 @ 364.646667480469&#34;
## [1] &#34;2022-01-10 00:00:00 TSLA -1000 @ 352.706665039062&#34;
## [1] &#34;2022-02-07 00:00:00 TSLA 1000 @ 302.446655273438&#34;
## [1] &#34;2022-02-23 00:00:00 TSLA -1000 @ 254.679992675781&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-08 00:00:00 TSLA -1000 @ 341.829986572266&#34;
## [1] &#34;2022-05-31 00:00:00 TSLA 1000 @ 252.753326416016&#34;
## [1] &#34;2022-06-15 00:00:00 TSLA -1000 @ 233&#34;
## [1] &#34;2022-06-16 00:00:00 TSLA 1000 @ 213.100006103516&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-10 00:00:00 TSLA -1000 @ 294.356658935547&#34;
## [1] &#34;2022-09-12 00:00:00 TSLA 1000 @ 304.420013427734&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-24 00:00:00 TSLA 1000 @ 211.25&#34;
## [1] &#34;2022-11-08 00:00:00 TSLA -1000 @ 191.300003051758&#34;
## [1] &#34;2022-11-28 00:00:00 TSLA 1000 @ 182.919998168945&#34;
## [1] &#34;2022-12-13 00:00:00 TSLA -1000 @ 160.949996948242&#34;
## [1] &#34;2023-01-10 00:00:00 TSLA 1000 @ 118.849998474121&#34;
## [1] &#34;2023-02-17 00:00:00 TSLA -1000 @ 208.309997558594&#34;
## [1] &#34;2023-03-22 00:00:00 TSLA 1000 @ 191.149993896484&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-08 00:00:00 TSLA 1000 @ 171.789993286133&#34;
## 测试参数组合 11/27: nFast=12, nSlow=22, nSig=9
## 策略环境已重置
## [1] &#34;2018-02-23 00:00:00 TSLA 1000 @ 23.4699993133545&#34;
## [1] &#34;2018-03-05 00:00:00 TSLA -1000 @ 22.2233333587646&#34;
## [1] &#34;2018-03-14 00:00:00 TSLA 1000 @ 21.775333404541&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-09 00:00:00 TSLA 1000 @ 19.3106670379639&#34;
## [1] &#34;2018-05-16 00:00:00 TSLA -1000 @ 19.0986671447754&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-06-26 00:00:00 TSLA -1000 @ 22.7999992370605&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-20 00:00:00 TSLA -1000 @ 20.5626678466797&#34;
## [1] &#34;2018-09-17 00:00:00 TSLA 1000 @ 19.6560001373291&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-18 00:00:00 TSLA 1000 @ 17.5939998626709&#34;
## [1] &#34;2018-11-15 00:00:00 TSLA -1000 @ 23.2293338775635&#34;
## [1] &#34;2018-12-12 00:00:00 TSLA 1000 @ 24.4400005340576&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-09 00:00:00 TSLA 1000 @ 22.5686664581299&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-05 00:00:00 TSLA 1000 @ 21.4233322143555&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-15 00:00:00 TSLA 1000 @ 18.3619995117188&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-29 00:00:00 TSLA 1000 @ 18.6573333740234&#34;
## [1] &#34;2019-04-15 00:00:00 TSLA -1000 @ 17.7586669921875&#34;
## [1] &#34;2019-04-17 00:00:00 TSLA 1000 @ 18.0820007324219&#34;
## [1] &#34;2019-04-23 00:00:00 TSLA -1000 @ 17.5933322906494&#34;
## [1] &#34;2019-05-07 00:00:00 TSLA 1000 @ 16.470666885376&#34;
## [1] &#34;2019-05-14 00:00:00 TSLA -1000 @ 15.4873332977295&#34;
## [1] &#34;2019-06-06 00:00:00 TSLA 1000 @ 13.7299995422363&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-09-03 00:00:00 TSLA 1000 @ 15.0006666183472&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-19 00:00:00 TSLA -1000 @ 23.9680004119873&#34;
## [1] &#34;2019-12-16 00:00:00 TSLA 1000 @ 25.4333324432373&#34;
## [1] &#34;2020-01-29 00:00:00 TSLA -1000 @ 38.732666015625&#34;
## [1] &#34;2020-01-31 00:00:00 TSLA 1000 @ 43.3713340759277&#34;
## [1] &#34;2020-02-13 00:00:00 TSLA -1000 @ 53.5999984741211&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-03-30 00:00:00 TSLA 1000 @ 33.4753341674805&#34;
## [1] &#34;2020-05-05 00:00:00 TSLA -1000 @ 51.2140007019043&#34;
## [1] &#34;2020-06-03 00:00:00 TSLA 1000 @ 58.8639984130859&#34;
## [1] &#34;2020-06-05 00:00:00 TSLA -1000 @ 59.0439987182617&#34;
## [1] &#34;2020-06-09 00:00:00 TSLA 1000 @ 62.7113342285156&#34;
## [1] &#34;2020-06-23 00:00:00 TSLA -1000 @ 66.7853317260742&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-23 00:00:00 TSLA -1000 @ 100.87133026123&#34;
## [1] &#34;2020-08-18 00:00:00 TSLA 1000 @ 125.805999755859&#34;
## [1] &#34;2020-09-04 00:00:00 TSLA -1000 @ 139.440002441406&#34;
## [1] &#34;2020-10-14 00:00:00 TSLA 1000 @ 153.766662597656&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-06 00:00:00 TSLA 1000 @ 143.316665649414&#34;
## [1] &#34;2020-11-11 00:00:00 TSLA -1000 @ 139.043334960938&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-15 00:00:00 TSLA -1000 @ 211.08332824707&#34;
## [1] &#34;2021-01-06 00:00:00 TSLA 1000 @ 251.99333190918&#34;
## [1] &#34;2021-01-20 00:00:00 TSLA -1000 @ 283.483337402344&#34;
## [1] &#34;2021-03-15 00:00:00 TSLA 1000 @ 235.979995727539&#34;
## [1] &#34;2021-03-29 00:00:00 TSLA -1000 @ 203.763336181641&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-29 00:00:00 TSLA -1000 @ 225.66667175293&#34;
## [1] &#34;2021-05-26 00:00:00 TSLA 1000 @ 206.376663208008&#34;
## [1] &#34;2021-07-09 00:00:00 TSLA -1000 @ 218.983337402344&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-17 00:00:00 TSLA -1000 @ 221.903335571289&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-06 00:00:00 TSLA -1000 @ 260.916656494141&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-10 00:00:00 TSLA -1000 @ 355.983337402344&#34;
## [1] &#34;2021-12-27 00:00:00 TSLA 1000 @ 364.646667480469&#34;
## [1] &#34;2022-01-12 00:00:00 TSLA -1000 @ 368.739990234375&#34;
## [1] &#34;2022-01-13 00:00:00 TSLA 1000 @ 343.853332519531&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-09 00:00:00 TSLA 1000 @ 310.666656494141&#34;
## [1] &#34;2022-02-15 00:00:00 TSLA -1000 @ 307.476654052734&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-23 00:00:00 TSLA -1000 @ 254.679992675781&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-11 00:00:00 TSLA -1000 @ 325.309997558594&#34;
## [1] &#34;2022-05-31 00:00:00 TSLA 1000 @ 252.753326416016&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-10 00:00:00 TSLA -1000 @ 294.356658935547&#34;
## [1] &#34;2022-09-13 00:00:00 TSLA 1000 @ 292.130004882812&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-26 00:00:00 TSLA 1000 @ 224.639999389648&#34;
## [1] &#34;2022-11-09 00:00:00 TSLA -1000 @ 177.589996337891&#34;
## [1] &#34;2022-11-28 00:00:00 TSLA 1000 @ 182.919998168945&#34;
## [1] &#34;2022-12-14 00:00:00 TSLA -1000 @ 156.800003051758&#34;
## [1] &#34;2023-01-11 00:00:00 TSLA 1000 @ 123.220001220703&#34;
## [1] &#34;2023-02-22 00:00:00 TSLA -1000 @ 200.860000610352&#34;
## [1] &#34;2023-03-24 00:00:00 TSLA 1000 @ 190.410003662109&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-08 00:00:00 TSLA 1000 @ 171.789993286133&#34;
## 测试参数组合 12/27: nFast=16, nSlow=22, nSig=9
## 策略环境已重置
## [1] &#34;2018-02-23 00:00:00 TSLA 1000 @ 23.4699993133545&#34;
## [1] &#34;2018-03-06 00:00:00 TSLA -1000 @ 21.8799991607666&#34;
## [1] &#34;2018-04-09 00:00:00 TSLA 1000 @ 19.3106670379639&#34;
## [1] &#34;2018-05-17 00:00:00 TSLA -1000 @ 18.9693336486816&#34;
## [1] &#34;2018-06-01 00:00:00 TSLA 1000 @ 19.4546661376953&#34;
## [1] &#34;2018-06-27 00:00:00 TSLA -1000 @ 22.966667175293&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-20 00:00:00 TSLA -1000 @ 20.5626678466797&#34;
## [1] &#34;2018-09-18 00:00:00 TSLA 1000 @ 18.9973335266113&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-24 00:00:00 TSLA 1000 @ 19.2333335876465&#34;
## [1] &#34;2018-11-21 00:00:00 TSLA -1000 @ 22.5459995269775&#34;
## [1] &#34;2018-12-14 00:00:00 TSLA 1000 @ 24.3806667327881&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-10 00:00:00 TSLA 1000 @ 22.9979991912842&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-05 00:00:00 TSLA 1000 @ 21.4233322143555&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-15 00:00:00 TSLA 1000 @ 18.3619995117188&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-29 00:00:00 TSLA 1000 @ 18.6573333740234&#34;
## [1] &#34;2019-04-16 00:00:00 TSLA -1000 @ 18.2240009307861&#34;
## [1] &#34;2019-04-17 00:00:00 TSLA 1000 @ 18.0820007324219&#34;
## [1] &#34;2019-04-24 00:00:00 TSLA -1000 @ 17.2439994812012&#34;
## [1] &#34;2019-05-09 00:00:00 TSLA 1000 @ 16.1319999694824&#34;
## [1] &#34;2019-05-10 00:00:00 TSLA -1000 @ 15.9680004119873&#34;
## [1] &#34;2019-06-07 00:00:00 TSLA 1000 @ 13.6333332061768&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-09-04 00:00:00 TSLA 1000 @ 14.7119998931885&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-20 00:00:00 TSLA -1000 @ 23.4813327789307&#34;
## [1] &#34;2019-12-17 00:00:00 TSLA 1000 @ 25.2660007476807&#34;
## [1] &#34;2020-01-30 00:00:00 TSLA -1000 @ 42.7206687927246&#34;
## [1] &#34;2020-01-31 00:00:00 TSLA 1000 @ 43.3713340759277&#34;
## [1] &#34;2020-02-18 00:00:00 TSLA -1000 @ 57.2266654968262&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-03-31 00:00:00 TSLA 1000 @ 34.9333343505859&#34;
## [1] &#34;2020-05-08 00:00:00 TSLA -1000 @ 54.6279983520508&#34;
## [1] &#34;2020-05-11 00:00:00 TSLA 1000 @ 54.0859985351562&#34;
## [1] &#34;2020-05-13 00:00:00 TSLA -1000 @ 52.7306671142578&#34;
## [1] &#34;2020-06-04 00:00:00 TSLA 1000 @ 57.6253318786621&#34;
## [1] &#34;2020-06-05 00:00:00 TSLA -1000 @ 59.0439987182617&#34;
## [1] &#34;2020-06-09 00:00:00 TSLA 1000 @ 62.7113342285156&#34;
## [1] &#34;2020-06-23 00:00:00 TSLA -1000 @ 66.7853317260742&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-24 00:00:00 TSLA -1000 @ 94.466667175293&#34;
## [1] &#34;2020-08-18 00:00:00 TSLA 1000 @ 125.805999755859&#34;
## [1] &#34;2020-09-08 00:00:00 TSLA -1000 @ 110.069999694824&#34;
## [1] &#34;2020-10-15 00:00:00 TSLA 1000 @ 149.626663208008&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-17 00:00:00 TSLA -1000 @ 218.633331298828&#34;
## [1] &#34;2020-12-21 00:00:00 TSLA 1000 @ 216.619995117188&#34;
## [1] &#34;2020-12-22 00:00:00 TSLA -1000 @ 213.446670532227&#34;
## [1] &#34;2021-01-06 00:00:00 TSLA 1000 @ 251.99333190918&#34;
## [1] &#34;2021-01-21 00:00:00 TSLA -1000 @ 281.663330078125&#34;
## [1] &#34;2021-03-16 00:00:00 TSLA 1000 @ 225.626663208008&#34;
## [1] &#34;2021-03-29 00:00:00 TSLA -1000 @ 203.763336181641&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-29 00:00:00 TSLA -1000 @ 225.66667175293&#34;
## [1] &#34;2021-05-27 00:00:00 TSLA 1000 @ 210.283340454102&#34;
## [1] &#34;2021-07-15 00:00:00 TSLA -1000 @ 216.866668701172&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-18 00:00:00 TSLA -1000 @ 229.663330078125&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-07 00:00:00 TSLA -1000 @ 264.536682128906&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-10 00:00:00 TSLA -1000 @ 355.983337402344&#34;
## [1] &#34;2021-12-28 00:00:00 TSLA 1000 @ 362.823333740234&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-10 00:00:00 TSLA 1000 @ 301.516662597656&#34;
## [1] &#34;2022-02-14 00:00:00 TSLA -1000 @ 291.920013427734&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-23 00:00:00 TSLA -1000 @ 254.679992675781&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-12 00:00:00 TSLA -1000 @ 328.983337402344&#34;
## [1] &#34;2022-06-01 00:00:00 TSLA 1000 @ 246.789993286133&#34;
## [1] &#34;2022-06-21 00:00:00 TSLA -1000 @ 237.036666870117&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-12 00:00:00 TSLA -1000 @ 300.029998779297&#34;
## [1] &#34;2022-08-16 00:00:00 TSLA 1000 @ 306.563323974609&#34;
## [1] &#34;2022-08-18 00:00:00 TSLA -1000 @ 302.869995117188&#34;
## [1] &#34;2022-09-14 00:00:00 TSLA 1000 @ 302.609985351562&#34;
## [1] &#34;2022-09-26 00:00:00 TSLA -1000 @ 276.010009765625&#34;
## [1] &#34;2022-10-27 00:00:00 TSLA 1000 @ 225.089996337891&#34;
## [1] &#34;2022-11-09 00:00:00 TSLA -1000 @ 177.589996337891&#34;
## [1] &#34;2022-11-29 00:00:00 TSLA 1000 @ 180.830001831055&#34;
## [1] &#34;2022-12-14 00:00:00 TSLA -1000 @ 156.800003051758&#34;
## [1] &#34;2023-01-12 00:00:00 TSLA 1000 @ 123.559997558594&#34;
## [1] &#34;2023-02-23 00:00:00 TSLA -1000 @ 202.070007324219&#34;
## [1] &#34;2023-03-28 00:00:00 TSLA 1000 @ 189.190002441406&#34;
## [1] &#34;2023-03-29 00:00:00 TSLA -1000 @ 193.880004882812&#34;
## [1] &#34;2023-03-30 00:00:00 TSLA 1000 @ 195.279998779297&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-09 00:00:00 TSLA 1000 @ 169.149993896484&#34;
## 测试参数组合 13/27: nFast=8, nSlow=26, nSig=9
## 策略环境已重置
## [1] &#34;2018-03-14 00:00:00 TSLA 1000 @ 21.775333404541&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-06 00:00:00 TSLA 1000 @ 19.953332901001&#34;
## [1] &#34;2018-04-26 00:00:00 TSLA -1000 @ 19.0319995880127&#34;
## [1] &#34;2018-04-30 00:00:00 TSLA 1000 @ 19.5933322906494&#34;
## [1] &#34;2018-05-16 00:00:00 TSLA -1000 @ 19.0986671447754&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-06-25 00:00:00 TSLA -1000 @ 22.2006664276123&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-17 00:00:00 TSLA -1000 @ 20.3666667938232&#34;
## [1] &#34;2018-09-17 00:00:00 TSLA 1000 @ 19.6560001373291&#34;
## [1] &#34;2018-10-01 00:00:00 TSLA -1000 @ 20.7133331298828&#34;
## [1] &#34;2018-10-02 00:00:00 TSLA 1000 @ 20.068000793457&#34;
## [1] &#34;2018-10-05 00:00:00 TSLA -1000 @ 17.4633331298828&#34;
## [1] &#34;2018-10-18 00:00:00 TSLA 1000 @ 17.5939998626709&#34;
## [1] &#34;2018-11-14 00:00:00 TSLA -1000 @ 22.9333324432373&#34;
## [1] &#34;2018-12-07 00:00:00 TSLA 1000 @ 23.8646678924561&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-09 00:00:00 TSLA 1000 @ 22.5686664581299&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-04 00:00:00 TSLA 1000 @ 20.8593330383301&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-14 00:00:00 TSLA 1000 @ 19.3306674957275&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-28 00:00:00 TSLA 1000 @ 18.5746669769287&#34;
## [1] &#34;2019-04-12 00:00:00 TSLA -1000 @ 17.8466663360596&#34;
## [1] &#34;2019-04-18 00:00:00 TSLA 1000 @ 18.2173328399658&#34;
## [1] &#34;2019-04-23 00:00:00 TSLA -1000 @ 17.5933322906494&#34;
## [1] &#34;2019-05-07 00:00:00 TSLA 1000 @ 16.470666885376&#34;
## [1] &#34;2019-05-14 00:00:00 TSLA -1000 @ 15.4873332977295&#34;
## [1] &#34;2019-06-06 00:00:00 TSLA 1000 @ 13.7299995422363&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-09-03 00:00:00 TSLA 1000 @ 15.0006666183472&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-18 00:00:00 TSLA -1000 @ 23.3326663970947&#34;
## [1] &#34;2019-12-13 00:00:00 TSLA 1000 @ 23.8926677703857&#34;
## [1] &#34;2020-01-28 00:00:00 TSLA -1000 @ 37.7933311462402&#34;
## [1] &#34;2020-01-31 00:00:00 TSLA 1000 @ 43.3713340759277&#34;
## [1] &#34;2020-02-13 00:00:00 TSLA -1000 @ 53.5999984741211&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-03-27 00:00:00 TSLA 1000 @ 34.2906684875488&#34;
## [1] &#34;2020-05-04 00:00:00 TSLA -1000 @ 50.7459983825684&#34;
## [1] &#34;2020-06-02 00:00:00 TSLA 1000 @ 58.7706680297852&#34;
## [1] &#34;2020-06-23 00:00:00 TSLA -1000 @ 66.7853317260742&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-22 00:00:00 TSLA -1000 @ 106.155334472656&#34;
## [1] &#34;2020-08-17 00:00:00 TSLA 1000 @ 122.375999450684&#34;
## [1] &#34;2020-09-04 00:00:00 TSLA -1000 @ 139.440002441406&#34;
## [1] &#34;2020-09-22 00:00:00 TSLA 1000 @ 141.410003662109&#34;
## [1] &#34;2020-09-23 00:00:00 TSLA -1000 @ 126.786666870117&#34;
## [1] &#34;2020-10-02 00:00:00 TSLA 1000 @ 138.363327026367&#34;
## [1] &#34;2020-10-05 00:00:00 TSLA -1000 @ 141.893325805664&#34;
## [1] &#34;2020-10-13 00:00:00 TSLA 1000 @ 148.883331298828&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-06 00:00:00 TSLA 1000 @ 143.316665649414&#34;
## [1] &#34;2020-11-11 00:00:00 TSLA -1000 @ 139.043334960938&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-14 00:00:00 TSLA -1000 @ 213.276672363281&#34;
## [1] &#34;2021-01-05 00:00:00 TSLA 1000 @ 245.036666870117&#34;
## [1] &#34;2021-01-20 00:00:00 TSLA -1000 @ 283.483337402344&#34;
## [1] &#34;2021-03-12 00:00:00 TSLA 1000 @ 231.24333190918&#34;
## [1] &#34;2021-03-29 00:00:00 TSLA -1000 @ 203.763336181641&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-28 00:00:00 TSLA -1000 @ 231.466659545898&#34;
## [1] &#34;2021-05-26 00:00:00 TSLA 1000 @ 206.376663208008&#34;
## [1] &#34;2021-07-08 00:00:00 TSLA -1000 @ 217.603332519531&#34;
## [1] &#34;2021-07-30 00:00:00 TSLA 1000 @ 229.066665649414&#34;
## [1] &#34;2021-08-17 00:00:00 TSLA -1000 @ 221.903335571289&#34;
## [1] &#34;2021-08-30 00:00:00 TSLA 1000 @ 243.636672973633&#34;
## [1] &#34;2021-09-15 00:00:00 TSLA -1000 @ 251.943328857422&#34;
## [1] &#34;2021-09-16 00:00:00 TSLA 1000 @ 252.330001831055&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-06 00:00:00 TSLA -1000 @ 260.916656494141&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-10 00:00:00 TSLA -1000 @ 355.983337402344&#34;
## [1] &#34;2021-12-27 00:00:00 TSLA 1000 @ 364.646667480469&#34;
## [1] &#34;2022-01-10 00:00:00 TSLA -1000 @ 352.706665039062&#34;
## [1] &#34;2022-02-08 00:00:00 TSLA 1000 @ 307.333343505859&#34;
## [1] &#34;2022-02-15 00:00:00 TSLA -1000 @ 307.476654052734&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-23 00:00:00 TSLA -1000 @ 254.679992675781&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-08 00:00:00 TSLA -1000 @ 341.829986572266&#34;
## [1] &#34;2022-05-31 00:00:00 TSLA 1000 @ 252.753326416016&#34;
## [1] &#34;2022-06-15 00:00:00 TSLA -1000 @ 233&#34;
## [1] &#34;2022-06-16 00:00:00 TSLA 1000 @ 213.100006103516&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-10 00:00:00 TSLA -1000 @ 294.356658935547&#34;
## [1] &#34;2022-09-12 00:00:00 TSLA 1000 @ 304.420013427734&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-25 00:00:00 TSLA 1000 @ 222.419998168945&#34;
## [1] &#34;2022-11-08 00:00:00 TSLA -1000 @ 191.300003051758&#34;
## [1] &#34;2022-11-28 00:00:00 TSLA 1000 @ 182.919998168945&#34;
## [1] &#34;2022-12-13 00:00:00 TSLA -1000 @ 160.949996948242&#34;
## [1] &#34;2023-01-10 00:00:00 TSLA 1000 @ 118.849998474121&#34;
## [1] &#34;2023-02-21 00:00:00 TSLA -1000 @ 197.369995117188&#34;
## [1] &#34;2023-03-22 00:00:00 TSLA 1000 @ 191.149993896484&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-08 00:00:00 TSLA 1000 @ 171.789993286133&#34;
## 测试参数组合 14/27: nFast=12, nSlow=26, nSig=9
## 策略环境已重置
## [1] &#34;2018-02-22 00:00:00 TSLA 1000 @ 23.0779991149902&#34;
## [1] &#34;2018-03-06 00:00:00 TSLA -1000 @ 21.8799991607666&#34;
## [1] &#34;2018-03-14 00:00:00 TSLA 1000 @ 21.775333404541&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-09 00:00:00 TSLA 1000 @ 19.3106670379639&#34;
## [1] &#34;2018-05-17 00:00:00 TSLA -1000 @ 18.9693336486816&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-06-26 00:00:00 TSLA -1000 @ 22.7999992370605&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-20 00:00:00 TSLA -1000 @ 20.5626678466797&#34;
## [1] &#34;2018-09-18 00:00:00 TSLA 1000 @ 18.9973335266113&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-19 00:00:00 TSLA 1000 @ 17.3333320617676&#34;
## [1] &#34;2018-10-22 00:00:00 TSLA -1000 @ 17.3966674804688&#34;
## [1] &#34;2018-10-23 00:00:00 TSLA 1000 @ 19.6093330383301&#34;
## [1] &#34;2018-11-20 00:00:00 TSLA -1000 @ 23.1660003662109&#34;
## [1] &#34;2018-12-12 00:00:00 TSLA 1000 @ 24.4400005340576&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-10 00:00:00 TSLA 1000 @ 22.9979991912842&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-05 00:00:00 TSLA 1000 @ 21.4233322143555&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-15 00:00:00 TSLA 1000 @ 18.3619995117188&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-29 00:00:00 TSLA 1000 @ 18.6573333740234&#34;
## [1] &#34;2019-04-16 00:00:00 TSLA -1000 @ 18.2240009307861&#34;
## [1] &#34;2019-04-17 00:00:00 TSLA 1000 @ 18.0820007324219&#34;
## [1] &#34;2019-04-23 00:00:00 TSLA -1000 @ 17.5933322906494&#34;
## [1] &#34;2019-05-08 00:00:00 TSLA 1000 @ 16.3226661682129&#34;
## [1] &#34;2019-05-13 00:00:00 TSLA -1000 @ 15.1339998245239&#34;
## [1] &#34;2019-06-07 00:00:00 TSLA 1000 @ 13.6333332061768&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-09-03 00:00:00 TSLA 1000 @ 15.0006666183472&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-19 00:00:00 TSLA -1000 @ 23.9680004119873&#34;
## [1] &#34;2019-12-17 00:00:00 TSLA 1000 @ 25.2660007476807&#34;
## [1] &#34;2020-01-29 00:00:00 TSLA -1000 @ 38.732666015625&#34;
## [1] &#34;2020-01-31 00:00:00 TSLA 1000 @ 43.3713340759277&#34;
## [1] &#34;2020-02-14 00:00:00 TSLA -1000 @ 53.335334777832&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-03-30 00:00:00 TSLA 1000 @ 33.4753341674805&#34;
## [1] &#34;2020-05-06 00:00:00 TSLA -1000 @ 52.1720008850098&#34;
## [1] &#34;2020-05-11 00:00:00 TSLA 1000 @ 54.0859985351562&#34;
## [1] &#34;2020-05-12 00:00:00 TSLA -1000 @ 53.9606666564941&#34;
## [1] &#34;2020-06-03 00:00:00 TSLA 1000 @ 58.8639984130859&#34;
## [1] &#34;2020-06-05 00:00:00 TSLA -1000 @ 59.0439987182617&#34;
## [1] &#34;2020-06-09 00:00:00 TSLA 1000 @ 62.7113342285156&#34;
## [1] &#34;2020-06-23 00:00:00 TSLA -1000 @ 66.7853317260742&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-24 00:00:00 TSLA -1000 @ 94.466667175293&#34;
## [1] &#34;2020-08-18 00:00:00 TSLA 1000 @ 125.805999755859&#34;
## [1] &#34;2020-09-04 00:00:00 TSLA -1000 @ 139.440002441406&#34;
## [1] &#34;2020-10-14 00:00:00 TSLA 1000 @ 153.766662597656&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-09 00:00:00 TSLA 1000 @ 140.419998168945&#34;
## [1] &#34;2020-11-11 00:00:00 TSLA -1000 @ 139.043334960938&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-16 00:00:00 TSLA -1000 @ 207.589996337891&#34;
## [1] &#34;2020-12-21 00:00:00 TSLA 1000 @ 216.619995117188&#34;
## [1] &#34;2020-12-22 00:00:00 TSLA -1000 @ 213.446670532227&#34;
## [1] &#34;2021-01-06 00:00:00 TSLA 1000 @ 251.99333190918&#34;
## [1] &#34;2021-01-21 00:00:00 TSLA -1000 @ 281.663330078125&#34;
## [1] &#34;2021-03-15 00:00:00 TSLA 1000 @ 235.979995727539&#34;
## [1] &#34;2021-03-29 00:00:00 TSLA -1000 @ 203.763336181641&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-29 00:00:00 TSLA -1000 @ 225.66667175293&#34;
## [1] &#34;2021-05-27 00:00:00 TSLA 1000 @ 210.283340454102&#34;
## [1] &#34;2021-07-12 00:00:00 TSLA -1000 @ 228.566665649414&#34;
## [1] &#34;2021-07-13 00:00:00 TSLA 1000 @ 222.846664428711&#34;
## [1] &#34;2021-07-15 00:00:00 TSLA -1000 @ 216.866668701172&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-17 00:00:00 TSLA -1000 @ 221.903335571289&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-06 00:00:00 TSLA -1000 @ 260.916656494141&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-10 00:00:00 TSLA -1000 @ 355.983337402344&#34;
## [1] &#34;2021-12-28 00:00:00 TSLA 1000 @ 362.823333740234&#34;
## [1] &#34;2022-01-12 00:00:00 TSLA -1000 @ 368.739990234375&#34;
## [1] &#34;2022-01-13 00:00:00 TSLA 1000 @ 343.853332519531&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-10 00:00:00 TSLA 1000 @ 301.516662597656&#34;
## [1] &#34;2022-02-14 00:00:00 TSLA -1000 @ 291.920013427734&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-23 00:00:00 TSLA -1000 @ 254.679992675781&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-11 00:00:00 TSLA -1000 @ 325.309997558594&#34;
## [1] &#34;2022-05-31 00:00:00 TSLA 1000 @ 252.753326416016&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-12 00:00:00 TSLA -1000 @ 300.029998779297&#34;
## [1] &#34;2022-08-17 00:00:00 TSLA 1000 @ 303.996673583984&#34;
## [1] &#34;2022-08-18 00:00:00 TSLA -1000 @ 302.869995117188&#34;
## [1] &#34;2022-09-13 00:00:00 TSLA 1000 @ 292.130004882812&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-26 00:00:00 TSLA 1000 @ 224.639999389648&#34;
## [1] &#34;2022-11-09 00:00:00 TSLA -1000 @ 177.589996337891&#34;
## [1] &#34;2022-11-29 00:00:00 TSLA 1000 @ 180.830001831055&#34;
## [1] &#34;2022-12-14 00:00:00 TSLA -1000 @ 156.800003051758&#34;
## [1] &#34;2023-01-11 00:00:00 TSLA 1000 @ 123.220001220703&#34;
## [1] &#34;2023-02-22 00:00:00 TSLA -1000 @ 200.860000610352&#34;
## [1] &#34;2023-03-24 00:00:00 TSLA 1000 @ 190.410003662109&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-08 00:00:00 TSLA 1000 @ 171.789993286133&#34;
## 测试参数组合 15/27: nFast=16, nSlow=26, nSig=9
## 策略环境已重置
## [1] &#34;2018-02-23 00:00:00 TSLA 1000 @ 23.4699993133545&#34;
## [1] &#34;2018-03-06 00:00:00 TSLA -1000 @ 21.8799991607666&#34;
## [1] &#34;2018-03-14 00:00:00 TSLA 1000 @ 21.775333404541&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-10 00:00:00 TSLA 1000 @ 20.3133335113525&#34;
## [1] &#34;2018-05-18 00:00:00 TSLA -1000 @ 18.4546661376953&#34;
## [1] &#34;2018-06-01 00:00:00 TSLA 1000 @ 19.4546661376953&#34;
## [1] &#34;2018-06-27 00:00:00 TSLA -1000 @ 22.966667175293&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-20 00:00:00 TSLA -1000 @ 20.5626678466797&#34;
## [1] &#34;2018-09-20 00:00:00 TSLA 1000 @ 19.8886661529541&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-24 00:00:00 TSLA 1000 @ 19.2333335876465&#34;
## [1] &#34;2018-11-23 00:00:00 TSLA -1000 @ 21.7220001220703&#34;
## [1] &#34;2018-12-12 00:00:00 TSLA 1000 @ 24.4400005340576&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-10 00:00:00 TSLA 1000 @ 22.9979991912842&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-06 00:00:00 TSLA 1000 @ 21.1480007171631&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-29 00:00:00 TSLA 1000 @ 18.6573333740234&#34;
## [1] &#34;2019-04-24 00:00:00 TSLA -1000 @ 17.2439994812012&#34;
## [1] &#34;2019-06-07 00:00:00 TSLA 1000 @ 13.6333332061768&#34;
## [1] &#34;2019-07-29 00:00:00 TSLA -1000 @ 15.7180004119873&#34;
## [1] &#34;2019-09-04 00:00:00 TSLA 1000 @ 14.7119998931885&#34;
## [1] &#34;2019-09-26 00:00:00 TSLA -1000 @ 16.1706676483154&#34;
## [1] &#34;2019-09-30 00:00:00 TSLA 1000 @ 16.0580005645752&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-21 00:00:00 TSLA -1000 @ 23.6553325653076&#34;
## [1] &#34;2019-12-17 00:00:00 TSLA 1000 @ 25.2660007476807&#34;
## [1] &#34;2020-02-18 00:00:00 TSLA -1000 @ 57.2266654968262&#34;
## [1] &#34;2020-02-19 00:00:00 TSLA 1000 @ 61.1613311767578&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-04-01 00:00:00 TSLA 1000 @ 32.1040000915527&#34;
## [1] &#34;2020-04-03 00:00:00 TSLA -1000 @ 32.0006675720215&#34;
## [1] &#34;2020-04-07 00:00:00 TSLA 1000 @ 36.3633346557617&#34;
## [1] &#34;2020-05-14 00:00:00 TSLA -1000 @ 53.5553321838379&#34;
## [1] &#34;2020-06-04 00:00:00 TSLA 1000 @ 57.6253318786621&#34;
## [1] &#34;2020-06-05 00:00:00 TSLA -1000 @ 59.0439987182617&#34;
## [1] &#34;2020-06-09 00:00:00 TSLA 1000 @ 62.7113342285156&#34;
## [1] &#34;2020-06-24 00:00:00 TSLA -1000 @ 64.0566635131836&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-24 00:00:00 TSLA -1000 @ 94.466667175293&#34;
## [1] &#34;2020-08-18 00:00:00 TSLA 1000 @ 125.805999755859&#34;
## [1] &#34;2020-09-08 00:00:00 TSLA -1000 @ 110.069999694824&#34;
## [1] &#34;2020-10-15 00:00:00 TSLA 1000 @ 149.626663208008&#34;
## [1] &#34;2020-10-19 00:00:00 TSLA -1000 @ 143.610000610352&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-17 00:00:00 TSLA -1000 @ 218.633331298828&#34;
## [1] &#34;2020-12-21 00:00:00 TSLA 1000 @ 216.619995117188&#34;
## [1] &#34;2020-12-22 00:00:00 TSLA -1000 @ 213.446670532227&#34;
## [1] &#34;2021-01-06 00:00:00 TSLA 1000 @ 251.99333190918&#34;
## [1] &#34;2021-01-21 00:00:00 TSLA -1000 @ 281.663330078125&#34;
## [1] &#34;2021-03-16 00:00:00 TSLA 1000 @ 225.626663208008&#34;
## [1] &#34;2021-03-29 00:00:00 TSLA -1000 @ 203.763336181641&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-30 00:00:00 TSLA -1000 @ 236.479995727539&#34;
## [1] &#34;2021-05-28 00:00:00 TSLA 1000 @ 208.406661987305&#34;
## [1] &#34;2021-07-15 00:00:00 TSLA -1000 @ 216.866668701172&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-18 00:00:00 TSLA -1000 @ 229.663330078125&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-07 00:00:00 TSLA -1000 @ 264.536682128906&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-11 00:00:00 TSLA -1000 @ 354.503326416016&#34;
## [1] &#34;2021-12-28 00:00:00 TSLA 1000 @ 362.823333740234&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-11 00:00:00 TSLA 1000 @ 286.666656494141&#34;
## [1] &#34;2022-02-14 00:00:00 TSLA -1000 @ 291.920013427734&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-22 00:00:00 TSLA -1000 @ 273.843322753906&#34;
## [1] &#34;2022-03-03 00:00:00 TSLA 1000 @ 279.763336181641&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-12 00:00:00 TSLA -1000 @ 328.983337402344&#34;
## [1] &#34;2022-06-01 00:00:00 TSLA 1000 @ 246.789993286133&#34;
## [1] &#34;2022-06-21 00:00:00 TSLA -1000 @ 237.036666870117&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-19 00:00:00 TSLA -1000 @ 296.666656494141&#34;
## [1] &#34;2022-09-15 00:00:00 TSLA 1000 @ 303.75&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-27 00:00:00 TSLA 1000 @ 225.089996337891&#34;
## [1] &#34;2022-11-09 00:00:00 TSLA -1000 @ 177.589996337891&#34;
## [1] &#34;2022-11-29 00:00:00 TSLA 1000 @ 180.830001831055&#34;
## [1] &#34;2022-12-14 00:00:00 TSLA -1000 @ 156.800003051758&#34;
## [1] &#34;2023-01-12 00:00:00 TSLA 1000 @ 123.559997558594&#34;
## [1] &#34;2023-02-24 00:00:00 TSLA -1000 @ 196.880004882812&#34;
## [1] &#34;2023-03-30 00:00:00 TSLA 1000 @ 195.279998779297&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-09 00:00:00 TSLA 1000 @ 169.149993896484&#34;
## 测试参数组合 16/27: nFast=8, nSlow=30, nSig=9
## 策略环境已重置
## [1] &#34;2018-03-13 00:00:00 TSLA 1000 @ 22.7893333435059&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-06 00:00:00 TSLA 1000 @ 19.953332901001&#34;
## [1] &#34;2018-04-26 00:00:00 TSLA -1000 @ 19.0319995880127&#34;
## [1] &#34;2018-04-30 00:00:00 TSLA 1000 @ 19.5933322906494&#34;
## [1] &#34;2018-05-16 00:00:00 TSLA -1000 @ 19.0986671447754&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-06-25 00:00:00 TSLA -1000 @ 22.2006664276123&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-17 00:00:00 TSLA -1000 @ 20.3666667938232&#34;
## [1] &#34;2018-09-17 00:00:00 TSLA 1000 @ 19.6560001373291&#34;
## [1] &#34;2018-10-05 00:00:00 TSLA -1000 @ 17.4633331298828&#34;
## [1] &#34;2018-10-18 00:00:00 TSLA 1000 @ 17.5939998626709&#34;
## [1] &#34;2018-11-14 00:00:00 TSLA -1000 @ 22.9333324432373&#34;
## [1] &#34;2018-12-07 00:00:00 TSLA 1000 @ 23.8646678924561&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-09 00:00:00 TSLA 1000 @ 22.5686664581299&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-04 00:00:00 TSLA 1000 @ 20.8593330383301&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-15 00:00:00 TSLA 1000 @ 18.3619995117188&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-28 00:00:00 TSLA 1000 @ 18.5746669769287&#34;
## [1] &#34;2019-04-15 00:00:00 TSLA -1000 @ 17.7586669921875&#34;
## [1] &#34;2019-04-18 00:00:00 TSLA 1000 @ 18.2173328399658&#34;
## [1] &#34;2019-04-23 00:00:00 TSLA -1000 @ 17.5933322906494&#34;
## [1] &#34;2019-05-07 00:00:00 TSLA 1000 @ 16.470666885376&#34;
## [1] &#34;2019-05-14 00:00:00 TSLA -1000 @ 15.4873332977295&#34;
## [1] &#34;2019-06-06 00:00:00 TSLA 1000 @ 13.7299995422363&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-09-03 00:00:00 TSLA 1000 @ 15.0006666183472&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-19 00:00:00 TSLA -1000 @ 23.9680004119873&#34;
## [1] &#34;2019-12-13 00:00:00 TSLA 1000 @ 23.8926677703857&#34;
## [1] &#34;2020-01-29 00:00:00 TSLA -1000 @ 38.732666015625&#34;
## [1] &#34;2020-01-31 00:00:00 TSLA 1000 @ 43.3713340759277&#34;
## [1] &#34;2020-02-13 00:00:00 TSLA -1000 @ 53.5999984741211&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-03-27 00:00:00 TSLA 1000 @ 34.2906684875488&#34;
## [1] &#34;2020-05-04 00:00:00 TSLA -1000 @ 50.7459983825684&#34;
## [1] &#34;2020-06-02 00:00:00 TSLA 1000 @ 58.7706680297852&#34;
## [1] &#34;2020-06-23 00:00:00 TSLA -1000 @ 66.7853317260742&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-23 00:00:00 TSLA -1000 @ 100.87133026123&#34;
## [1] &#34;2020-08-17 00:00:00 TSLA 1000 @ 122.375999450684&#34;
## [1] &#34;2020-09-04 00:00:00 TSLA -1000 @ 139.440002441406&#34;
## [1] &#34;2020-09-22 00:00:00 TSLA 1000 @ 141.410003662109&#34;
## [1] &#34;2020-09-23 00:00:00 TSLA -1000 @ 126.786666870117&#34;
## [1] &#34;2020-10-14 00:00:00 TSLA 1000 @ 153.766662597656&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-06 00:00:00 TSLA 1000 @ 143.316665649414&#34;
## [1] &#34;2020-11-11 00:00:00 TSLA -1000 @ 139.043334960938&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-14 00:00:00 TSLA -1000 @ 213.276672363281&#34;
## [1] &#34;2020-12-21 00:00:00 TSLA 1000 @ 216.619995117188&#34;
## [1] &#34;2020-12-22 00:00:00 TSLA -1000 @ 213.446670532227&#34;
## [1] &#34;2021-01-05 00:00:00 TSLA 1000 @ 245.036666870117&#34;
## [1] &#34;2021-01-20 00:00:00 TSLA -1000 @ 283.483337402344&#34;
## [1] &#34;2021-03-12 00:00:00 TSLA 1000 @ 231.24333190918&#34;
## [1] &#34;2021-03-26 00:00:00 TSLA -1000 @ 206.236663818359&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-28 00:00:00 TSLA -1000 @ 231.466659545898&#34;
## [1] &#34;2021-05-26 00:00:00 TSLA 1000 @ 206.376663208008&#34;
## [1] &#34;2021-07-08 00:00:00 TSLA -1000 @ 217.603332519531&#34;
## [1] &#34;2021-07-30 00:00:00 TSLA 1000 @ 229.066665649414&#34;
## [1] &#34;2021-08-17 00:00:00 TSLA -1000 @ 221.903335571289&#34;
## [1] &#34;2021-08-30 00:00:00 TSLA 1000 @ 243.636672973633&#34;
## [1] &#34;2021-09-15 00:00:00 TSLA -1000 @ 251.943328857422&#34;
## [1] &#34;2021-09-16 00:00:00 TSLA 1000 @ 252.330001831055&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-06 00:00:00 TSLA -1000 @ 260.916656494141&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-10 00:00:00 TSLA -1000 @ 355.983337402344&#34;
## [1] &#34;2021-12-27 00:00:00 TSLA 1000 @ 364.646667480469&#34;
## [1] &#34;2022-01-11 00:00:00 TSLA -1000 @ 354.799987792969&#34;
## [1] &#34;2022-02-09 00:00:00 TSLA 1000 @ 310.666656494141&#34;
## [1] &#34;2022-02-14 00:00:00 TSLA -1000 @ 291.920013427734&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-23 00:00:00 TSLA -1000 @ 254.679992675781&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-08 00:00:00 TSLA -1000 @ 341.829986572266&#34;
## [1] &#34;2022-05-31 00:00:00 TSLA 1000 @ 252.753326416016&#34;
## [1] &#34;2022-06-15 00:00:00 TSLA -1000 @ 233&#34;
## [1] &#34;2022-06-16 00:00:00 TSLA 1000 @ 213.100006103516&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-10 00:00:00 TSLA -1000 @ 294.356658935547&#34;
## [1] &#34;2022-09-12 00:00:00 TSLA 1000 @ 304.420013427734&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-26 00:00:00 TSLA 1000 @ 224.639999389648&#34;
## [1] &#34;2022-11-08 00:00:00 TSLA -1000 @ 191.300003051758&#34;
## [1] &#34;2022-11-28 00:00:00 TSLA 1000 @ 182.919998168945&#34;
## [1] &#34;2022-12-13 00:00:00 TSLA -1000 @ 160.949996948242&#34;
## [1] &#34;2023-01-10 00:00:00 TSLA 1000 @ 118.849998474121&#34;
## [1] &#34;2023-02-22 00:00:00 TSLA -1000 @ 200.860000610352&#34;
## [1] &#34;2023-03-22 00:00:00 TSLA 1000 @ 191.149993896484&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-08 00:00:00 TSLA 1000 @ 171.789993286133&#34;
## 测试参数组合 17/27: nFast=12, nSlow=30, nSig=9
## 策略环境已重置
## [1] &#34;2018-03-13 00:00:00 TSLA 1000 @ 22.7893333435059&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-09 00:00:00 TSLA 1000 @ 19.3106670379639&#34;
## [1] &#34;2018-05-17 00:00:00 TSLA -1000 @ 18.9693336486816&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-06-26 00:00:00 TSLA -1000 @ 22.7999992370605&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-20 00:00:00 TSLA -1000 @ 20.5626678466797&#34;
## [1] &#34;2018-09-18 00:00:00 TSLA 1000 @ 18.9973335266113&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-24 00:00:00 TSLA 1000 @ 19.2333335876465&#34;
## [1] &#34;2018-11-21 00:00:00 TSLA -1000 @ 22.5459995269775&#34;
## [1] &#34;2018-12-11 00:00:00 TSLA 1000 @ 24.4506664276123&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-10 00:00:00 TSLA 1000 @ 22.9979991912842&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-05 00:00:00 TSLA 1000 @ 21.4233322143555&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-15 00:00:00 TSLA 1000 @ 18.3619995117188&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-29 00:00:00 TSLA 1000 @ 18.6573333740234&#34;
## [1] &#34;2019-04-16 00:00:00 TSLA -1000 @ 18.2240009307861&#34;
## [1] &#34;2019-04-17 00:00:00 TSLA 1000 @ 18.0820007324219&#34;
## [1] &#34;2019-04-23 00:00:00 TSLA -1000 @ 17.5933322906494&#34;
## [1] &#34;2019-05-08 00:00:00 TSLA 1000 @ 16.3226661682129&#34;
## [1] &#34;2019-05-13 00:00:00 TSLA -1000 @ 15.1339998245239&#34;
## [1] &#34;2019-06-07 00:00:00 TSLA 1000 @ 13.6333332061768&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-09-04 00:00:00 TSLA 1000 @ 14.7119998931885&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-21 00:00:00 TSLA -1000 @ 23.6553325653076&#34;
## [1] &#34;2019-12-17 00:00:00 TSLA 1000 @ 25.2660007476807&#34;
## [1] &#34;2020-02-18 00:00:00 TSLA -1000 @ 57.2266654968262&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-03-31 00:00:00 TSLA 1000 @ 34.9333343505859&#34;
## [1] &#34;2020-05-14 00:00:00 TSLA -1000 @ 53.5553321838379&#34;
## [1] &#34;2020-06-03 00:00:00 TSLA 1000 @ 58.8639984130859&#34;
## [1] &#34;2020-06-05 00:00:00 TSLA -1000 @ 59.0439987182617&#34;
## [1] &#34;2020-06-09 00:00:00 TSLA 1000 @ 62.7113342285156&#34;
## [1] &#34;2020-06-23 00:00:00 TSLA -1000 @ 66.7853317260742&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-24 00:00:00 TSLA -1000 @ 94.466667175293&#34;
## [1] &#34;2020-08-18 00:00:00 TSLA 1000 @ 125.805999755859&#34;
## [1] &#34;2020-09-04 00:00:00 TSLA -1000 @ 139.440002441406&#34;
## [1] &#34;2020-10-15 00:00:00 TSLA 1000 @ 149.626663208008&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-17 00:00:00 TSLA -1000 @ 218.633331298828&#34;
## [1] &#34;2020-12-21 00:00:00 TSLA 1000 @ 216.619995117188&#34;
## [1] &#34;2020-12-22 00:00:00 TSLA -1000 @ 213.446670532227&#34;
## [1] &#34;2021-01-06 00:00:00 TSLA 1000 @ 251.99333190918&#34;
## [1] &#34;2021-01-21 00:00:00 TSLA -1000 @ 281.663330078125&#34;
## [1] &#34;2021-03-16 00:00:00 TSLA 1000 @ 225.626663208008&#34;
## [1] &#34;2021-03-29 00:00:00 TSLA -1000 @ 203.763336181641&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-29 00:00:00 TSLA -1000 @ 225.66667175293&#34;
## [1] &#34;2021-05-27 00:00:00 TSLA 1000 @ 210.283340454102&#34;
## [1] &#34;2021-07-12 00:00:00 TSLA -1000 @ 228.566665649414&#34;
## [1] &#34;2021-07-13 00:00:00 TSLA 1000 @ 222.846664428711&#34;
## [1] &#34;2021-07-15 00:00:00 TSLA -1000 @ 216.866668701172&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-18 00:00:00 TSLA -1000 @ 229.663330078125&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-07 00:00:00 TSLA -1000 @ 264.536682128906&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-10 00:00:00 TSLA -1000 @ 355.983337402344&#34;
## [1] &#34;2021-12-28 00:00:00 TSLA 1000 @ 362.823333740234&#34;
## [1] &#34;2022-01-12 00:00:00 TSLA -1000 @ 368.739990234375&#34;
## [1] &#34;2022-01-13 00:00:00 TSLA 1000 @ 343.853332519531&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-10 00:00:00 TSLA 1000 @ 301.516662597656&#34;
## [1] &#34;2022-02-14 00:00:00 TSLA -1000 @ 291.920013427734&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-22 00:00:00 TSLA -1000 @ 273.843322753906&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-12 00:00:00 TSLA -1000 @ 328.983337402344&#34;
## [1] &#34;2022-06-01 00:00:00 TSLA 1000 @ 246.789993286133&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-12 00:00:00 TSLA -1000 @ 300.029998779297&#34;
## [1] &#34;2022-08-16 00:00:00 TSLA 1000 @ 306.563323974609&#34;
## [1] &#34;2022-08-19 00:00:00 TSLA -1000 @ 296.666656494141&#34;
## [1] &#34;2022-09-13 00:00:00 TSLA 1000 @ 292.130004882812&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-27 00:00:00 TSLA 1000 @ 225.089996337891&#34;
## [1] &#34;2022-11-08 00:00:00 TSLA -1000 @ 191.300003051758&#34;
## [1] &#34;2022-11-29 00:00:00 TSLA 1000 @ 180.830001831055&#34;
## [1] &#34;2022-12-14 00:00:00 TSLA -1000 @ 156.800003051758&#34;
## [1] &#34;2023-01-11 00:00:00 TSLA 1000 @ 123.220001220703&#34;
## [1] &#34;2023-02-23 00:00:00 TSLA -1000 @ 202.070007324219&#34;
## [1] &#34;2023-03-28 00:00:00 TSLA 1000 @ 189.190002441406&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-09 00:00:00 TSLA 1000 @ 169.149993896484&#34;
## 测试参数组合 18/27: nFast=16, nSlow=30, nSig=9
## 策略环境已重置
## [1] &#34;2018-03-13 00:00:00 TSLA 1000 @ 22.7893333435059&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-11 00:00:00 TSLA 1000 @ 20.0620002746582&#34;
## [1] &#34;2018-05-18 00:00:00 TSLA -1000 @ 18.4546661376953&#34;
## [1] &#34;2018-06-01 00:00:00 TSLA 1000 @ 19.4546661376953&#34;
## [1] &#34;2018-06-28 00:00:00 TSLA -1000 @ 23.3286666870117&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-20 00:00:00 TSLA -1000 @ 20.5626678466797&#34;
## [1] &#34;2018-09-20 00:00:00 TSLA 1000 @ 19.8886661529541&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-24 00:00:00 TSLA 1000 @ 19.2333335876465&#34;
## [1] &#34;2018-11-23 00:00:00 TSLA -1000 @ 21.7220001220703&#34;
## [1] &#34;2018-12-12 00:00:00 TSLA 1000 @ 24.4400005340576&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-11 00:00:00 TSLA 1000 @ 23.1506671905518&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-06 00:00:00 TSLA 1000 @ 21.1480007171631&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-29 00:00:00 TSLA 1000 @ 18.6573333740234&#34;
## [1] &#34;2019-04-24 00:00:00 TSLA -1000 @ 17.2439994812012&#34;
## [1] &#34;2019-06-07 00:00:00 TSLA 1000 @ 13.6333332061768&#34;
## [1] &#34;2019-07-29 00:00:00 TSLA -1000 @ 15.7180004119873&#34;
## [1] &#34;2019-09-05 00:00:00 TSLA 1000 @ 15.3053331375122&#34;
## [1] &#34;2019-09-26 00:00:00 TSLA -1000 @ 16.1706676483154&#34;
## [1] &#34;2019-09-30 00:00:00 TSLA 1000 @ 16.0580005645752&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-21 00:00:00 TSLA -1000 @ 23.6553325653076&#34;
## [1] &#34;2019-12-17 00:00:00 TSLA 1000 @ 25.2660007476807&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-04-07 00:00:00 TSLA 1000 @ 36.3633346557617&#34;
## [1] &#34;2020-05-15 00:00:00 TSLA -1000 @ 53.2779998779297&#34;
## [1] &#34;2020-06-04 00:00:00 TSLA 1000 @ 57.6253318786621&#34;
## [1] &#34;2020-06-05 00:00:00 TSLA -1000 @ 59.0439987182617&#34;
## [1] &#34;2020-06-09 00:00:00 TSLA 1000 @ 62.7113342285156&#34;
## [1] &#34;2020-06-24 00:00:00 TSLA -1000 @ 64.0566635131836&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-24 00:00:00 TSLA -1000 @ 94.466667175293&#34;
## [1] &#34;2020-08-18 00:00:00 TSLA 1000 @ 125.805999755859&#34;
## [1] &#34;2020-09-08 00:00:00 TSLA -1000 @ 110.069999694824&#34;
## [1] &#34;2020-10-15 00:00:00 TSLA 1000 @ 149.626663208008&#34;
## [1] &#34;2020-10-19 00:00:00 TSLA -1000 @ 143.610000610352&#34;
## [1] &#34;2020-11-19 00:00:00 TSLA 1000 @ 166.42333984375&#34;
## [1] &#34;2020-12-23 00:00:00 TSLA -1000 @ 215.32666015625&#34;
## [1] &#34;2021-01-06 00:00:00 TSLA 1000 @ 251.99333190918&#34;
## [1] &#34;2021-01-22 00:00:00 TSLA -1000 @ 282.213317871094&#34;
## [1] &#34;2021-03-17 00:00:00 TSLA 1000 @ 233.936660766602&#34;
## [1] &#34;2021-03-25 00:00:00 TSLA -1000 @ 213.463333129883&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-30 00:00:00 TSLA -1000 @ 236.479995727539&#34;
## [1] &#34;2021-05-28 00:00:00 TSLA 1000 @ 208.406661987305&#34;
## [1] &#34;2021-07-16 00:00:00 TSLA -1000 @ 214.740005493164&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-18 00:00:00 TSLA -1000 @ 229.663330078125&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-11 00:00:00 TSLA -1000 @ 354.503326416016&#34;
## [1] &#34;2021-12-28 00:00:00 TSLA 1000 @ 362.823333740234&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-17 00:00:00 TSLA 1000 @ 292.116668701172&#34;
## [1] &#34;2022-02-22 00:00:00 TSLA -1000 @ 273.843322753906&#34;
## [1] &#34;2022-03-03 00:00:00 TSLA 1000 @ 279.763336181641&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-12 00:00:00 TSLA -1000 @ 328.983337402344&#34;
## [1] &#34;2022-06-01 00:00:00 TSLA 1000 @ 246.789993286133&#34;
## [1] &#34;2022-06-21 00:00:00 TSLA -1000 @ 237.036666870117&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-22 00:00:00 TSLA -1000 @ 289.913330078125&#34;
## [1] &#34;2022-09-15 00:00:00 TSLA 1000 @ 303.75&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-28 00:00:00 TSLA 1000 @ 228.520004272461&#34;
## [1] &#34;2022-11-09 00:00:00 TSLA -1000 @ 177.589996337891&#34;
## [1] &#34;2022-11-29 00:00:00 TSLA 1000 @ 180.830001831055&#34;
## [1] &#34;2022-12-14 00:00:00 TSLA -1000 @ 156.800003051758&#34;
## [1] &#34;2023-01-12 00:00:00 TSLA 1000 @ 123.559997558594&#34;
## [1] &#34;2023-02-27 00:00:00 TSLA -1000 @ 207.630004882812&#34;
## [1] &#34;2023-03-31 00:00:00 TSLA 1000 @ 207.460006713867&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-09 00:00:00 TSLA 1000 @ 169.149993896484&#34;
## 测试参数组合 19/27: nFast=8, nSlow=22, nSig=11
## 策略环境已重置
## [1] &#34;2018-02-23 00:00:00 TSLA 1000 @ 23.4699993133545&#34;
## [1] &#34;2018-03-05 00:00:00 TSLA -1000 @ 22.2233333587646&#34;
## [1] &#34;2018-03-14 00:00:00 TSLA 1000 @ 21.775333404541&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-06 00:00:00 TSLA 1000 @ 19.953332901001&#34;
## [1] &#34;2018-04-26 00:00:00 TSLA -1000 @ 19.0319995880127&#34;
## [1] &#34;2018-04-27 00:00:00 TSLA 1000 @ 19.6053333282471&#34;
## [1] &#34;2018-05-16 00:00:00 TSLA -1000 @ 19.0986671447754&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-06-25 00:00:00 TSLA -1000 @ 22.2006664276123&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-17 00:00:00 TSLA -1000 @ 20.3666667938232&#34;
## [1] &#34;2018-09-17 00:00:00 TSLA 1000 @ 19.6560001373291&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-18 00:00:00 TSLA 1000 @ 17.5939998626709&#34;
## [1] &#34;2018-11-14 00:00:00 TSLA -1000 @ 22.9333324432373&#34;
## [1] &#34;2018-12-07 00:00:00 TSLA 1000 @ 23.8646678924561&#34;
## [1] &#34;2018-12-10 00:00:00 TSLA -1000 @ 24.3433322906494&#34;
## [1] &#34;2018-12-11 00:00:00 TSLA 1000 @ 24.4506664276123&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-09 00:00:00 TSLA 1000 @ 22.5686664581299&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-04 00:00:00 TSLA 1000 @ 20.8593330383301&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-15 00:00:00 TSLA 1000 @ 18.3619995117188&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-28 00:00:00 TSLA 1000 @ 18.5746669769287&#34;
## [1] &#34;2019-04-15 00:00:00 TSLA -1000 @ 17.7586669921875&#34;
## [1] &#34;2019-04-18 00:00:00 TSLA 1000 @ 18.2173328399658&#34;
## [1] &#34;2019-04-23 00:00:00 TSLA -1000 @ 17.5933322906494&#34;
## [1] &#34;2019-05-07 00:00:00 TSLA 1000 @ 16.470666885376&#34;
## [1] &#34;2019-05-14 00:00:00 TSLA -1000 @ 15.4873332977295&#34;
## [1] &#34;2019-06-06 00:00:00 TSLA 1000 @ 13.7299995422363&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-09-03 00:00:00 TSLA 1000 @ 15.0006666183472&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-18 00:00:00 TSLA -1000 @ 23.3326663970947&#34;
## [1] &#34;2019-12-13 00:00:00 TSLA 1000 @ 23.8926677703857&#34;
## [1] &#34;2020-01-29 00:00:00 TSLA -1000 @ 38.732666015625&#34;
## [1] &#34;2020-01-31 00:00:00 TSLA 1000 @ 43.3713340759277&#34;
## [1] &#34;2020-02-13 00:00:00 TSLA -1000 @ 53.5999984741211&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-03-27 00:00:00 TSLA 1000 @ 34.2906684875488&#34;
## [1] &#34;2020-05-04 00:00:00 TSLA -1000 @ 50.7459983825684&#34;
## [1] &#34;2020-06-03 00:00:00 TSLA 1000 @ 58.8639984130859&#34;
## [1] &#34;2020-06-23 00:00:00 TSLA -1000 @ 66.7853317260742&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-23 00:00:00 TSLA -1000 @ 100.87133026123&#34;
## [1] &#34;2020-08-17 00:00:00 TSLA 1000 @ 122.375999450684&#34;
## [1] &#34;2020-09-04 00:00:00 TSLA -1000 @ 139.440002441406&#34;
## [1] &#34;2020-09-22 00:00:00 TSLA 1000 @ 141.410003662109&#34;
## [1] &#34;2020-09-23 00:00:00 TSLA -1000 @ 126.786666870117&#34;
## [1] &#34;2020-10-13 00:00:00 TSLA 1000 @ 148.883331298828&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-06 00:00:00 TSLA 1000 @ 143.316665649414&#34;
## [1] &#34;2020-11-11 00:00:00 TSLA -1000 @ 139.043334960938&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-14 00:00:00 TSLA -1000 @ 213.276672363281&#34;
## [1] &#34;2021-01-06 00:00:00 TSLA 1000 @ 251.99333190918&#34;
## [1] &#34;2021-01-20 00:00:00 TSLA -1000 @ 283.483337402344&#34;
## [1] &#34;2021-03-12 00:00:00 TSLA 1000 @ 231.24333190918&#34;
## [1] &#34;2021-03-29 00:00:00 TSLA -1000 @ 203.763336181641&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-28 00:00:00 TSLA -1000 @ 231.466659545898&#34;
## [1] &#34;2021-05-26 00:00:00 TSLA 1000 @ 206.376663208008&#34;
## [1] &#34;2021-07-08 00:00:00 TSLA -1000 @ 217.603332519531&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-17 00:00:00 TSLA -1000 @ 221.903335571289&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-15 00:00:00 TSLA -1000 @ 251.943328857422&#34;
## [1] &#34;2021-09-16 00:00:00 TSLA 1000 @ 252.330001831055&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-06 00:00:00 TSLA -1000 @ 260.916656494141&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-10 00:00:00 TSLA -1000 @ 355.983337402344&#34;
## [1] &#34;2021-12-27 00:00:00 TSLA 1000 @ 364.646667480469&#34;
## [1] &#34;2022-01-11 00:00:00 TSLA -1000 @ 354.799987792969&#34;
## [1] &#34;2022-01-13 00:00:00 TSLA 1000 @ 343.853332519531&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-08 00:00:00 TSLA 1000 @ 307.333343505859&#34;
## [1] &#34;2022-02-23 00:00:00 TSLA -1000 @ 254.679992675781&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-08 00:00:00 TSLA -1000 @ 341.829986572266&#34;
## [1] &#34;2022-05-31 00:00:00 TSLA 1000 @ 252.753326416016&#34;
## [1] &#34;2022-06-15 00:00:00 TSLA -1000 @ 233&#34;
## [1] &#34;2022-06-16 00:00:00 TSLA 1000 @ 213.100006103516&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-10 00:00:00 TSLA -1000 @ 294.356658935547&#34;
## [1] &#34;2022-09-13 00:00:00 TSLA 1000 @ 292.130004882812&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-25 00:00:00 TSLA 1000 @ 222.419998168945&#34;
## [1] &#34;2022-11-08 00:00:00 TSLA -1000 @ 191.300003051758&#34;
## [1] &#34;2022-11-28 00:00:00 TSLA 1000 @ 182.919998168945&#34;
## [1] &#34;2022-12-13 00:00:00 TSLA -1000 @ 160.949996948242&#34;
## [1] &#34;2023-01-10 00:00:00 TSLA 1000 @ 118.849998474121&#34;
## [1] &#34;2023-02-21 00:00:00 TSLA -1000 @ 197.369995117188&#34;
## [1] &#34;2023-03-22 00:00:00 TSLA 1000 @ 191.149993896484&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-08 00:00:00 TSLA 1000 @ 171.789993286133&#34;
## 测试参数组合 20/27: nFast=12, nSlow=22, nSig=11
## 策略环境已重置
## [1] &#34;2018-02-23 00:00:00 TSLA 1000 @ 23.4699993133545&#34;
## [1] &#34;2018-03-05 00:00:00 TSLA -1000 @ 22.2233333587646&#34;
## [1] &#34;2018-04-09 00:00:00 TSLA 1000 @ 19.3106670379639&#34;
## [1] &#34;2018-05-17 00:00:00 TSLA -1000 @ 18.9693336486816&#34;
## [1] &#34;2018-06-01 00:00:00 TSLA 1000 @ 19.4546661376953&#34;
## [1] &#34;2018-06-26 00:00:00 TSLA -1000 @ 22.7999992370605&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-20 00:00:00 TSLA -1000 @ 20.5626678466797&#34;
## [1] &#34;2018-09-18 00:00:00 TSLA 1000 @ 18.9973335266113&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-24 00:00:00 TSLA 1000 @ 19.2333335876465&#34;
## [1] &#34;2018-11-20 00:00:00 TSLA -1000 @ 23.1660003662109&#34;
## [1] &#34;2018-12-13 00:00:00 TSLA 1000 @ 25.1193332672119&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-10 00:00:00 TSLA 1000 @ 22.9979991912842&#34;
## [1] &#34;2019-01-23 00:00:00 TSLA -1000 @ 19.1726665496826&#34;
## [1] &#34;2019-02-05 00:00:00 TSLA 1000 @ 21.4233322143555&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-15 00:00:00 TSLA 1000 @ 18.3619995117188&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-29 00:00:00 TSLA 1000 @ 18.6573333740234&#34;
## [1] &#34;2019-04-16 00:00:00 TSLA -1000 @ 18.2240009307861&#34;
## [1] &#34;2019-04-17 00:00:00 TSLA 1000 @ 18.0820007324219&#34;
## [1] &#34;2019-04-23 00:00:00 TSLA -1000 @ 17.5933322906494&#34;
## [1] &#34;2019-05-08 00:00:00 TSLA 1000 @ 16.3226661682129&#34;
## [1] &#34;2019-05-13 00:00:00 TSLA -1000 @ 15.1339998245239&#34;
## [1] &#34;2019-06-07 00:00:00 TSLA 1000 @ 13.6333332061768&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-09-03 00:00:00 TSLA 1000 @ 15.0006666183472&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-19 00:00:00 TSLA -1000 @ 23.9680004119873&#34;
## [1] &#34;2019-12-17 00:00:00 TSLA 1000 @ 25.2660007476807&#34;
## [1] &#34;2020-01-30 00:00:00 TSLA -1000 @ 42.7206687927246&#34;
## [1] &#34;2020-01-31 00:00:00 TSLA 1000 @ 43.3713340759277&#34;
## [1] &#34;2020-02-14 00:00:00 TSLA -1000 @ 53.335334777832&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-03-31 00:00:00 TSLA 1000 @ 34.9333343505859&#34;
## [1] &#34;2020-05-07 00:00:00 TSLA -1000 @ 52.0026664733887&#34;
## [1] &#34;2020-06-04 00:00:00 TSLA 1000 @ 57.6253318786621&#34;
## [1] &#34;2020-06-05 00:00:00 TSLA -1000 @ 59.0439987182617&#34;
## [1] &#34;2020-06-09 00:00:00 TSLA 1000 @ 62.7113342285156&#34;
## [1] &#34;2020-06-23 00:00:00 TSLA -1000 @ 66.7853317260742&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-24 00:00:00 TSLA -1000 @ 94.466667175293&#34;
## [1] &#34;2020-08-18 00:00:00 TSLA 1000 @ 125.805999755859&#34;
## [1] &#34;2020-09-08 00:00:00 TSLA -1000 @ 110.069999694824&#34;
## [1] &#34;2020-10-14 00:00:00 TSLA 1000 @ 153.766662597656&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-09 00:00:00 TSLA 1000 @ 140.419998168945&#34;
## [1] &#34;2020-11-11 00:00:00 TSLA -1000 @ 139.043334960938&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-16 00:00:00 TSLA -1000 @ 207.589996337891&#34;
## [1] &#34;2021-01-07 00:00:00 TSLA 1000 @ 272.013336181641&#34;
## [1] &#34;2021-01-21 00:00:00 TSLA -1000 @ 281.663330078125&#34;
## [1] &#34;2021-03-15 00:00:00 TSLA 1000 @ 235.979995727539&#34;
## [1] &#34;2021-03-29 00:00:00 TSLA -1000 @ 203.763336181641&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-29 00:00:00 TSLA -1000 @ 225.66667175293&#34;
## [1] &#34;2021-05-27 00:00:00 TSLA 1000 @ 210.283340454102&#34;
## [1] &#34;2021-07-12 00:00:00 TSLA -1000 @ 228.566665649414&#34;
## [1] &#34;2021-07-13 00:00:00 TSLA 1000 @ 222.846664428711&#34;
## [1] &#34;2021-07-15 00:00:00 TSLA -1000 @ 216.866668701172&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-17 00:00:00 TSLA -1000 @ 221.903335571289&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-07 00:00:00 TSLA -1000 @ 264.536682128906&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-10 00:00:00 TSLA -1000 @ 355.983337402344&#34;
## [1] &#34;2021-12-28 00:00:00 TSLA 1000 @ 362.823333740234&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-10 00:00:00 TSLA 1000 @ 301.516662597656&#34;
## [1] &#34;2022-02-14 00:00:00 TSLA -1000 @ 291.920013427734&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-23 00:00:00 TSLA -1000 @ 254.679992675781&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-11 00:00:00 TSLA -1000 @ 325.309997558594&#34;
## [1] &#34;2022-05-31 00:00:00 TSLA 1000 @ 252.753326416016&#34;
## [1] &#34;2022-06-21 00:00:00 TSLA -1000 @ 237.036666870117&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-12 00:00:00 TSLA -1000 @ 300.029998779297&#34;
## [1] &#34;2022-09-13 00:00:00 TSLA 1000 @ 292.130004882812&#34;
## [1] &#34;2022-09-26 00:00:00 TSLA -1000 @ 276.010009765625&#34;
## [1] &#34;2022-10-26 00:00:00 TSLA 1000 @ 224.639999389648&#34;
## [1] &#34;2022-11-09 00:00:00 TSLA -1000 @ 177.589996337891&#34;
## [1] &#34;2022-11-29 00:00:00 TSLA 1000 @ 180.830001831055&#34;
## [1] &#34;2022-12-14 00:00:00 TSLA -1000 @ 156.800003051758&#34;
## [1] &#34;2023-01-11 00:00:00 TSLA 1000 @ 123.220001220703&#34;
## [1] &#34;2023-02-22 00:00:00 TSLA -1000 @ 200.860000610352&#34;
## [1] &#34;2023-03-27 00:00:00 TSLA 1000 @ 191.809997558594&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-09 00:00:00 TSLA 1000 @ 169.149993896484&#34;
## 测试参数组合 21/27: nFast=16, nSlow=22, nSig=11
## 策略环境已重置
## [1] &#34;2018-02-26 00:00:00 TSLA 1000 @ 23.8279991149902&#34;
## [1] &#34;2018-03-06 00:00:00 TSLA -1000 @ 21.8799991607666&#34;
## [1] &#34;2018-04-11 00:00:00 TSLA 1000 @ 20.0620002746582&#34;
## [1] &#34;2018-05-18 00:00:00 TSLA -1000 @ 18.4546661376953&#34;
## [1] &#34;2018-06-01 00:00:00 TSLA 1000 @ 19.4546661376953&#34;
## [1] &#34;2018-06-28 00:00:00 TSLA -1000 @ 23.3286666870117&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-20 00:00:00 TSLA -1000 @ 20.5626678466797&#34;
## [1] &#34;2018-09-20 00:00:00 TSLA 1000 @ 19.8886661529541&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-24 00:00:00 TSLA 1000 @ 19.2333335876465&#34;
## [1] &#34;2018-11-23 00:00:00 TSLA -1000 @ 21.7220001220703&#34;
## [1] &#34;2018-12-14 00:00:00 TSLA 1000 @ 24.3806667327881&#34;
## [1] &#34;2018-12-17 00:00:00 TSLA -1000 @ 23.2280006408691&#34;
## [1] &#34;2019-01-11 00:00:00 TSLA 1000 @ 23.1506671905518&#34;
## [1] &#34;2019-01-23 00:00:00 TSLA -1000 @ 19.1726665496826&#34;
## [1] &#34;2019-02-06 00:00:00 TSLA 1000 @ 21.1480007171631&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-29 00:00:00 TSLA 1000 @ 18.6573333740234&#34;
## [1] &#34;2019-04-24 00:00:00 TSLA -1000 @ 17.2439994812012&#34;
## [1] &#34;2019-06-07 00:00:00 TSLA 1000 @ 13.6333332061768&#34;
## [1] &#34;2019-07-29 00:00:00 TSLA -1000 @ 15.7180004119873&#34;
## [1] &#34;2019-09-04 00:00:00 TSLA 1000 @ 14.7119998931885&#34;
## [1] &#34;2019-09-26 00:00:00 TSLA -1000 @ 16.1706676483154&#34;
## [1] &#34;2019-09-30 00:00:00 TSLA 1000 @ 16.0580005645752&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-21 00:00:00 TSLA -1000 @ 23.6553325653076&#34;
## [1] &#34;2019-12-17 00:00:00 TSLA 1000 @ 25.2660007476807&#34;
## [1] &#34;2020-02-18 00:00:00 TSLA -1000 @ 57.2266654968262&#34;
## [1] &#34;2020-02-19 00:00:00 TSLA 1000 @ 61.1613311767578&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-04-01 00:00:00 TSLA 1000 @ 32.1040000915527&#34;
## [1] &#34;2020-04-03 00:00:00 TSLA -1000 @ 32.0006675720215&#34;
## [1] &#34;2020-04-06 00:00:00 TSLA 1000 @ 34.4160003662109&#34;
## [1] &#34;2020-05-14 00:00:00 TSLA -1000 @ 53.5553321838379&#34;
## [1] &#34;2020-06-09 00:00:00 TSLA 1000 @ 62.7113342285156&#34;
## [1] &#34;2020-06-24 00:00:00 TSLA -1000 @ 64.0566635131836&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-24 00:00:00 TSLA -1000 @ 94.466667175293&#34;
## [1] &#34;2020-08-18 00:00:00 TSLA 1000 @ 125.805999755859&#34;
## [1] &#34;2020-09-08 00:00:00 TSLA -1000 @ 110.069999694824&#34;
## [1] &#34;2020-10-15 00:00:00 TSLA 1000 @ 149.626663208008&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-17 00:00:00 TSLA -1000 @ 218.633331298828&#34;
## [1] &#34;2020-12-21 00:00:00 TSLA 1000 @ 216.619995117188&#34;
## [1] &#34;2020-12-22 00:00:00 TSLA -1000 @ 213.446670532227&#34;
## [1] &#34;2021-01-07 00:00:00 TSLA 1000 @ 272.013336181641&#34;
## [1] &#34;2021-01-22 00:00:00 TSLA -1000 @ 282.213317871094&#34;
## [1] &#34;2021-03-16 00:00:00 TSLA 1000 @ 225.626663208008&#34;
## [1] &#34;2021-03-29 00:00:00 TSLA -1000 @ 203.763336181641&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-30 00:00:00 TSLA -1000 @ 236.479995727539&#34;
## [1] &#34;2021-05-28 00:00:00 TSLA 1000 @ 208.406661987305&#34;
## [1] &#34;2021-07-15 00:00:00 TSLA -1000 @ 216.866668701172&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-18 00:00:00 TSLA -1000 @ 229.663330078125&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-07 00:00:00 TSLA -1000 @ 264.536682128906&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-11 00:00:00 TSLA -1000 @ 354.503326416016&#34;
## [1] &#34;2021-12-28 00:00:00 TSLA 1000 @ 362.823333740234&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-23 00:00:00 TSLA -1000 @ 254.679992675781&#34;
## [1] &#34;2022-03-03 00:00:00 TSLA 1000 @ 279.763336181641&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-12 00:00:00 TSLA -1000 @ 328.983337402344&#34;
## [1] &#34;2022-06-01 00:00:00 TSLA 1000 @ 246.789993286133&#34;
## [1] &#34;2022-08-19 00:00:00 TSLA -1000 @ 296.666656494141&#34;
## [1] &#34;2022-09-15 00:00:00 TSLA 1000 @ 303.75&#34;
## [1] &#34;2022-09-26 00:00:00 TSLA -1000 @ 276.010009765625&#34;
## [1] &#34;2022-10-27 00:00:00 TSLA 1000 @ 225.089996337891&#34;
## [1] &#34;2022-11-09 00:00:00 TSLA -1000 @ 177.589996337891&#34;
## [1] &#34;2022-11-29 00:00:00 TSLA 1000 @ 180.830001831055&#34;
## [1] &#34;2022-12-14 00:00:00 TSLA -1000 @ 156.800003051758&#34;
## [1] &#34;2023-01-12 00:00:00 TSLA 1000 @ 123.559997558594&#34;
## [1] &#34;2023-02-24 00:00:00 TSLA -1000 @ 196.880004882812&#34;
## [1] &#34;2023-03-31 00:00:00 TSLA 1000 @ 207.460006713867&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-09 00:00:00 TSLA 1000 @ 169.149993896484&#34;
## 测试参数组合 22/27: nFast=8, nSlow=26, nSig=11
## 策略环境已重置
## [1] &#34;2018-03-14 00:00:00 TSLA 1000 @ 21.775333404541&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-09 00:00:00 TSLA 1000 @ 19.3106670379639&#34;
## [1] &#34;2018-04-26 00:00:00 TSLA -1000 @ 19.0319995880127&#34;
## [1] &#34;2018-04-27 00:00:00 TSLA 1000 @ 19.6053333282471&#34;
## [1] &#34;2018-05-16 00:00:00 TSLA -1000 @ 19.0986671447754&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-06-26 00:00:00 TSLA -1000 @ 22.7999992370605&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-17 00:00:00 TSLA -1000 @ 20.3666667938232&#34;
## [1] &#34;2018-09-17 00:00:00 TSLA 1000 @ 19.6560001373291&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-18 00:00:00 TSLA 1000 @ 17.5939998626709&#34;
## [1] &#34;2018-11-14 00:00:00 TSLA -1000 @ 22.9333324432373&#34;
## [1] &#34;2018-12-07 00:00:00 TSLA 1000 @ 23.8646678924561&#34;
## [1] &#34;2018-12-10 00:00:00 TSLA -1000 @ 24.3433322906494&#34;
## [1] &#34;2018-12-11 00:00:00 TSLA 1000 @ 24.4506664276123&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-09 00:00:00 TSLA 1000 @ 22.5686664581299&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-05 00:00:00 TSLA 1000 @ 21.4233322143555&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-15 00:00:00 TSLA 1000 @ 18.3619995117188&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-29 00:00:00 TSLA 1000 @ 18.6573333740234&#34;
## [1] &#34;2019-04-15 00:00:00 TSLA -1000 @ 17.7586669921875&#34;
## [1] &#34;2019-04-17 00:00:00 TSLA 1000 @ 18.0820007324219&#34;
## [1] &#34;2019-04-23 00:00:00 TSLA -1000 @ 17.5933322906494&#34;
## [1] &#34;2019-05-07 00:00:00 TSLA 1000 @ 16.470666885376&#34;
## [1] &#34;2019-05-14 00:00:00 TSLA -1000 @ 15.4873332977295&#34;
## [1] &#34;2019-06-06 00:00:00 TSLA 1000 @ 13.7299995422363&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-09-03 00:00:00 TSLA 1000 @ 15.0006666183472&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-19 00:00:00 TSLA -1000 @ 23.9680004119873&#34;
## [1] &#34;2019-12-16 00:00:00 TSLA 1000 @ 25.4333324432373&#34;
## [1] &#34;2020-01-29 00:00:00 TSLA -1000 @ 38.732666015625&#34;
## [1] &#34;2020-01-31 00:00:00 TSLA 1000 @ 43.3713340759277&#34;
## [1] &#34;2020-02-13 00:00:00 TSLA -1000 @ 53.5999984741211&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-03-27 00:00:00 TSLA 1000 @ 34.2906684875488&#34;
## [1] &#34;2020-05-05 00:00:00 TSLA -1000 @ 51.2140007019043&#34;
## [1] &#34;2020-06-03 00:00:00 TSLA 1000 @ 58.8639984130859&#34;
## [1] &#34;2020-06-23 00:00:00 TSLA -1000 @ 66.7853317260742&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-23 00:00:00 TSLA -1000 @ 100.87133026123&#34;
## [1] &#34;2020-08-17 00:00:00 TSLA 1000 @ 122.375999450684&#34;
## [1] &#34;2020-09-04 00:00:00 TSLA -1000 @ 139.440002441406&#34;
## [1] &#34;2020-10-14 00:00:00 TSLA 1000 @ 153.766662597656&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-06 00:00:00 TSLA 1000 @ 143.316665649414&#34;
## [1] &#34;2020-11-11 00:00:00 TSLA -1000 @ 139.043334960938&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-14 00:00:00 TSLA -1000 @ 213.276672363281&#34;
## [1] &#34;2021-01-06 00:00:00 TSLA 1000 @ 251.99333190918&#34;
## [1] &#34;2021-01-20 00:00:00 TSLA -1000 @ 283.483337402344&#34;
## [1] &#34;2021-03-12 00:00:00 TSLA 1000 @ 231.24333190918&#34;
## [1] &#34;2021-03-29 00:00:00 TSLA -1000 @ 203.763336181641&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-29 00:00:00 TSLA -1000 @ 225.66667175293&#34;
## [1] &#34;2021-05-26 00:00:00 TSLA 1000 @ 206.376663208008&#34;
## [1] &#34;2021-07-09 00:00:00 TSLA -1000 @ 218.983337402344&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-17 00:00:00 TSLA -1000 @ 221.903335571289&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-06 00:00:00 TSLA -1000 @ 260.916656494141&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-10 00:00:00 TSLA -1000 @ 355.983337402344&#34;
## [1] &#34;2021-12-27 00:00:00 TSLA 1000 @ 364.646667480469&#34;
## [1] &#34;2022-01-11 00:00:00 TSLA -1000 @ 354.799987792969&#34;
## [1] &#34;2022-01-13 00:00:00 TSLA 1000 @ 343.853332519531&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-09 00:00:00 TSLA 1000 @ 310.666656494141&#34;
## [1] &#34;2022-02-15 00:00:00 TSLA -1000 @ 307.476654052734&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-23 00:00:00 TSLA -1000 @ 254.679992675781&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-11 00:00:00 TSLA -1000 @ 325.309997558594&#34;
## [1] &#34;2022-05-31 00:00:00 TSLA 1000 @ 252.753326416016&#34;
## [1] &#34;2022-06-15 00:00:00 TSLA -1000 @ 233&#34;
## [1] &#34;2022-06-16 00:00:00 TSLA 1000 @ 213.100006103516&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-10 00:00:00 TSLA -1000 @ 294.356658935547&#34;
## [1] &#34;2022-09-13 00:00:00 TSLA 1000 @ 292.130004882812&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-26 00:00:00 TSLA 1000 @ 224.639999389648&#34;
## [1] &#34;2022-11-08 00:00:00 TSLA -1000 @ 191.300003051758&#34;
## [1] &#34;2022-11-28 00:00:00 TSLA 1000 @ 182.919998168945&#34;
## [1] &#34;2022-12-13 00:00:00 TSLA -1000 @ 160.949996948242&#34;
## [1] &#34;2023-01-11 00:00:00 TSLA 1000 @ 123.220001220703&#34;
## [1] &#34;2023-02-22 00:00:00 TSLA -1000 @ 200.860000610352&#34;
## [1] &#34;2023-03-23 00:00:00 TSLA 1000 @ 192.220001220703&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-08 00:00:00 TSLA 1000 @ 171.789993286133&#34;
## 测试参数组合 23/27: nFast=12, nSlow=26, nSig=11
## 策略环境已重置
## [1] &#34;2018-03-14 00:00:00 TSLA 1000 @ 21.775333404541&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-10 00:00:00 TSLA 1000 @ 20.3133335113525&#34;
## [1] &#34;2018-05-17 00:00:00 TSLA -1000 @ 18.9693336486816&#34;
## [1] &#34;2018-06-01 00:00:00 TSLA 1000 @ 19.4546661376953&#34;
## [1] &#34;2018-06-27 00:00:00 TSLA -1000 @ 22.966667175293&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-20 00:00:00 TSLA -1000 @ 20.5626678466797&#34;
## [1] &#34;2018-09-20 00:00:00 TSLA 1000 @ 19.8886661529541&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-24 00:00:00 TSLA 1000 @ 19.2333335876465&#34;
## [1] &#34;2018-11-21 00:00:00 TSLA -1000 @ 22.5459995269775&#34;
## [1] &#34;2018-12-12 00:00:00 TSLA 1000 @ 24.4400005340576&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-10 00:00:00 TSLA 1000 @ 22.9979991912842&#34;
## [1] &#34;2019-01-23 00:00:00 TSLA -1000 @ 19.1726665496826&#34;
## [1] &#34;2019-02-06 00:00:00 TSLA 1000 @ 21.1480007171631&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-15 00:00:00 TSLA 1000 @ 18.3619995117188&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-29 00:00:00 TSLA 1000 @ 18.6573333740234&#34;
## [1] &#34;2019-04-16 00:00:00 TSLA -1000 @ 18.2240009307861&#34;
## [1] &#34;2019-04-17 00:00:00 TSLA 1000 @ 18.0820007324219&#34;
## [1] &#34;2019-04-24 00:00:00 TSLA -1000 @ 17.2439994812012&#34;
## [1] &#34;2019-06-07 00:00:00 TSLA 1000 @ 13.6333332061768&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-09-04 00:00:00 TSLA 1000 @ 14.7119998931885&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-21 00:00:00 TSLA -1000 @ 23.6553325653076&#34;
## [1] &#34;2019-12-17 00:00:00 TSLA 1000 @ 25.2660007476807&#34;
## [1] &#34;2020-02-18 00:00:00 TSLA -1000 @ 57.2266654968262&#34;
## [1] &#34;2020-02-19 00:00:00 TSLA 1000 @ 61.1613311767578&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-04-01 00:00:00 TSLA 1000 @ 32.1040000915527&#34;
## [1] &#34;2020-05-14 00:00:00 TSLA -1000 @ 53.5553321838379&#34;
## [1] &#34;2020-06-04 00:00:00 TSLA 1000 @ 57.6253318786621&#34;
## [1] &#34;2020-06-05 00:00:00 TSLA -1000 @ 59.0439987182617&#34;
## [1] &#34;2020-06-09 00:00:00 TSLA 1000 @ 62.7113342285156&#34;
## [1] &#34;2020-06-24 00:00:00 TSLA -1000 @ 64.0566635131836&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-24 00:00:00 TSLA -1000 @ 94.466667175293&#34;
## [1] &#34;2020-08-18 00:00:00 TSLA 1000 @ 125.805999755859&#34;
## [1] &#34;2020-09-08 00:00:00 TSLA -1000 @ 110.069999694824&#34;
## [1] &#34;2020-10-15 00:00:00 TSLA 1000 @ 149.626663208008&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-17 00:00:00 TSLA -1000 @ 218.633331298828&#34;
## [1] &#34;2020-12-21 00:00:00 TSLA 1000 @ 216.619995117188&#34;
## [1] &#34;2020-12-22 00:00:00 TSLA -1000 @ 213.446670532227&#34;
## [1] &#34;2021-01-06 00:00:00 TSLA 1000 @ 251.99333190918&#34;
## [1] &#34;2021-01-21 00:00:00 TSLA -1000 @ 281.663330078125&#34;
## [1] &#34;2021-03-16 00:00:00 TSLA 1000 @ 225.626663208008&#34;
## [1] &#34;2021-03-29 00:00:00 TSLA -1000 @ 203.763336181641&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-30 00:00:00 TSLA -1000 @ 236.479995727539&#34;
## [1] &#34;2021-05-27 00:00:00 TSLA 1000 @ 210.283340454102&#34;
## [1] &#34;2021-07-15 00:00:00 TSLA -1000 @ 216.866668701172&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-18 00:00:00 TSLA -1000 @ 229.663330078125&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-07 00:00:00 TSLA -1000 @ 264.536682128906&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-11 00:00:00 TSLA -1000 @ 354.503326416016&#34;
## [1] &#34;2021-12-28 00:00:00 TSLA 1000 @ 362.823333740234&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-10 00:00:00 TSLA 1000 @ 301.516662597656&#34;
## [1] &#34;2022-02-14 00:00:00 TSLA -1000 @ 291.920013427734&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-23 00:00:00 TSLA -1000 @ 254.679992675781&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-12 00:00:00 TSLA -1000 @ 328.983337402344&#34;
## [1] &#34;2022-06-01 00:00:00 TSLA 1000 @ 246.789993286133&#34;
## [1] &#34;2022-06-21 00:00:00 TSLA -1000 @ 237.036666870117&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-12 00:00:00 TSLA -1000 @ 300.029998779297&#34;
## [1] &#34;2022-08-16 00:00:00 TSLA 1000 @ 306.563323974609&#34;
## [1] &#34;2022-08-19 00:00:00 TSLA -1000 @ 296.666656494141&#34;
## [1] &#34;2022-09-15 00:00:00 TSLA 1000 @ 303.75&#34;
## [1] &#34;2022-09-26 00:00:00 TSLA -1000 @ 276.010009765625&#34;
## [1] &#34;2022-10-27 00:00:00 TSLA 1000 @ 225.089996337891&#34;
## [1] &#34;2022-11-09 00:00:00 TSLA -1000 @ 177.589996337891&#34;
## [1] &#34;2022-11-29 00:00:00 TSLA 1000 @ 180.830001831055&#34;
## [1] &#34;2022-12-14 00:00:00 TSLA -1000 @ 156.800003051758&#34;
## [1] &#34;2023-01-12 00:00:00 TSLA 1000 @ 123.559997558594&#34;
## [1] &#34;2023-02-23 00:00:00 TSLA -1000 @ 202.070007324219&#34;
## [1] &#34;2023-03-30 00:00:00 TSLA 1000 @ 195.279998779297&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-09 00:00:00 TSLA 1000 @ 169.149993896484&#34;
## 测试参数组合 24/27: nFast=16, nSlow=26, nSig=11
## 策略环境已重置
## [1] &#34;2018-03-14 00:00:00 TSLA 1000 @ 21.775333404541&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-11 00:00:00 TSLA 1000 @ 20.0620002746582&#34;
## [1] &#34;2018-05-18 00:00:00 TSLA -1000 @ 18.4546661376953&#34;
## [1] &#34;2018-06-01 00:00:00 TSLA 1000 @ 19.4546661376953&#34;
## [1] &#34;2018-07-02 00:00:00 TSLA -1000 @ 22.3379993438721&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-20 00:00:00 TSLA -1000 @ 20.5626678466797&#34;
## [1] &#34;2018-09-20 00:00:00 TSLA 1000 @ 19.8886661529541&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-24 00:00:00 TSLA 1000 @ 19.2333335876465&#34;
## [1] &#34;2018-11-23 00:00:00 TSLA -1000 @ 21.7220001220703&#34;
## [1] &#34;2018-12-14 00:00:00 TSLA 1000 @ 24.3806667327881&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-11 00:00:00 TSLA 1000 @ 23.1506671905518&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-06 00:00:00 TSLA 1000 @ 21.1480007171631&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-29 00:00:00 TSLA 1000 @ 18.6573333740234&#34;
## [1] &#34;2019-04-24 00:00:00 TSLA -1000 @ 17.2439994812012&#34;
## [1] &#34;2019-06-07 00:00:00 TSLA 1000 @ 13.6333332061768&#34;
## [1] &#34;2019-07-29 00:00:00 TSLA -1000 @ 15.7180004119873&#34;
## [1] &#34;2019-09-06 00:00:00 TSLA 1000 @ 15.1633329391479&#34;
## [1] &#34;2019-09-26 00:00:00 TSLA -1000 @ 16.1706676483154&#34;
## [1] &#34;2019-09-27 00:00:00 TSLA 1000 @ 16.1420001983643&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-21 00:00:00 TSLA -1000 @ 23.6553325653076&#34;
## [1] &#34;2019-12-17 00:00:00 TSLA 1000 @ 25.2660007476807&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-04-07 00:00:00 TSLA 1000 @ 36.3633346557617&#34;
## [1] &#34;2020-05-15 00:00:00 TSLA -1000 @ 53.2779998779297&#34;
## [1] &#34;2020-06-09 00:00:00 TSLA 1000 @ 62.7113342285156&#34;
## [1] &#34;2020-06-24 00:00:00 TSLA -1000 @ 64.0566635131836&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-27 00:00:00 TSLA -1000 @ 102.639999389648&#34;
## [1] &#34;2020-08-18 00:00:00 TSLA 1000 @ 125.805999755859&#34;
## [1] &#34;2020-09-08 00:00:00 TSLA -1000 @ 110.069999694824&#34;
## [1] &#34;2020-10-15 00:00:00 TSLA 1000 @ 149.626663208008&#34;
## [1] &#34;2020-10-19 00:00:00 TSLA -1000 @ 143.610000610352&#34;
## [1] &#34;2020-11-19 00:00:00 TSLA 1000 @ 166.42333984375&#34;
## [1] &#34;2020-12-23 00:00:00 TSLA -1000 @ 215.32666015625&#34;
## [1] &#34;2021-01-07 00:00:00 TSLA 1000 @ 272.013336181641&#34;
## [1] &#34;2021-01-22 00:00:00 TSLA -1000 @ 282.213317871094&#34;
## [1] &#34;2021-03-17 00:00:00 TSLA 1000 @ 233.936660766602&#34;
## [1] &#34;2021-03-29 00:00:00 TSLA -1000 @ 203.763336181641&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-30 00:00:00 TSLA -1000 @ 236.479995727539&#34;
## [1] &#34;2021-05-28 00:00:00 TSLA 1000 @ 208.406661987305&#34;
## [1] &#34;2021-07-16 00:00:00 TSLA -1000 @ 214.740005493164&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-18 00:00:00 TSLA -1000 @ 229.663330078125&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-11 00:00:00 TSLA -1000 @ 354.503326416016&#34;
## [1] &#34;2021-12-28 00:00:00 TSLA 1000 @ 362.823333740234&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-17 00:00:00 TSLA 1000 @ 292.116668701172&#34;
## [1] &#34;2022-02-22 00:00:00 TSLA -1000 @ 273.843322753906&#34;
## [1] &#34;2022-03-03 00:00:00 TSLA 1000 @ 279.763336181641&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-12 00:00:00 TSLA -1000 @ 328.983337402344&#34;
## [1] &#34;2022-06-01 00:00:00 TSLA 1000 @ 246.789993286133&#34;
## [1] &#34;2022-08-22 00:00:00 TSLA -1000 @ 289.913330078125&#34;
## [1] &#34;2022-09-16 00:00:00 TSLA 1000 @ 303.350006103516&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-28 00:00:00 TSLA 1000 @ 228.520004272461&#34;
## [1] &#34;2022-11-09 00:00:00 TSLA -1000 @ 177.589996337891&#34;
## [1] &#34;2022-11-29 00:00:00 TSLA 1000 @ 180.830001831055&#34;
## [1] &#34;2022-12-14 00:00:00 TSLA -1000 @ 156.800003051758&#34;
## [1] &#34;2023-01-12 00:00:00 TSLA 1000 @ 123.559997558594&#34;
## [1] &#34;2023-02-27 00:00:00 TSLA -1000 @ 207.630004882812&#34;
## [1] &#34;2023-04-03 00:00:00 TSLA 1000 @ 194.770004272461&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-10 00:00:00 TSLA 1000 @ 168.539993286133&#34;
## 测试参数组合 25/27: nFast=8, nSlow=30, nSig=11
## 策略环境已重置
## [1] &#34;2018-03-13 00:00:00 TSLA 1000 @ 22.7893333435059&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-09 00:00:00 TSLA 1000 @ 19.3106670379639&#34;
## [1] &#34;2018-05-16 00:00:00 TSLA -1000 @ 19.0986671447754&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-06-26 00:00:00 TSLA -1000 @ 22.7999992370605&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-20 00:00:00 TSLA -1000 @ 20.5626678466797&#34;
## [1] &#34;2018-09-18 00:00:00 TSLA 1000 @ 18.9973335266113&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-18 00:00:00 TSLA 1000 @ 17.5939998626709&#34;
## [1] &#34;2018-11-15 00:00:00 TSLA -1000 @ 23.2293338775635&#34;
## [1] &#34;2018-11-19 00:00:00 TSLA 1000 @ 23.5646667480469&#34;
## [1] &#34;2018-11-20 00:00:00 TSLA -1000 @ 23.1660003662109&#34;
## [1] &#34;2018-12-07 00:00:00 TSLA 1000 @ 23.8646678924561&#34;
## [1] &#34;2018-12-10 00:00:00 TSLA -1000 @ 24.3433322906494&#34;
## [1] &#34;2018-12-11 00:00:00 TSLA 1000 @ 24.4506664276123&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-09 00:00:00 TSLA 1000 @ 22.5686664581299&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-05 00:00:00 TSLA 1000 @ 21.4233322143555&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-15 00:00:00 TSLA 1000 @ 18.3619995117188&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-29 00:00:00 TSLA 1000 @ 18.6573333740234&#34;
## [1] &#34;2019-04-15 00:00:00 TSLA -1000 @ 17.7586669921875&#34;
## [1] &#34;2019-04-17 00:00:00 TSLA 1000 @ 18.0820007324219&#34;
## [1] &#34;2019-04-23 00:00:00 TSLA -1000 @ 17.5933322906494&#34;
## [1] &#34;2019-05-07 00:00:00 TSLA 1000 @ 16.470666885376&#34;
## [1] &#34;2019-05-13 00:00:00 TSLA -1000 @ 15.1339998245239&#34;
## [1] &#34;2019-06-06 00:00:00 TSLA 1000 @ 13.7299995422363&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-09-03 00:00:00 TSLA 1000 @ 15.0006666183472&#34;
## [1] &#34;2019-09-25 00:00:00 TSLA -1000 @ 15.2466669082642&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-19 00:00:00 TSLA -1000 @ 23.9680004119873&#34;
## [1] &#34;2019-12-16 00:00:00 TSLA 1000 @ 25.4333324432373&#34;
## [1] &#34;2020-01-29 00:00:00 TSLA -1000 @ 38.732666015625&#34;
## [1] &#34;2020-01-31 00:00:00 TSLA 1000 @ 43.3713340759277&#34;
## [1] &#34;2020-02-13 00:00:00 TSLA -1000 @ 53.5999984741211&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-03-30 00:00:00 TSLA 1000 @ 33.4753341674805&#34;
## [1] &#34;2020-05-06 00:00:00 TSLA -1000 @ 52.1720008850098&#34;
## [1] &#34;2020-05-11 00:00:00 TSLA 1000 @ 54.0859985351562&#34;
## [1] &#34;2020-05-13 00:00:00 TSLA -1000 @ 52.7306671142578&#34;
## [1] &#34;2020-06-03 00:00:00 TSLA 1000 @ 58.8639984130859&#34;
## [1] &#34;2020-06-23 00:00:00 TSLA -1000 @ 66.7853317260742&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-24 00:00:00 TSLA -1000 @ 94.466667175293&#34;
## [1] &#34;2020-08-18 00:00:00 TSLA 1000 @ 125.805999755859&#34;
## [1] &#34;2020-09-04 00:00:00 TSLA -1000 @ 139.440002441406&#34;
## [1] &#34;2020-10-14 00:00:00 TSLA 1000 @ 153.766662597656&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-09 00:00:00 TSLA 1000 @ 140.419998168945&#34;
## [1] &#34;2020-11-11 00:00:00 TSLA -1000 @ 139.043334960938&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-16 00:00:00 TSLA -1000 @ 207.589996337891&#34;
## [1] &#34;2020-12-21 00:00:00 TSLA 1000 @ 216.619995117188&#34;
## [1] &#34;2020-12-22 00:00:00 TSLA -1000 @ 213.446670532227&#34;
## [1] &#34;2021-01-06 00:00:00 TSLA 1000 @ 251.99333190918&#34;
## [1] &#34;2021-01-21 00:00:00 TSLA -1000 @ 281.663330078125&#34;
## [1] &#34;2021-03-15 00:00:00 TSLA 1000 @ 235.979995727539&#34;
## [1] &#34;2021-03-29 00:00:00 TSLA -1000 @ 203.763336181641&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-29 00:00:00 TSLA -1000 @ 225.66667175293&#34;
## [1] &#34;2021-05-27 00:00:00 TSLA 1000 @ 210.283340454102&#34;
## [1] &#34;2021-07-09 00:00:00 TSLA -1000 @ 218.983337402344&#34;
## [1] &#34;2021-07-13 00:00:00 TSLA 1000 @ 222.846664428711&#34;
## [1] &#34;2021-07-15 00:00:00 TSLA -1000 @ 216.866668701172&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-17 00:00:00 TSLA -1000 @ 221.903335571289&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-06 00:00:00 TSLA -1000 @ 260.916656494141&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-10 00:00:00 TSLA -1000 @ 355.983337402344&#34;
## [1] &#34;2021-12-27 00:00:00 TSLA 1000 @ 364.646667480469&#34;
## [1] &#34;2022-01-11 00:00:00 TSLA -1000 @ 354.799987792969&#34;
## [1] &#34;2022-01-13 00:00:00 TSLA 1000 @ 343.853332519531&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-09 00:00:00 TSLA 1000 @ 310.666656494141&#34;
## [1] &#34;2022-02-14 00:00:00 TSLA -1000 @ 291.920013427734&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-23 00:00:00 TSLA -1000 @ 254.679992675781&#34;
## [1] &#34;2022-03-02 00:00:00 TSLA 1000 @ 293.296661376953&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-11 00:00:00 TSLA -1000 @ 325.309997558594&#34;
## [1] &#34;2022-05-31 00:00:00 TSLA 1000 @ 252.753326416016&#34;
## [1] &#34;2022-06-15 00:00:00 TSLA -1000 @ 233&#34;
## [1] &#34;2022-06-16 00:00:00 TSLA 1000 @ 213.100006103516&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-11 00:00:00 TSLA -1000 @ 286.630004882812&#34;
## [1] &#34;2022-08-16 00:00:00 TSLA 1000 @ 306.563323974609&#34;
## [1] &#34;2022-08-18 00:00:00 TSLA -1000 @ 302.869995117188&#34;
## [1] &#34;2022-09-13 00:00:00 TSLA 1000 @ 292.130004882812&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-26 00:00:00 TSLA 1000 @ 224.639999389648&#34;
## [1] &#34;2022-11-08 00:00:00 TSLA -1000 @ 191.300003051758&#34;
## [1] &#34;2022-11-29 00:00:00 TSLA 1000 @ 180.830001831055&#34;
## [1] &#34;2022-12-13 00:00:00 TSLA -1000 @ 160.949996948242&#34;
## [1] &#34;2023-01-11 00:00:00 TSLA 1000 @ 123.220001220703&#34;
## [1] &#34;2023-02-22 00:00:00 TSLA -1000 @ 200.860000610352&#34;
## [1] &#34;2023-03-24 00:00:00 TSLA 1000 @ 190.410003662109&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-08 00:00:00 TSLA 1000 @ 171.789993286133&#34;
## 测试参数组合 26/27: nFast=12, nSlow=30, nSig=11
## 策略环境已重置
## [1] &#34;2018-03-13 00:00:00 TSLA 1000 @ 22.7893333435059&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-10 00:00:00 TSLA 1000 @ 20.3133335113525&#34;
## [1] &#34;2018-05-18 00:00:00 TSLA -1000 @ 18.4546661376953&#34;
## [1] &#34;2018-06-01 00:00:00 TSLA 1000 @ 19.4546661376953&#34;
## [1] &#34;2018-06-28 00:00:00 TSLA -1000 @ 23.3286666870117&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-20 00:00:00 TSLA -1000 @ 20.5626678466797&#34;
## [1] &#34;2018-09-20 00:00:00 TSLA 1000 @ 19.8886661529541&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-24 00:00:00 TSLA 1000 @ 19.2333335876465&#34;
## [1] &#34;2018-11-23 00:00:00 TSLA -1000 @ 21.7220001220703&#34;
## [1] &#34;2018-12-12 00:00:00 TSLA 1000 @ 24.4400005340576&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-11 00:00:00 TSLA 1000 @ 23.1506671905518&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-06 00:00:00 TSLA 1000 @ 21.1480007171631&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-29 00:00:00 TSLA 1000 @ 18.6573333740234&#34;
## [1] &#34;2019-04-24 00:00:00 TSLA -1000 @ 17.2439994812012&#34;
## [1] &#34;2019-06-07 00:00:00 TSLA 1000 @ 13.6333332061768&#34;
## [1] &#34;2019-07-29 00:00:00 TSLA -1000 @ 15.7180004119873&#34;
## [1] &#34;2019-09-04 00:00:00 TSLA 1000 @ 14.7119998931885&#34;
## [1] &#34;2019-09-26 00:00:00 TSLA -1000 @ 16.1706676483154&#34;
## [1] &#34;2019-09-30 00:00:00 TSLA 1000 @ 16.0580005645752&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-21 00:00:00 TSLA -1000 @ 23.6553325653076&#34;
## [1] &#34;2019-12-17 00:00:00 TSLA 1000 @ 25.2660007476807&#34;
## [1] &#34;2020-02-18 00:00:00 TSLA -1000 @ 57.2266654968262&#34;
## [1] &#34;2020-02-19 00:00:00 TSLA 1000 @ 61.1613311767578&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-04-01 00:00:00 TSLA 1000 @ 32.1040000915527&#34;
## [1] &#34;2020-04-03 00:00:00 TSLA -1000 @ 32.0006675720215&#34;
## [1] &#34;2020-04-07 00:00:00 TSLA 1000 @ 36.3633346557617&#34;
## [1] &#34;2020-05-14 00:00:00 TSLA -1000 @ 53.5553321838379&#34;
## [1] &#34;2020-06-04 00:00:00 TSLA 1000 @ 57.6253318786621&#34;
## [1] &#34;2020-06-05 00:00:00 TSLA -1000 @ 59.0439987182617&#34;
## [1] &#34;2020-06-09 00:00:00 TSLA 1000 @ 62.7113342285156&#34;
## [1] &#34;2020-06-24 00:00:00 TSLA -1000 @ 64.0566635131836&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-24 00:00:00 TSLA -1000 @ 94.466667175293&#34;
## [1] &#34;2020-08-18 00:00:00 TSLA 1000 @ 125.805999755859&#34;
## [1] &#34;2020-09-08 00:00:00 TSLA -1000 @ 110.069999694824&#34;
## [1] &#34;2020-10-15 00:00:00 TSLA 1000 @ 149.626663208008&#34;
## [1] &#34;2020-10-19 00:00:00 TSLA -1000 @ 143.610000610352&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-17 00:00:00 TSLA -1000 @ 218.633331298828&#34;
## [1] &#34;2020-12-21 00:00:00 TSLA 1000 @ 216.619995117188&#34;
## [1] &#34;2020-12-22 00:00:00 TSLA -1000 @ 213.446670532227&#34;
## [1] &#34;2021-01-06 00:00:00 TSLA 1000 @ 251.99333190918&#34;
## [1] &#34;2021-01-22 00:00:00 TSLA -1000 @ 282.213317871094&#34;
## [1] &#34;2021-03-16 00:00:00 TSLA 1000 @ 225.626663208008&#34;
## [1] &#34;2021-03-29 00:00:00 TSLA -1000 @ 203.763336181641&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-30 00:00:00 TSLA -1000 @ 236.479995727539&#34;
## [1] &#34;2021-05-28 00:00:00 TSLA 1000 @ 208.406661987305&#34;
## [1] &#34;2021-07-16 00:00:00 TSLA -1000 @ 214.740005493164&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-18 00:00:00 TSLA -1000 @ 229.663330078125&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-07 00:00:00 TSLA -1000 @ 264.536682128906&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-11 00:00:00 TSLA -1000 @ 354.503326416016&#34;
## [1] &#34;2021-12-28 00:00:00 TSLA 1000 @ 362.823333740234&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-16 00:00:00 TSLA 1000 @ 307.796661376953&#34;
## [1] &#34;2022-02-22 00:00:00 TSLA -1000 @ 273.843322753906&#34;
## [1] &#34;2022-03-03 00:00:00 TSLA 1000 @ 279.763336181641&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-12 00:00:00 TSLA -1000 @ 328.983337402344&#34;
## [1] &#34;2022-06-01 00:00:00 TSLA 1000 @ 246.789993286133&#34;
## [1] &#34;2022-06-21 00:00:00 TSLA -1000 @ 237.036666870117&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-22 00:00:00 TSLA -1000 @ 289.913330078125&#34;
## [1] &#34;2022-09-15 00:00:00 TSLA 1000 @ 303.75&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-27 00:00:00 TSLA 1000 @ 225.089996337891&#34;
## [1] &#34;2022-11-09 00:00:00 TSLA -1000 @ 177.589996337891&#34;
## [1] &#34;2022-11-29 00:00:00 TSLA 1000 @ 180.830001831055&#34;
## [1] &#34;2022-12-14 00:00:00 TSLA -1000 @ 156.800003051758&#34;
## [1] &#34;2023-01-12 00:00:00 TSLA 1000 @ 123.559997558594&#34;
## [1] &#34;2023-02-24 00:00:00 TSLA -1000 @ 196.880004882812&#34;
## [1] &#34;2023-03-30 00:00:00 TSLA 1000 @ 195.279998779297&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-09 00:00:00 TSLA 1000 @ 169.149993896484&#34;
## 测试参数组合 27/27: nFast=16, nSlow=30, nSig=11
## 策略环境已重置
## [1] &#34;2018-03-13 00:00:00 TSLA 1000 @ 22.7893333435059&#34;
## [1] &#34;2018-03-16 00:00:00 TSLA -1000 @ 21.4233322143555&#34;
## [1] &#34;2018-04-11 00:00:00 TSLA 1000 @ 20.0620002746582&#34;
## [1] &#34;2018-05-21 00:00:00 TSLA -1000 @ 18.9659996032715&#34;
## [1] &#34;2018-06-01 00:00:00 TSLA 1000 @ 19.4546661376953&#34;
## [1] &#34;2018-07-02 00:00:00 TSLA -1000 @ 22.3379993438721&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-20 00:00:00 TSLA -1000 @ 20.5626678466797&#34;
## [1] &#34;2018-09-21 00:00:00 TSLA 1000 @ 19.9400005340576&#34;
## [1] &#34;2018-10-08 00:00:00 TSLA -1000 @ 16.7040004730225&#34;
## [1] &#34;2018-10-24 00:00:00 TSLA 1000 @ 19.2333335876465&#34;
## [1] &#34;2018-11-26 00:00:00 TSLA -1000 @ 23.0666675567627&#34;
## [1] &#34;2018-12-12 00:00:00 TSLA 1000 @ 24.4400005340576&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-11 00:00:00 TSLA 1000 @ 23.1506671905518&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-06 00:00:00 TSLA 1000 @ 21.1480007171631&#34;
## [1] &#34;2019-02-22 00:00:00 TSLA -1000 @ 19.6473331451416&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-29 00:00:00 TSLA 1000 @ 18.6573333740234&#34;
## [1] &#34;2019-04-25 00:00:00 TSLA -1000 @ 16.5086669921875&#34;
## [1] &#34;2019-06-10 00:00:00 TSLA 1000 @ 14.1920003890991&#34;
## [1] &#34;2019-07-29 00:00:00 TSLA -1000 @ 15.7180004119873&#34;
## [1] &#34;2019-09-06 00:00:00 TSLA 1000 @ 15.1633329391479&#34;
## [1] &#34;2019-09-26 00:00:00 TSLA -1000 @ 16.1706676483154&#34;
## [1] &#34;2019-09-27 00:00:00 TSLA 1000 @ 16.1420001983643&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-11 00:00:00 TSLA 1000 @ 16.5259990692139&#34;
## [1] &#34;2019-11-22 00:00:00 TSLA -1000 @ 22.2026672363281&#34;
## [1] &#34;2019-12-18 00:00:00 TSLA 1000 @ 26.2099990844727&#34;
## [1] &#34;2020-02-25 00:00:00 TSLA -1000 @ 53.3273315429688&#34;
## [1] &#34;2020-04-08 00:00:00 TSLA 1000 @ 36.5893325805664&#34;
## [1] &#34;2020-05-18 00:00:00 TSLA -1000 @ 54.242000579834&#34;
## [1] &#34;2020-06-09 00:00:00 TSLA 1000 @ 62.7113342285156&#34;
## [1] &#34;2020-06-25 00:00:00 TSLA -1000 @ 65.7320022583008&#34;
## [1] &#34;2020-07-02 00:00:00 TSLA 1000 @ 80.5773315429688&#34;
## [1] &#34;2020-07-27 00:00:00 TSLA -1000 @ 102.639999389648&#34;
## [1] &#34;2020-08-19 00:00:00 TSLA 1000 @ 125.235336303711&#34;
## [1] &#34;2020-09-08 00:00:00 TSLA -1000 @ 110.069999694824&#34;
## [1] &#34;2020-11-19 00:00:00 TSLA 1000 @ 166.42333984375&#34;
## [1] &#34;2020-12-23 00:00:00 TSLA -1000 @ 215.32666015625&#34;
## [1] &#34;2021-01-06 00:00:00 TSLA 1000 @ 251.99333190918&#34;
## [1] &#34;2021-01-22 00:00:00 TSLA -1000 @ 282.213317871094&#34;
## [1] &#34;2021-03-18 00:00:00 TSLA 1000 @ 217.720001220703&#34;
## [1] &#34;2021-03-22 00:00:00 TSLA -1000 @ 223.33332824707&#34;
## [1] &#34;2021-03-23 00:00:00 TSLA 1000 @ 220.720001220703&#34;
## [1] &#34;2021-03-25 00:00:00 TSLA -1000 @ 213.463333129883&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-05-03 00:00:00 TSLA -1000 @ 228.300003051758&#34;
## [1] &#34;2021-05-28 00:00:00 TSLA 1000 @ 208.406661987305&#34;
## [1] &#34;2021-07-19 00:00:00 TSLA -1000 @ 215.406661987305&#34;
## [1] &#34;2021-08-02 00:00:00 TSLA 1000 @ 236.556671142578&#34;
## [1] &#34;2021-08-18 00:00:00 TSLA -1000 @ 229.663330078125&#34;
## [1] &#34;2021-08-31 00:00:00 TSLA 1000 @ 245.240005493164&#34;
## [1] &#34;2021-09-21 00:00:00 TSLA -1000 @ 246.460006713867&#34;
## [1] &#34;2021-09-28 00:00:00 TSLA 1000 @ 259.186676025391&#34;
## [1] &#34;2021-10-12 00:00:00 TSLA -1000 @ 268.573333740234&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-12 00:00:00 TSLA -1000 @ 344.473327636719&#34;
## [1] &#34;2021-12-29 00:00:00 TSLA 1000 @ 362.063323974609&#34;
## [1] &#34;2022-01-14 00:00:00 TSLA -1000 @ 349.869995117188&#34;
## [1] &#34;2022-02-17 00:00:00 TSLA 1000 @ 292.116668701172&#34;
## [1] &#34;2022-02-22 00:00:00 TSLA -1000 @ 273.843322753906&#34;
## [1] &#34;2022-03-03 00:00:00 TSLA 1000 @ 279.763336181641&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-13 00:00:00 TSLA -1000 @ 340.790008544922&#34;
## [1] &#34;2022-06-02 00:00:00 TSLA 1000 @ 258.333343505859&#34;
## [1] &#34;2022-06-21 00:00:00 TSLA -1000 @ 237.036666870117&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-22 00:00:00 TSLA -1000 @ 289.913330078125&#34;
## [1] &#34;2022-09-16 00:00:00 TSLA 1000 @ 303.350006103516&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-28 00:00:00 TSLA 1000 @ 228.520004272461&#34;
## [1] &#34;2022-11-09 00:00:00 TSLA -1000 @ 177.589996337891&#34;
## [1] &#34;2022-11-30 00:00:00 TSLA 1000 @ 194.699996948242&#34;
## [1] &#34;2022-12-14 00:00:00 TSLA -1000 @ 156.800003051758&#34;
## [1] &#34;2023-01-13 00:00:00 TSLA 1000 @ 122.400001525879&#34;
## [1] &#34;2023-02-28 00:00:00 TSLA -1000 @ 205.710006713867&#34;
## [1] &#34;2023-04-03 00:00:00 TSLA 1000 @ 194.770004272461&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-10 00:00:00 TSLA 1000 @ 168.539993286133&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 找出最佳参数组合（基于夏普比率）</span>
</span></span><span style=display:flex><span>best_params <span style=color:#f92672>&lt;-</span> results<span style=color:#a6e22e>[which.max</span>(results<span style=color:#f92672>$</span>SharpeRatio), ]
</span></span><span style=display:flex><span><span style=color:#a6e22e>print</span>(<span style=color:#e6db74>&#34;最佳参数组合:&#34;</span>)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;最佳参数组合:&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>print</span>(best_params)
</span></span></code></pre></div><pre tabindex=0><code>##   nFast nSlow nSig SharpeRatio    Return MaxDrawdown TradeCount
## 1     8    22    7   0.7357213 0.3363681   0.1447274        126
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 可视化参数优化结果</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ggplot</span>(results, <span style=color:#a6e22e>aes</span>(x <span style=color:#f92672>=</span> <span style=color:#a6e22e>as.factor</span>(nFast), 
</span></span><span style=display:flex><span>                    y <span style=color:#f92672>=</span> SharpeRatio, 
</span></span><span style=display:flex><span>                    fill <span style=color:#f92672>=</span> <span style=color:#a6e22e>as.factor</span>(nSig))) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>geom_boxplot</span>() <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>facet_wrap</span>(<span style=color:#f92672>~</span> nSlow) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>labs</span>(title <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;MACD参数优化结果（夏普比率）&#34;</span>,
</span></span><span style=display:flex><span>       x <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;快速EMA周期(nFast)&#34;</span>,
</span></span><span style=display:flex><span>       y <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;年化夏普比率&#34;</span>,
</span></span><span style=display:flex><span>       fill <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;信号线周期(nSig)&#34;</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>theme_minimal</span>(base_family <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SimHei&#34;</span>)
</span></span></code></pre></div><img src=/post/macd_files/figure-html/param_optimization-1.png width=90% style=display:block;margin:auto><h1 id=基于最佳参数的回测>基于最佳参数的回测</h1><p>根据参数优化结果，我们使用最佳参数组合重新进行回测，并详细分析策略表现：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 清理历史环境。</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>reset_strategy_env</span>()
</span></span></code></pre></div><pre tabindex=0><code>## 策略环境已重置
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>rm</span>(list <span style=color:#f92672>=</span> <span style=color:#a6e22e>ls</span>(.blotter))
</span></span><span style=display:flex><span><span style=color:#a6e22e>rm</span>(list <span style=color:#f92672>=</span> <span style=color:#a6e22e>ls</span>(.strategy))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置初始参数</span>
</span></span><span style=display:flex><span>initEq.st <span style=color:#f92672>&lt;-</span> <span style=color:#ae81ff>1000000</span>  
</span></span><span style=display:flex><span>portfolio.st <span style=color:#f92672>&lt;-</span> <span style=color:#e6db74>&#34;MACD_Portfolio&#34;</span>
</span></span><span style=display:flex><span>strategy.st <span style=color:#f92672>&lt;-</span> <span style=color:#e6db74>&#34;MACD_Strategy&#34;</span>
</span></span><span style=display:flex><span>account.st <span style=color:#f92672>&lt;-</span> <span style=color:#e6db74>&#34;MACD_Account&#34;</span>
</span></span><span style=display:flex><span>symbols.st <span style=color:#f92672>&lt;-</span> <span style=color:#e6db74>&#34;TSLA&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 初始化quantstrat</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>currency</span>(<span style=color:#e6db74>&#34;USD&#34;</span>)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;USD&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>stock</span>(<span style=color:#e6db74>&#34;TSLA&#34;</span>, currency <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;USD&#34;</span>, multiplier <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;TSLA&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>initPortf</span>(portfolio.st, symbols <span style=color:#f92672>=</span> symbols.st)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;MACD_Portfolio&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>initAcct</span>(account.st, portfolios <span style=color:#f92672>=</span> portfolio.st, initEq <span style=color:#f92672>=</span> initEq.st)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;MACD_Account&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>initOrders</span>(portfolio.st, symbols.st, initDate <span style=color:#f92672>=</span> initDate)
</span></span><span style=display:flex><span><span style=color:#a6e22e>strategy</span>(strategy.st, store <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span>indicator_label <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>paste0</span>(<span style=color:#e6db74>&#34;MACD_&#34;</span>, 
</span></span><span style=display:flex><span>                          best_params<span style=color:#f92672>$</span>nFast, 
</span></span><span style=display:flex><span>                          <span style=color:#e6db74>&#34;_&#34;</span>, 
</span></span><span style=display:flex><span>                          best_params<span style=color:#f92672>$</span>nSlow, 
</span></span><span style=display:flex><span>                          <span style=color:#e6db74>&#34;_&#34;</span>, 
</span></span><span style=display:flex><span>                          best_params<span style=color:#f92672>$</span>nSig)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 添加MACD指标，使用最佳参数</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>add.indicator</span>(strategy.st, 
</span></span><span style=display:flex><span>              name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;MACD&#34;</span>, 
</span></span><span style=display:flex><span>              arguments <span style=color:#f92672>=</span> <span style=color:#a6e22e>list</span>(x <span style=color:#f92672>=</span> <span style=color:#a6e22e>quote</span>(<span style=color:#a6e22e>Cl</span>(mktdata)), 
</span></span><span style=display:flex><span>                               nFast <span style=color:#f92672>=</span> best_params<span style=color:#f92672>$</span>nFast, 
</span></span><span style=display:flex><span>                               nSlow <span style=color:#f92672>=</span> best_params<span style=color:#f92672>$</span>nSlow, 
</span></span><span style=display:flex><span>                               nSig <span style=color:#f92672>=</span> best_params<span style=color:#f92672>$</span>nSig),
</span></span><span style=display:flex><span>              label <span style=color:#f92672>=</span> indicator_label
</span></span><span style=display:flex><span>              )
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;MACD_Strategy&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span>macd_col <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>paste0</span>(<span style=color:#e6db74>&#34;macd.MACD_&#34;</span>, 
</span></span><span style=display:flex><span>                   best_params<span style=color:#f92672>$</span>nFast, 
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;_&#34;</span>, 
</span></span><span style=display:flex><span>                   best_params<span style=color:#f92672>$</span>nSlow, 
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;_&#34;</span>, 
</span></span><span style=display:flex><span>                   best_params<span style=color:#f92672>$</span>nSig)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>signal_col<span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>paste0</span>(<span style=color:#e6db74>&#34;signal.MACD_&#34;</span>, 
</span></span><span style=display:flex><span>                    best_params<span style=color:#f92672>$</span>nFast, 
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#34;_&#34;</span>, 
</span></span><span style=display:flex><span>                    best_params<span style=color:#f92672>$</span>nSlow, 
</span></span><span style=display:flex><span>                    <span style=color:#e6db74>&#34;_&#34;</span>, 
</span></span><span style=display:flex><span>                    best_params<span style=color:#f92672>$</span>nSig)
</span></span><span style=display:flex><span><span style=color:#75715e># 添加相同的交易信号和规则</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 买入信号</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>add.signal</span>(strategy.st, 
</span></span><span style=display:flex><span>           name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;sigCrossover&#34;</span>, 
</span></span><span style=display:flex><span>           arguments <span style=color:#f92672>=</span> <span style=color:#a6e22e>list</span>(columns <span style=color:#f92672>=</span><span style=color:#a6e22e>c</span>(macd_col, signal_col), 
</span></span><span style=display:flex><span>                            relationship <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;gte&#34;</span>),
</span></span><span style=display:flex><span>           label <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Buy_Signal&#34;</span>)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;MACD_Strategy&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 卖出信号</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>add.signal</span>(strategy.st, 
</span></span><span style=display:flex><span>           name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;sigCrossover&#34;</span>, 
</span></span><span style=display:flex><span>           arguments <span style=color:#f92672>=</span> <span style=color:#a6e22e>list</span>(columns <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(macd_col, signal_col), 
</span></span><span style=display:flex><span>                            relationship <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;lte&#34;</span>),
</span></span><span style=display:flex><span>           label <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Sell_Signal&#34;</span>)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;MACD_Strategy&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 添加交易规则</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>add.rule</span>(strategy.st, 
</span></span><span style=display:flex><span>         name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ruleSignal&#34;</span>, 
</span></span><span style=display:flex><span>         arguments <span style=color:#f92672>=</span> <span style=color:#a6e22e>list</span>(sigcol <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Buy_Signal&#34;</span>, 
</span></span><span style=display:flex><span>                          sigval <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>, 
</span></span><span style=display:flex><span>                          orderqty <span style=color:#f92672>=</span> <span style=color:#ae81ff>1000</span>, 
</span></span><span style=display:flex><span>                          ordertype <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;market&#34;</span>, 
</span></span><span style=display:flex><span>                          orderside <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;long&#34;</span>, 
</span></span><span style=display:flex><span>                          replace <span style=color:#f92672>=</span> <span style=color:#66d9ef>FALSE</span>, 
</span></span><span style=display:flex><span>                          prefer <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Close&#34;</span>),
</span></span><span style=display:flex><span>         type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;enter&#34;</span>, 
</span></span><span style=display:flex><span>         label <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Enter_Long&#34;</span>)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;MACD_Strategy&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>add.rule</span>(strategy.st, 
</span></span><span style=display:flex><span>         name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ruleSignal&#34;</span>, 
</span></span><span style=display:flex><span>         arguments <span style=color:#f92672>=</span> <span style=color:#a6e22e>list</span>(sigcol <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Sell_Signal&#34;</span>, 
</span></span><span style=display:flex><span>                          sigval <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>, 
</span></span><span style=display:flex><span>                          orderqty <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;all&#34;</span>, 
</span></span><span style=display:flex><span>                          ordertype <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;market&#34;</span>, 
</span></span><span style=display:flex><span>                          orderside <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;long&#34;</span>, 
</span></span><span style=display:flex><span>                          replace <span style=color:#f92672>=</span> <span style=color:#66d9ef>FALSE</span>, 
</span></span><span style=display:flex><span>                          prefer <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Close&#34;</span>),
</span></span><span style=display:flex><span>         type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;exit&#34;</span>, 
</span></span><span style=display:flex><span>         label <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Exit_Long&#34;</span>)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;MACD_Strategy&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 运行回测</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>applyStrategy</span>(strategy <span style=color:#f92672>=</span> strategy.st, portfolios <span style=color:#f92672>=</span> portfolio.st)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;2018-02-21 00:00:00 TSLA 1000 @ 22.2199993133545&#34;
## [1] &#34;2018-03-02 00:00:00 TSLA -1000 @ 22.3413333892822&#34;
## [1] &#34;2018-03-14 00:00:00 TSLA 1000 @ 21.775333404541&#34;
## [1] &#34;2018-03-15 00:00:00 TSLA -1000 @ 21.7066669464111&#34;
## [1] &#34;2018-04-06 00:00:00 TSLA 1000 @ 19.953332901001&#34;
## [1] &#34;2018-04-25 00:00:00 TSLA -1000 @ 18.71266746521&#34;
## [1] &#34;2018-04-30 00:00:00 TSLA 1000 @ 19.5933322906494&#34;
## [1] &#34;2018-05-16 00:00:00 TSLA -1000 @ 19.0986671447754&#34;
## [1] &#34;2018-05-31 00:00:00 TSLA 1000 @ 18.9820003509521&#34;
## [1] &#34;2018-06-25 00:00:00 TSLA -1000 @ 22.2006664276123&#34;
## [1] &#34;2018-07-20 00:00:00 TSLA 1000 @ 20.9053325653076&#34;
## [1] &#34;2018-07-23 00:00:00 TSLA -1000 @ 20.2133331298828&#34;
## [1] &#34;2018-08-03 00:00:00 TSLA 1000 @ 23.211332321167&#34;
## [1] &#34;2018-08-16 00:00:00 TSLA -1000 @ 22.3633327484131&#34;
## [1] &#34;2018-09-14 00:00:00 TSLA 1000 @ 19.6800003051758&#34;
## [1] &#34;2018-10-01 00:00:00 TSLA -1000 @ 20.7133331298828&#34;
## [1] &#34;2018-10-02 00:00:00 TSLA 1000 @ 20.068000793457&#34;
## [1] &#34;2018-10-05 00:00:00 TSLA -1000 @ 17.4633331298828&#34;
## [1] &#34;2018-10-17 00:00:00 TSLA 1000 @ 18.1186676025391&#34;
## [1] &#34;2018-11-13 00:00:00 TSLA -1000 @ 22.5820007324219&#34;
## [1] &#34;2018-12-06 00:00:00 TSLA 1000 @ 24.2040004730225&#34;
## [1] &#34;2018-12-18 00:00:00 TSLA -1000 @ 22.4686660766602&#34;
## [1] &#34;2019-01-08 00:00:00 TSLA 1000 @ 22.3566665649414&#34;
## [1] &#34;2019-01-22 00:00:00 TSLA -1000 @ 19.92799949646&#34;
## [1] &#34;2019-02-01 00:00:00 TSLA 1000 @ 20.8139991760254&#34;
## [1] &#34;2019-02-21 00:00:00 TSLA -1000 @ 19.4153327941895&#34;
## [1] &#34;2019-02-28 00:00:00 TSLA 1000 @ 21.3253326416016&#34;
## [1] &#34;2019-03-05 00:00:00 TSLA -1000 @ 18.4360008239746&#34;
## [1] &#34;2019-03-14 00:00:00 TSLA 1000 @ 19.3306674957275&#34;
## [1] &#34;2019-03-18 00:00:00 TSLA -1000 @ 17.9659996032715&#34;
## [1] &#34;2019-03-28 00:00:00 TSLA 1000 @ 18.5746669769287&#34;
## [1] &#34;2019-04-12 00:00:00 TSLA -1000 @ 17.8466663360596&#34;
## [1] &#34;2019-04-18 00:00:00 TSLA 1000 @ 18.2173328399658&#34;
## [1] &#34;2019-04-23 00:00:00 TSLA -1000 @ 17.5933322906494&#34;
## [1] &#34;2019-05-06 00:00:00 TSLA 1000 @ 17.0226669311523&#34;
## [1] &#34;2019-05-14 00:00:00 TSLA -1000 @ 15.4873332977295&#34;
## [1] &#34;2019-06-05 00:00:00 TSLA 1000 @ 13.1059999465942&#34;
## [1] &#34;2019-07-26 00:00:00 TSLA -1000 @ 15.2026672363281&#34;
## [1] &#34;2019-08-30 00:00:00 TSLA 1000 @ 15.0406665802002&#34;
## [1] &#34;2019-09-24 00:00:00 TSLA -1000 @ 14.8806667327881&#34;
## [1] &#34;2019-10-02 00:00:00 TSLA 1000 @ 16.208667755127&#34;
## [1] &#34;2019-10-04 00:00:00 TSLA -1000 @ 15.4286670684814&#34;
## [1] &#34;2019-10-10 00:00:00 TSLA 1000 @ 16.3159999847412&#34;
## [1] &#34;2019-10-24 00:00:00 TSLA -1000 @ 19.978666305542&#34;
## [1] &#34;2019-10-25 00:00:00 TSLA 1000 @ 21.8753337860107&#34;
## [1] &#34;2019-11-07 00:00:00 TSLA -1000 @ 22.3693332672119&#34;
## [1] &#34;2019-11-08 00:00:00 TSLA 1000 @ 22.4759998321533&#34;
## [1] &#34;2019-11-14 00:00:00 TSLA -1000 @ 23.2900009155273&#34;
## [1] &#34;2019-12-12 00:00:00 TSLA 1000 @ 23.978666305542&#34;
## [1] &#34;2020-01-02 00:00:00 TSLA -1000 @ 28.6840000152588&#34;
## [1] &#34;2020-01-06 00:00:00 TSLA 1000 @ 30.1026668548584&#34;
## [1] &#34;2020-01-21 00:00:00 TSLA -1000 @ 36.4799995422363&#34;
## [1] &#34;2020-01-22 00:00:00 TSLA 1000 @ 37.9706687927246&#34;
## [1] &#34;2020-01-28 00:00:00 TSLA -1000 @ 37.7933311462402&#34;
## [1] &#34;2020-01-31 00:00:00 TSLA 1000 @ 43.3713340759277&#34;
## [1] &#34;2020-02-12 00:00:00 TSLA -1000 @ 51.1526679992676&#34;
## [1] &#34;2020-02-20 00:00:00 TSLA 1000 @ 59.9606666564941&#34;
## [1] &#34;2020-02-24 00:00:00 TSLA -1000 @ 55.5859985351562&#34;
## [1] &#34;2020-03-26 00:00:00 TSLA 1000 @ 35.2106666564941&#34;
## [1] &#34;2020-05-04 00:00:00 TSLA -1000 @ 50.7459983825684&#34;
## [1] &#34;2020-06-02 00:00:00 TSLA 1000 @ 58.7706680297852&#34;
## [1] &#34;2020-06-22 00:00:00 TSLA -1000 @ 66.2880020141602&#34;
## [1] &#34;2020-07-01 00:00:00 TSLA 1000 @ 74.6419982910156&#34;
## [1] &#34;2020-07-20 00:00:00 TSLA -1000 @ 109.533332824707&#34;
## [1] &#34;2020-07-21 00:00:00 TSLA 1000 @ 104.557334899902&#34;
## [1] &#34;2020-07-22 00:00:00 TSLA -1000 @ 106.155334472656&#34;
## [1] &#34;2020-08-14 00:00:00 TSLA 1000 @ 110.047332763672&#34;
## [1] &#34;2020-09-04 00:00:00 TSLA -1000 @ 139.440002441406&#34;
## [1] &#34;2020-09-17 00:00:00 TSLA 1000 @ 141.143325805664&#34;
## [1] &#34;2020-09-23 00:00:00 TSLA -1000 @ 126.786666870117&#34;
## [1] &#34;2020-10-02 00:00:00 TSLA 1000 @ 138.363327026367&#34;
## [1] &#34;2020-10-05 00:00:00 TSLA -1000 @ 141.893325805664&#34;
## [1] &#34;2020-10-13 00:00:00 TSLA 1000 @ 148.883331298828&#34;
## [1] &#34;2020-10-20 00:00:00 TSLA -1000 @ 140.646667480469&#34;
## [1] &#34;2020-11-06 00:00:00 TSLA 1000 @ 143.316665649414&#34;
## [1] &#34;2020-11-13 00:00:00 TSLA -1000 @ 136.16667175293&#34;
## [1] &#34;2020-11-18 00:00:00 TSLA 1000 @ 162.213333129883&#34;
## [1] &#34;2020-12-11 00:00:00 TSLA -1000 @ 203.330001831055&#34;
## [1] &#34;2021-01-05 00:00:00 TSLA 1000 @ 245.036666870117&#34;
## [1] &#34;2021-01-19 00:00:00 TSLA -1000 @ 281.516662597656&#34;
## [1] &#34;2021-03-11 00:00:00 TSLA 1000 @ 233.199996948242&#34;
## [1] &#34;2021-03-26 00:00:00 TSLA -1000 @ 206.236663818359&#34;
## [1] &#34;2021-04-01 00:00:00 TSLA 1000 @ 220.58332824707&#34;
## [1] &#34;2021-04-28 00:00:00 TSLA -1000 @ 231.466659545898&#34;
## [1] &#34;2021-05-25 00:00:00 TSLA 1000 @ 201.563339233398&#34;
## [1] &#34;2021-07-08 00:00:00 TSLA -1000 @ 217.603332519531&#34;
## [1] &#34;2021-07-30 00:00:00 TSLA 1000 @ 229.066665649414&#34;
## [1] &#34;2021-08-17 00:00:00 TSLA -1000 @ 221.903335571289&#34;
## [1] &#34;2021-08-26 00:00:00 TSLA 1000 @ 233.720001220703&#34;
## [1] &#34;2021-09-14 00:00:00 TSLA -1000 @ 248.163330078125&#34;
## [1] &#34;2021-09-27 00:00:00 TSLA 1000 @ 263.786682128906&#34;
## [1] &#34;2021-10-05 00:00:00 TSLA -1000 @ 260.196655273438&#34;
## [1] &#34;2021-10-08 00:00:00 TSLA 1000 @ 261.829986572266&#34;
## [1] &#34;2021-10-11 00:00:00 TSLA -1000 @ 263.980010986328&#34;
## [1] &#34;2021-10-13 00:00:00 TSLA 1000 @ 270.359985351562&#34;
## [1] &#34;2021-11-09 00:00:00 TSLA -1000 @ 341.166656494141&#34;
## [1] &#34;2021-12-23 00:00:00 TSLA 1000 @ 355.666656494141&#34;
## [1] &#34;2022-01-10 00:00:00 TSLA -1000 @ 352.706665039062&#34;
## [1] &#34;2022-02-07 00:00:00 TSLA 1000 @ 302.446655273438&#34;
## [1] &#34;2022-02-23 00:00:00 TSLA -1000 @ 254.679992675781&#34;
## [1] &#34;2022-03-01 00:00:00 TSLA 1000 @ 288.123321533203&#34;
## [1] &#34;2022-03-15 00:00:00 TSLA -1000 @ 267.296661376953&#34;
## [1] &#34;2022-03-17 00:00:00 TSLA 1000 @ 290.533325195312&#34;
## [1] &#34;2022-04-07 00:00:00 TSLA -1000 @ 352.420013427734&#34;
## [1] &#34;2022-05-27 00:00:00 TSLA 1000 @ 253.210006713867&#34;
## [1] &#34;2022-06-14 00:00:00 TSLA -1000 @ 220.889999389648&#34;
## [1] &#34;2022-06-16 00:00:00 TSLA 1000 @ 213.100006103516&#34;
## [1] &#34;2022-06-17 00:00:00 TSLA -1000 @ 216.759994506836&#34;
## [1] &#34;2022-06-22 00:00:00 TSLA 1000 @ 236.086669921875&#34;
## [1] &#34;2022-08-09 00:00:00 TSLA -1000 @ 283.333343505859&#34;
## [1] &#34;2022-09-12 00:00:00 TSLA 1000 @ 304.420013427734&#34;
## [1] &#34;2022-09-23 00:00:00 TSLA -1000 @ 275.329986572266&#34;
## [1] &#34;2022-10-20 00:00:00 TSLA 1000 @ 207.279998779297&#34;
## [1] &#34;2022-11-08 00:00:00 TSLA -1000 @ 191.300003051758&#34;
## [1] &#34;2022-11-28 00:00:00 TSLA 1000 @ 182.919998168945&#34;
## [1] &#34;2022-12-09 00:00:00 TSLA -1000 @ 179.050003051758&#34;
## [1] &#34;2022-12-12 00:00:00 TSLA 1000 @ 167.820007324219&#34;
## [1] &#34;2022-12-13 00:00:00 TSLA -1000 @ 160.949996948242&#34;
## [1] &#34;2023-01-10 00:00:00 TSLA 1000 @ 118.849998474121&#34;
## [1] &#34;2023-02-14 00:00:00 TSLA -1000 @ 209.25&#34;
## [1] &#34;2023-02-16 00:00:00 TSLA 1000 @ 202.039993286133&#34;
## [1] &#34;2023-02-17 00:00:00 TSLA -1000 @ 208.309997558594&#34;
## [1] &#34;2023-03-22 00:00:00 TSLA 1000 @ 191.149993896484&#34;
## [1] &#34;2023-04-06 00:00:00 TSLA -1000 @ 185.059997558594&#34;
## [1] &#34;2023-05-05 00:00:00 TSLA 1000 @ 170.059997558594&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>updatePortf</span>(portfolio.st)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;MACD_Portfolio&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>updateAcct</span>(account.st)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;MACD_Account&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>updateEndEq</span>(account.st)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;MACD_Account&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 获取策略收益</span>
</span></span><span style=display:flex><span>port_ret_best <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>PortfReturns</span>(account.st)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 计算评估指标</span>
</span></span><span style=display:flex><span>sharpe_ratio_best <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>SharpeRatio.annualized</span>(port_ret_best)
</span></span><span style=display:flex><span>total_return_best <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>Return.cumulative</span>(port_ret_best)
</span></span><span style=display:flex><span>max_drawdown_best <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>maxDrawdown</span>(port_ret_best)
</span></span><span style=display:flex><span>trade_count_best <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>length</span>(<span style=color:#a6e22e>index</span>(<span style=color:#a6e22e>getTxns</span>(Portfolio <span style=color:#f92672>=</span> portfolio.st, 
</span></span><span style=display:flex><span>                                         Symbol <span style=color:#f92672>=</span> symbols.st)
</span></span><span style=display:flex><span>                                 )
</span></span><span style=display:flex><span>                           )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 计算买入持有策略的收益作为基准</span>
</span></span><span style=display:flex><span>buy_hold_ret <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>dailyReturn</span>(<span style=color:#a6e22e>Cl</span>(TSLA))
</span></span><span style=display:flex><span>sharpe_ratio_bh <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>SharpeRatio.annualized</span>(buy_hold_ret)
</span></span><span style=display:flex><span>total_return_bh <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>Return.cumulative</span>(buy_hold_ret)
</span></span><span style=display:flex><span>max_drawdown_bh <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>maxDrawdown</span>(buy_hold_ret)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 输出评估结果</span>
</span></span><span style=display:flex><span>results_df <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>data.frame</span>(
</span></span><span style=display:flex><span>  Strategy <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;MACD策略&#34;</span>, <span style=color:#e6db74>&#34;买入持有&#34;</span>),
</span></span><span style=display:flex><span>  年化夏普比率 <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(sharpe_ratio_best, sharpe_ratio_bh),
</span></span><span style=display:flex><span>  总收益率 <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(total_return_best, total_return_bh),
</span></span><span style=display:flex><span>  最大回撤 <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(max_drawdown_best, max_drawdown_bh),
</span></span><span style=display:flex><span>  交易次数 <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(trade_count_best, <span style=color:#66d9ef>NA</span>)
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>print</span>(<span style=color:#e6db74>&#34;策略评估结果:&#34;</span>)
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;策略评估结果:&#34;
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>print</span>(results_df)
</span></span></code></pre></div><pre tabindex=0><code>##   Strategy 年化夏普比率  总收益率  最大回撤 交易次数
## 1 MACD策略    0.7357213 0.3363681 0.1447274      126
## 2 买入持有    0.7942006 8.5434117 0.7363222       NA
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 可视化策略收益</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>charts.PerformanceSummary</span>(<span style=color:#a6e22e>cbind</span>(port_ret_best, buy_hold_ret), 
</span></span><span style=display:flex><span>                          main <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;MACD策略与买入持有策略收益对比&#34;</span>,
</span></span><span style=display:flex><span>                          colorset <span style=color:#f92672>=</span> bluefocus, 
</span></span><span style=display:flex><span>                          wealth.index <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>)
</span></span></code></pre></div><img src=/post/macd_files/figure-html/best_strategy_backtest-1.png width=90% style=display:block;margin:auto><h1 id=交易信号可视化>交易信号可视化</h1><p>为了更直观地理解MACD指标的交易信号，我们将可视化价格走势和MACD指标，并标记买卖点：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 1. 计算MACD指标</span>
</span></span><span style=display:flex><span>macd_values <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>MACD</span>(<span style=color:#a6e22e>Cl</span>(TSLA), 
</span></span><span style=display:flex><span>                    nFast <span style=color:#f92672>=</span> best_params<span style=color:#f92672>$</span>nFast, 
</span></span><span style=display:flex><span>                    nSlow <span style=color:#f92672>=</span> best_params<span style=color:#f92672>$</span>nSlow, 
</span></span><span style=display:flex><span>                    nSig <span style=color:#f92672>=</span> best_params<span style=color:#f92672>$</span>nSig)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. 生成交易信号</span>
</span></span><span style=display:flex><span>txns <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>getTxns</span>(portfolio.st, <span style=color:#e6db74>&#34;TSLA&#34;</span>)  <span style=color:#75715e># 获取交易记录</span>
</span></span><span style=display:flex><span>signals <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>generateSimpleSignalChain</span>(txns, type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;numeric&#34;</span>)[<span style=color:#ae81ff>-1</span>, ]  <span style=color:#75715e># 生成信号</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 3. 准备价格数据</span>
</span></span><span style=display:flex><span>price_data <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>data.frame</span>(
</span></span><span style=display:flex><span>    date <span style=color:#f92672>=</span> <span style=color:#a6e22e>index</span>(TSLA),
</span></span><span style=display:flex><span>    close <span style=color:#f92672>=</span> <span style=color:#a6e22e>as.numeric</span>(<span style=color:#a6e22e>Cl</span>(TSLA))
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 4. 准备MACD指标数据</span>
</span></span><span style=display:flex><span>macd_data <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>data.frame</span>(
</span></span><span style=display:flex><span>    date <span style=color:#f92672>=</span> <span style=color:#a6e22e>index</span>(macd_values),
</span></span><span style=display:flex><span>    macd <span style=color:#f92672>=</span> <span style=color:#a6e22e>as.numeric</span>(macd_values<span style=color:#f92672>$</span>macd),
</span></span><span style=display:flex><span>    signal_line <span style=color:#f92672>=</span> <span style=color:#a6e22e>as.numeric</span>(macd_values<span style=color:#f92672>$</span>signal), <span style=color:#75715e># 避免与交易信号重名</span>
</span></span><span style=display:flex><span>    histogram <span style=color:#f92672>=</span> <span style=color:#a6e22e>as.numeric</span>(macd_values<span style=color:#f92672>$</span>macd <span style=color:#f92672>-</span> macd_values<span style=color:#f92672>$</span>signal)
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 5. 准备交易信号数据</span>
</span></span><span style=display:flex><span>signal_data <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>data.frame</span>(
</span></span><span style=display:flex><span>    date <span style=color:#f92672>=</span> <span style=color:#a6e22e>as.Date</span>(<span style=color:#a6e22e>index</span>(signals)),
</span></span><span style=display:flex><span>    signal_value <span style=color:#f92672>=</span> <span style=color:#a6e22e>as.numeric</span>(signals<span style=color:#f92672>$</span>Signal)
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 6. 数据合并（以价格数据为基准，左连接）</span>
</span></span><span style=display:flex><span>merged_data <span style=color:#f92672>&lt;-</span> price_data <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>left_join</span>(macd_data, by <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;date&#34;</span>) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>left_join</span>(signal_data, by <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;date&#34;</span>) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 填充缺失的信号值为0（无交易）</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mutate</span>(signal_value <span style=color:#f92672>=</span> <span style=color:#a6e22e>ifelse</span>(<span style=color:#a6e22e>is.na</span>(signal_value), <span style=color:#ae81ff>0</span>, signal_value))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 7. 提取买卖点</span>
</span></span><span style=display:flex><span>buy_points <span style=color:#f92672>&lt;-</span> merged_data <span style=color:#f92672>%&gt;%</span> <span style=color:#a6e22e>filter</span>(signal_value <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>sell_points <span style=color:#f92672>&lt;-</span> merged_data <span style=color:#f92672>%&gt;%</span> <span style=color:#a6e22e>filter</span>(signal_value <span style=color:#f92672>==</span> <span style=color:#ae81ff>-1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 8. 价格与交易信号图（修复版）</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 预先计算移动平均线和趋势带（使用rollapply替代rollsd）</span>
</span></span><span style=display:flex><span>merged_data <span style=color:#f92672>&lt;-</span> merged_data <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mutate</span>(
</span></span><span style=display:flex><span>        ma20 <span style=color:#f92672>=</span> zoo<span style=color:#f92672>::</span><span style=color:#a6e22e>rollmean</span>(close, <span style=color:#ae81ff>20</span>, fill <span style=color:#f92672>=</span> <span style=color:#66d9ef>NA</span>),  <span style=color:#75715e># 20日移动平均线</span>
</span></span><span style=display:flex><span>        ma20_lower <span style=color:#f92672>=</span> ma20 <span style=color:#f92672>*</span> <span style=color:#ae81ff>0.98</span>,                     <span style=color:#75715e># 趋势带下轨（±2%）</span>
</span></span><span style=display:flex><span>        ma20_upper <span style=color:#f92672>=</span> ma20 <span style=color:#f92672>*</span> <span style=color:#ae81ff>1.02</span>,                     <span style=color:#75715e># 趋势带上轨</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 使用rollapply计算滚动标准差</span>
</span></span><span style=display:flex><span>        ma20_sd <span style=color:#f92672>=</span> zoo<span style=color:#f92672>::</span><span style=color:#a6e22e>rollapply</span>(close, <span style=color:#ae81ff>20</span>, sd, fill <span style=color:#f92672>=</span> <span style=color:#66d9ef>NA</span>),
</span></span><span style=display:flex><span>        bb_lower <span style=color:#f92672>=</span> ma20 <span style=color:#f92672>-</span> <span style=color:#ae81ff>1.5</span> <span style=color:#f92672>*</span> ma20_sd,              <span style=color:#75715e># 布林带下轨（±1.5σ）</span>
</span></span><span style=display:flex><span>        bb_upper <span style=color:#f92672>=</span> ma20 <span style=color:#f92672>+</span> <span style=color:#ae81ff>1.5</span> <span style=color:#f92672>*</span> ma20_sd,               <span style=color:#75715e># 布林带上轨</span>
</span></span><span style=display:flex><span>        direction <span style=color:#f92672>=</span> <span style=color:#a6e22e>ifelse</span>(histogram <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#34;1&#34;</span>, <span style=color:#e6db74>&#34;-1&#34;</span>)  <span style=color:#75715e># 新增方向列</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>price_plot <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>ggplot</span>(merged_data, <span style=color:#a6e22e>aes</span>(x <span style=color:#f92672>=</span> date, y <span style=color:#f92672>=</span> close)) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 价格线</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>geom_line</span>(color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#2c3e50&#34;</span>, size <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 移动平均线</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>geom_line</span>(<span style=color:#a6e22e>aes</span>(y <span style=color:#f92672>=</span> ma20), color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#e74c3c&#34;</span>, size <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>, linetype <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;dashed&#34;</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 固定百分比趋势带</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#geom_ribbon(</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#    aes(ymin = ma20_lower, ymax = ma20_upper),</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#    fill = &#34;grey&#34;, alpha = 0.5</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#) +</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 布林带式趋势带</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>geom_ribbon</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>aes</span>(ymin <span style=color:#f92672>=</span> bb_lower, ymax <span style=color:#f92672>=</span> bb_upper),
</span></span><span style=display:flex><span>        fill <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;blue&#34;</span>, alpha <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.2</span>
</span></span><span style=display:flex><span>    ) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 买卖点标记</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>geom_point</span>(data <span style=color:#f92672>=</span> buy_points, 
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>aes</span>(y <span style=color:#f92672>=</span> close), 
</span></span><span style=display:flex><span>               color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#27ae60&#34;</span>, 
</span></span><span style=display:flex><span>               size <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>, 
</span></span><span style=display:flex><span>               shape <span style=color:#f92672>=</span> <span style=color:#ae81ff>16</span>, 
</span></span><span style=display:flex><span>               fill <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;white&#34;</span>, 
</span></span><span style=display:flex><span>               alpha <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.9</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>geom_point</span>(data <span style=color:#f92672>=</span> sell_points, 
</span></span><span style=display:flex><span>               <span style=color:#a6e22e>aes</span>(y <span style=color:#f92672>=</span> close), 
</span></span><span style=display:flex><span>               color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#e74c3c&#34;</span>, 
</span></span><span style=display:flex><span>               size <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>, 
</span></span><span style=display:flex><span>               shape <span style=color:#f92672>=</span> <span style=color:#ae81ff>16</span>, 
</span></span><span style=display:flex><span>               fill <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;white&#34;</span>, 
</span></span><span style=display:flex><span>               alpha <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.9</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 标题和坐标轴设置</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>labs</span>(
</span></span><span style=display:flex><span>        title <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;TSLA价格走势与MACD交易信号&#34;</span>,
</span></span><span style=display:flex><span>        subtitle <span style=color:#f92672>=</span> <span style=color:#a6e22e>paste0</span>(<span style=color:#e6db74>&#34;参数: Fast=&#34;</span>, best_params<span style=color:#f92672>$</span>nFast, 
</span></span><span style=display:flex><span>                          <span style=color:#e6db74>&#34;, Slow=&#34;</span>, best_params<span style=color:#f92672>$</span>nSlow, 
</span></span><span style=display:flex><span>                          <span style=color:#e6db74>&#34;, Signal=&#34;</span>, best_params<span style=color:#f92672>$</span>nSig),
</span></span><span style=display:flex><span>        y <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;收盘价&#34;</span>,
</span></span><span style=display:flex><span>        x <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    ) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 自定义主题</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>theme_minimal</span>(base_size <span style=color:#f92672>=</span> <span style=color:#ae81ff>12</span>,
</span></span><span style=display:flex><span>                  base_family <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SimHei&#34;</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>theme</span>(
</span></span><span style=display:flex><span>        plot.title <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_text</span>(hjust <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>, size <span style=color:#f92672>=</span> <span style=color:#ae81ff>16</span>, face <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;bold&#34;</span>),
</span></span><span style=display:flex><span>        plot.subtitle <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_text</span>(hjust <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>, size <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>, color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;gray50&#34;</span>),
</span></span><span style=display:flex><span>        axis.text.x <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_text</span>(angle <span style=color:#f92672>=</span> <span style=color:#ae81ff>45</span>, hjust <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>        legend.position <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;top&#34;</span>,
</span></span><span style=display:flex><span>        panel.grid.minor <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>()
</span></span><span style=display:flex><span>    ) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 优化坐标轴显示</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scale_x_date</span>(
</span></span><span style=display:flex><span>        date_breaks <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;3 months&#34;</span>,
</span></span><span style=display:flex><span>        date_labels <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;%Y-%m&#34;</span>,
</span></span><span style=display:flex><span>        expand <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span>    ) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 添加图例说明</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scale_color_manual</span>(
</span></span><span style=display:flex><span>        values <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;价格&#34;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#2c3e50&#34;</span>, <span style=color:#e6db74>&#34;20日均线&#34;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#e74c3c&#34;</span>),
</span></span><span style=display:flex><span>        labels <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;价格&#34;</span>, <span style=color:#e6db74>&#34;20日移动平均线&#34;</span>)
</span></span><span style=display:flex><span>    ) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 添加参考线和标记</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>geom_hline</span>(yintercept <span style=color:#f92672>=</span> <span style=color:#a6e22e>mean</span>(merged_data<span style=color:#f92672>$</span>close, 
</span></span><span style=display:flex><span>                                 na.rm <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>), 
</span></span><span style=display:flex><span>               color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;gray&#34;</span>, 
</span></span><span style=display:flex><span>               linetype <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;dashed&#34;</span>, size <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>annotate</span>(<span style=color:#e6db74>&#34;text&#34;</span>, 
</span></span><span style=display:flex><span>             x <span style=color:#f92672>=</span> <span style=color:#a6e22e>max</span>(merged_data<span style=color:#f92672>$</span>date, na.rm <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>), 
</span></span><span style=display:flex><span>             y <span style=color:#f92672>=</span> <span style=color:#a6e22e>mean</span>(merged_data<span style=color:#f92672>$</span>close, na.rm <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>0.97</span>, 
</span></span><span style=display:flex><span>             label <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;平均价格&#34;</span>, 
</span></span><span style=display:flex><span>             color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;gray&#34;</span>, 
</span></span><span style=display:flex><span>             size <span style=color:#f92672>=</span> <span style=color:#ae81ff>3.5</span>, 
</span></span><span style=display:flex><span>             hjust <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 9. MACD指标图（优化方向填充色对比）</span>
</span></span><span style=display:flex><span>macd_plot <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>ggplot</span>(merged_data, <span style=color:#a6e22e>aes</span>(x <span style=color:#f92672>=</span> date)) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>geom_line</span>(<span style=color:#a6e22e>aes</span>(y <span style=color:#f92672>=</span> macd, color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;DIF线&#34;</span>), size <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>geom_line</span>(<span style=color:#a6e22e>aes</span>(y <span style=color:#f92672>=</span> signal_line, color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;DEA线&#34;</span>), size <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 优化柱状图填充和边框</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>geom_bar</span>(<span style=color:#a6e22e>aes</span>(y <span style=color:#f92672>=</span> histogram, fill <span style=color:#f92672>=</span> direction), 
</span></span><span style=display:flex><span>             stat <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;identity&#34;</span>, width <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.5</span>, alpha <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.8</span>,
</span></span><span style=display:flex><span>             color <span style=color:#f92672>=</span> <span style=color:#a6e22e>ifelse</span>(merged_data<span style=color:#f92672>$</span>direction <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;1&#34;</span>, <span style=color:#e6db74>&#34;#1E8449&#34;</span>, <span style=color:#e6db74>&#34;#B03A2E&#34;</span>),
</span></span><span style=display:flex><span>             size <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>+</span>  <span style=color:#75715e># 边框粗细</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 优化填充颜色对比</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scale_fill_manual</span>(
</span></span><span style=display:flex><span>        values <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;1&#34;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#2ECC71&#34;</span>,  <span style=color:#75715e># 更明亮的绿色（多头）</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;-1&#34;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#E74C3C&#34;</span>  <span style=color:#75715e># 更鲜明的红色（空头）</span>
</span></span><span style=display:flex><span>        ),
</span></span><span style=display:flex><span>        guide <span style=color:#f92672>=</span> <span style=color:#66d9ef>FALSE</span>  <span style=color:#75715e># 移除填充图例</span>
</span></span><span style=display:flex><span>    ) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 标记零轴参考线</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>geom_hline</span>(yintercept <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;gray&#34;</span>, linetype <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;dashed&#34;</span>, size <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 标记多空区域（与direction列对应）</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>annotate</span>(<span style=color:#e6db74>&#34;text&#34;</span>, 
</span></span><span style=display:flex><span>             x <span style=color:#f92672>=</span> <span style=color:#a6e22e>min</span>(merged_data<span style=color:#f92672>$</span>date, na.rm <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>), 
</span></span><span style=display:flex><span>             y <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.1</span>,
</span></span><span style=display:flex><span>             label <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;多头区域&#34;</span>, 
</span></span><span style=display:flex><span>             color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#2ECC71&#34;</span>, 
</span></span><span style=display:flex><span>             size <span style=color:#f92672>=</span> <span style=color:#ae81ff>3.5</span>, 
</span></span><span style=display:flex><span>             fontface <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;italic&#34;</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>annotate</span>(<span style=color:#e6db74>&#34;text&#34;</span>, 
</span></span><span style=display:flex><span>             x <span style=color:#f92672>=</span> <span style=color:#a6e22e>min</span>(merged_data<span style=color:#f92672>$</span>date,na.rm <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>), 
</span></span><span style=display:flex><span>             y <span style=color:#f92672>=</span> <span style=color:#ae81ff>-0.1</span>, 
</span></span><span style=display:flex><span>             label <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;空头区域&#34;</span>, 
</span></span><span style=display:flex><span>             color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#E74C3C&#34;</span>, 
</span></span><span style=display:flex><span>             size <span style=color:#f92672>=</span> <span style=color:#ae81ff>3.5</span>, 
</span></span><span style=display:flex><span>             fontface <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;italic&#34;</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 标记买卖点</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>geom_point</span>(data <span style=color:#f92672>=</span> buy_points, <span style=color:#a6e22e>aes</span>(y <span style=color:#f92672>=</span> macd), 
</span></span><span style=display:flex><span>               color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#2ECC71&#34;</span>, size <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>, shape <span style=color:#f92672>=</span> <span style=color:#ae81ff>16</span>, alpha <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.7</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>geom_point</span>(data <span style=color:#f92672>=</span> sell_points, <span style=color:#a6e22e>aes</span>(y <span style=color:#f92672>=</span> macd), 
</span></span><span style=display:flex><span>               color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#E74C3C&#34;</span>, size <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>, shape <span style=color:#f92672>=</span> <span style=color:#ae81ff>16</span>, alpha <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.7</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 标题和坐标轴</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>labs</span>(
</span></span><span style=display:flex><span>        title <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;MACD技术指标&#34;</span>,
</span></span><span style=display:flex><span>        y <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;指标值&#34;</span>,
</span></span><span style=display:flex><span>        x <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;日期&#34;</span>
</span></span><span style=display:flex><span>    ) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 主题设置</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>theme_minimal</span>(base_size <span style=color:#f92672>=</span> <span style=color:#ae81ff>12</span>, base_family <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SimHei&#34;</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>theme</span>(
</span></span><span style=display:flex><span>        plot.title <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_text</span>(hjust <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>, size <span style=color:#f92672>=</span> <span style=color:#ae81ff>16</span>, face <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;bold&#34;</span>),
</span></span><span style=display:flex><span>        axis.text.x <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_text</span>(angle <span style=color:#f92672>=</span> <span style=color:#ae81ff>45</span>, hjust <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>        legend.position <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;top&#34;</span>,
</span></span><span style=display:flex><span>        panel.grid.minor <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>()
</span></span><span style=display:flex><span>    ) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 颜色映射</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scale_color_manual</span>(
</span></span><span style=display:flex><span>        values <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;DIF线&#34;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#3498DB&#34;</span>, <span style=color:#e6db74>&#34;DEA线&#34;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#E74C3C&#34;</span>),
</span></span><span style=display:flex><span>        labels <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;DIF线 (快线)&#34;</span>, <span style=color:#e6db74>&#34;DEA线 (慢线)&#34;</span>)
</span></span><span style=display:flex><span>    ) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 优化坐标轴显示</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scale_x_date</span>(
</span></span><span style=display:flex><span>        date_breaks <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;3 months&#34;</span>,
</span></span><span style=display:flex><span>        date_labels <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;%Y-%m&#34;</span>,
</span></span><span style=display:flex><span>        expand <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 10. 组合图表</span>
</span></span><span style=display:flex><span>combined_plot <span style=color:#f92672>&lt;-</span> gridExtra<span style=color:#f92672>::</span><span style=color:#a6e22e>grid.arrange</span>(
</span></span><span style=display:flex><span>    price_plot, macd_plot,
</span></span><span style=display:flex><span>    nrow <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>    heights <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1.8</span>),
</span></span><span style=display:flex><span>    top <span style=color:#f92672>=</span> grid<span style=color:#f92672>::</span><span style=color:#a6e22e>textGrob</span>(
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;基于MACD指标的TSLA交易信号分析&#34;</span>,
</span></span><span style=display:flex><span>        gp <span style=color:#f92672>=</span> grid<span style=color:#f92672>::</span><span style=color:#a6e22e>gpar</span>(fontsize <span style=color:#f92672>=</span> <span style=color:#ae81ff>18</span>, fontface <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;bold&#34;</span>)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><img src=/post/macd_files/figure-html/signal_visualization-1.png width=90% style=display:block;margin:auto><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 显示图表</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>print</span>(combined_plot)
</span></span></code></pre></div><pre tabindex=0><code>## TableGrob (3 x 1) &#34;arrange&#34;: 3 grobs
##   z     cells    name                grob
## 1 1 (2-2,1-1) arrange      gtable[layout]
## 2 2 (3-3,1-1) arrange      gtable[layout]
## 3 3 (1-1,1-1) arrange text[GRID.text.499]
</code></pre><h1 id=交易频率分析>交易频率分析</h1><p>接下来，我们分析交易频率和持有期，这对于评估策略的实用性非常重要：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#75715e># 假设getTxns(portfolio.st,&#34;AAPL&#34;)已获取交易数据</span>
</span></span><span style=display:flex><span>trades <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>getTxns</span>(portfolio.st,symbols.st)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 数据预处理</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>nrow</span>(trades) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>  <span style=color:#75715e># 转换为data.frame并添加日期列</span>
</span></span><span style=display:flex><span>  trades_df <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>as.data.frame</span>(trades)
</span></span><span style=display:flex><span>  trades_df<span style=color:#f92672>$</span>Date <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>as.Date</span>(<span style=color:#a6e22e>index</span>(trades))
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e># 提取买卖交易</span>
</span></span><span style=display:flex><span>  buy_trades <span style=color:#f92672>&lt;-</span> trades_df[trades_df<span style=color:#f92672>$</span>Txn.Qty <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>, ]
</span></span><span style=display:flex><span>  sell_trades <span style=color:#f92672>&lt;-</span> trades_df[trades_df<span style=color:#f92672>$</span>Txn.Qty <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>, ]
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e># 确保买卖交易数量匹配</span>
</span></span><span style=display:flex><span>  n_trades <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>min</span>(<span style=color:#a6e22e>nrow</span>(buy_trades), <span style=color:#a6e22e>nrow</span>(sell_trades))
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (n_trades <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>    <span style=color:#75715e># 按时间排序</span>
</span></span><span style=display:flex><span>    buy_trades <span style=color:#f92672>&lt;-</span> buy_trades<span style=color:#a6e22e>[order</span>(buy_trades<span style=color:#f92672>$</span>Date), ]
</span></span><span style=display:flex><span>    sell_trades <span style=color:#f92672>&lt;-</span> sell_trades<span style=color:#a6e22e>[order</span>(sell_trades<span style=color:#f92672>$</span>Date), ]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 取前n_trades笔交易进行匹配</span>
</span></span><span style=display:flex><span>    buy_trades <span style=color:#f92672>&lt;-</span> buy_trades[1<span style=color:#f92672>:</span>n_trades, ]
</span></span><span style=display:flex><span>    sell_trades <span style=color:#f92672>&lt;-</span> sell_trades[1<span style=color:#f92672>:</span>n_trades, ]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 计算持有期（天数）</span>
</span></span><span style=display:flex><span>    hold_periods <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>as.numeric</span>(sell_trades<span style=color:#f92672>$</span>Date <span style=color:#f92672>-</span> buy_trades<span style=color:#f92672>$</span>Date)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 计算持有期统计数据</span>
</span></span><span style=display:flex><span>    stats <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>data.frame</span>(
</span></span><span style=display:flex><span>      总交易次数 <span style=color:#f92672>=</span> n_trades,
</span></span><span style=display:flex><span>      平均持有期 <span style=color:#f92672>=</span> <span style=color:#a6e22e>round</span>(<span style=color:#a6e22e>mean</span>(hold_periods), <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>      最长持有期 <span style=color:#f92672>=</span> <span style=color:#a6e22e>max</span>(hold_periods),
</span></span><span style=display:flex><span>      最短持有期 <span style=color:#f92672>=</span> <span style=color:#a6e22e>min</span>(hold_periods),
</span></span><span style=display:flex><span>      持有期标准差 <span style=color:#f92672>=</span> <span style=color:#a6e22e>round</span>(<span style=color:#a6e22e>sd</span>(hold_periods), <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 输出统计结果</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>print</span>(<span style=color:#e6db74>&#34;交易持有期统计:&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>print</span>(stats)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 1. 持有期分布直方图 - 使用ggplot2</span>
</span></span><span style=display:flex><span>    hold_dist_plot <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>ggplot</span>(<span style=color:#a6e22e>data.frame</span>(hold_periods), <span style=color:#a6e22e>aes</span>(x <span style=color:#f92672>=</span> hold_periods)) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>geom_histogram</span>(<span style=color:#a6e22e>aes</span>(y <span style=color:#f92672>=</span> ..density..), 
</span></span><span style=display:flex><span>                     bins <span style=color:#f92672>=</span> <span style=color:#ae81ff>20</span>, 
</span></span><span style=display:flex><span>                     fill <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#3366CC&#34;</span>, 
</span></span><span style=display:flex><span>                     color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;white&#34;</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>geom_density</span>(alpha <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.2</span>, 
</span></span><span style=display:flex><span>                   fill <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#FF9900&#34;</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>geom_vline</span>(xintercept <span style=color:#f92672>=</span> <span style=color:#a6e22e>mean</span>(hold_periods), 
</span></span><span style=display:flex><span>                 color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;red&#34;</span>, 
</span></span><span style=display:flex><span>                 linetype <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;dashed&#34;</span>, 
</span></span><span style=display:flex><span>                 size <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>labs</span>(
</span></span><span style=display:flex><span>        title <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;交易持有期分布&#34;</span>,
</span></span><span style=display:flex><span>        x <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;持有天数&#34;</span>,
</span></span><span style=display:flex><span>        y <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;密度&#34;</span>,
</span></span><span style=display:flex><span>        subtitle <span style=color:#f92672>=</span> <span style=color:#a6e22e>paste</span>(<span style=color:#e6db74>&#34;平均持有期: &#34;</span>, <span style=color:#a6e22e>mean</span>(hold_periods), <span style=color:#e6db74>&#34;天&#34;</span>)
</span></span><span style=display:flex><span>      ) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>theme_minimal</span>(base_family <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SimHei&#34;</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>theme</span>(
</span></span><span style=display:flex><span>        plot.title <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_text</span>(hjust <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>, size <span style=color:#f92672>=</span> <span style=color:#ae81ff>16</span>, face <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;bold&#34;</span>),
</span></span><span style=display:flex><span>        plot.subtitle <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_text</span>(hjust <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>, size <span style=color:#f92672>=</span> <span style=color:#ae81ff>12</span>),
</span></span><span style=display:flex><span>        axis.text <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_text</span>(size <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>),
</span></span><span style=display:flex><span>        panel.grid.minor <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>()
</span></span><span style=display:flex><span>      )
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 2. 持有期箱线图 - 展示分布特征</span>
</span></span><span style=display:flex><span>    hold_boxplot <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>ggplot</span>(<span style=color:#a6e22e>data.frame</span>(hold_periods), 
</span></span><span style=display:flex><span>                           <span style=color:#a6e22e>aes</span>(x <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>, y <span style=color:#f92672>=</span> hold_periods)) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>geom_boxplot</span>(fill <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#3366CC&#34;</span>, alpha <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.7</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>geom_jitter</span>(color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#FF9900&#34;</span>, alpha <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>labs</span>(
</span></span><span style=display:flex><span>        title <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;持有期分布箱线图&#34;</span>,
</span></span><span style=display:flex><span>        y <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;持有天数&#34;</span>
</span></span><span style=display:flex><span>      ) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>theme_minimal</span>(base_family <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SimHei&#34;</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>theme</span>(
</span></span><span style=display:flex><span>        plot.title <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_text</span>(hjust <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>, size <span style=color:#f92672>=</span> <span style=color:#ae81ff>16</span>, face <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;bold&#34;</span>),
</span></span><span style=display:flex><span>        axis.text.x <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(),
</span></span><span style=display:flex><span>        panel.grid.minor <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>()
</span></span><span style=display:flex><span>      )
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 3. 交易频率分析 - 按月统计</span>
</span></span><span style=display:flex><span>    trades_df<span style=color:#f92672>$</span>YearMonth <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>format</span>(trades_df<span style=color:#f92672>$</span>Date, <span style=color:#e6db74>&#34;%Y-%m&#34;</span>)
</span></span><span style=display:flex><span>    trade_frequency <span style=color:#f92672>&lt;-</span> trades_df <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>group_by</span>(YearMonth) <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>summarise</span>(交易次数 <span style=color:#f92672>=</span> <span style=color:#a6e22e>n</span>())
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 交易频率柱状图</span>
</span></span><span style=display:flex><span>    freq_barplot <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>ggplot</span>(trade_frequency, <span style=color:#a6e22e>aes</span>(x <span style=color:#f92672>=</span> YearMonth, y <span style=color:#f92672>=</span> 交易次数)) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>geom_bar</span>(stat <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;identity&#34;</span>, fill <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#33CC99&#34;</span>, color <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;white&#34;</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>labs</span>(
</span></span><span style=display:flex><span>        title <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;月度交易频率&#34;</span>,
</span></span><span style=display:flex><span>        x <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;年月&#34;</span>,
</span></span><span style=display:flex><span>        y <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;交易次数&#34;</span>
</span></span><span style=display:flex><span>      ) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>theme_minimal</span>(base_family <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SimHei&#34;</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>theme</span>(
</span></span><span style=display:flex><span>        plot.title <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_text</span>(hjust <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>, size <span style=color:#f92672>=</span> <span style=color:#ae81ff>16</span>, face <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;bold&#34;</span>),
</span></span><span style=display:flex><span>        axis.text.x <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_text</span>(angle <span style=color:#f92672>=</span> <span style=color:#ae81ff>45</span>, hjust <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>, size <span style=color:#f92672>=</span> <span style=color:#ae81ff>8</span>),
</span></span><span style=display:flex><span>        panel.grid.minor <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>()
</span></span><span style=display:flex><span>      )
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 4. 组合图表</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>library</span>(patchwork)
</span></span><span style=display:flex><span>    combined_plot <span style=color:#f92672>&lt;-</span> (hold_dist_plot <span style=color:#f92672>+</span> hold_boxplot) <span style=color:#f92672>/</span> freq_barplot <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>plot_annotation</span>(title <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;AAPL交易持有期与交易频率分析&#34;</span>,
</span></span><span style=display:flex><span>                      theme <span style=color:#f92672>=</span> <span style=color:#a6e22e>theme</span>(plot.title <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_text</span>(hjust <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>, 
</span></span><span style=display:flex><span>                                                              size <span style=color:#f92672>=</span> <span style=color:#ae81ff>18</span>, 
</span></span><span style=display:flex><span>                                                              face <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;bold&#34;</span>)))
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 显示图表</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>print</span>(combined_plot)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 保存图表（可选）</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># ggsave(&#34;trading_analysis.png&#34;, </span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#       combined_plot, </span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#       width = 12, </span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#       height = 8, </span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#       dpi = 300)</span>
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>cat</span>(<span style=color:#e6db74>&#34;没有足够的买卖交易对进行分析\n&#34;</span>)
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cat</span>(<span style=color:#e6db74>&#34;没有交易数据可供分析\n&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><pre tabindex=0><code>## [1] &#34;交易持有期统计:&#34;
##   总交易次数 平均持有期 最长持有期 最短持有期 持有期标准差
## 1         62       15.1         51          1         11.4
</code></pre><img src=/post/macd_files/figure-html/trade_frequency_analysis-1.png width=90% style=display:block;margin:auto><h1 id=结论与展望>结论与展望</h1><h2 id=研究结论>研究结论</h2><p>通过对MACD指标的参数优化和回测分析，我们得出以下结论：</p><ol><li>在研究期间内，基于MACD指标的择时策略在特定参数组合下能够取得优于简单买入持有策
略的风险调整后收益。</li><li>最佳参数组合显示，快速EMA周期、慢速EMA周期和信号线周期对策略表现有显著影响。</li><li>策略的交易频率适中，平均持有期符合中期投资风格。</li></ol><h2 id=策略局限性>策略局限性</h2><p>尽管MACD指标在趋势市场中表现良好，但仍存在以下局限性：</p><ol><li>回测结果受历史数据限制，未来表现可能与历史表现不同。</li><li>策略在震荡市场环境中可能产生更多的虚假信号。</li><li>交易成本和滑点未被充分考虑，实际应用中可能降低策略收益。</li></ol><h2 id=未来研究方向>未来研究方向</h2><ol><li>结合其他技术指标（如KDJ、RSI等）构建多指标复合策略。</li><li>研究不同市场环境下MACD指标的适用性，开发自适应参数机制。</li><li>考虑交易成本、滑点和税费等实际因素，优化策略实现。</li></ol><p>通过本研究，我们展示了如何使用R语言和相关金融包实现技术指标的回测和优化，为量化交
易策略的开发提供了实用的方法和思路。</p><p>这篇文章提供了一个完整的MACD指标择时交易策略分析流程，包括数据获取、指标计算、策
略实现、参数优化、回测分析和可视化。您可以直接将代码复制到R Markdown环境中运行，或者根据需要进行调整和扩展。希望这对您的研究和实践有所帮助！
如果有任何问题或需要进一步的讨论，请随时联系我。</p></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 000-6 3 3 0 000 6"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/%E5%8A%A8%E9%87%8F/ rel=tag>动量</a></li><li class=tags__item><a class="tags__link btn" href=/tags/%E8%BD%AE%E5%8A%A8%E7%AD%96%E7%95%A5/ rel=tag>轮动策略</a></li><li class=tags__item><a class="tags__link btn" href=/tags/%E6%9C%89%E6%95%88%E6%80%A7/ rel=tag>有效性</a></li><li class=tags__item><a class="tags__link btn" href=/tags/r/ rel=tag>R</a></li></ul></div></footer></article><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js async></script><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,tags:"ams"},svg:{fontCache:"global"}}</script></main></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2025 R-Finance中国.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js async></script><script>window.MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,tags:"ams"},svg:{fontCache:"global"}}</script></body></html>